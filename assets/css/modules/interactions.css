/* ==========================================================================
   INTERACTIONS: Animazioni, Transizioni e Classi di Stato (CORRETTO)
   ========================================================================== */

/* --- 1. Classi di Stato Globali --- */

body.is-loading { overflow-y: hidden; }
body.js-cursor-active { cursor: none; }
body.is-leaving #transition-canvas { opacity: 1; pointer-events: auto; }
body.is-leaving #page-transition-overlay { opacity: 1; transition: opacity 0.4s ease 0.5s; }

/* --- 2. Gestione della Visibilità delle Pagine --- */

.page-view {
    /* Per default, le viste sono nascoste ma pronte per la transizione */
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: opacity 0.6s var(--ease-out-quint), visibility 0s 0.6s;
}

.page-view.active {
    /* La vista attiva diventa visibile */
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
    transition-delay: 0.1s; /* Leggero ritardo per fluidità */
}


/* --- 3. Animazioni di Entrata allo Scroll (.reveal) --- */

.reveal {
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 1.2s ease, transform 1.2s ease;
    will-change: opacity, transform;
}

body:not(.js-enabled) .reveal {
    opacity: 1;
    transform: none;
}

.reveal.visible {
    opacity: 1;
    transform: translateY(0);
}

/* --- 4. Interazioni Componenti (invariate) --- */

.main-header { opacity: 0; transform: translateY(-100%); transition: opacity 0.5s var(--ease-out-quint), transform 0.6s var(--ease-out-quint); }
.main-header.is-visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
.hamburger.is-active .hamburger-bar:nth-child(1) { transform: translateY(7px) rotate(45deg); }
.hamburger.is-active .hamburger-bar:nth-child(2) { opacity: 0; }
.hamburger.is-active .hamburger-bar:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
#mobile-nav-overlay { opacity: 0; pointer-events: none; }
#mobile-nav-overlay.open { opacity: 1; pointer-events: auto; }
#mobile-nav-overlay.open li:nth-child(1) { animation-delay: 0.2s; }
#mobile-nav-overlay.open li:nth-child(2) { animation-delay: 0.3s; }
#mobile-nav-overlay.open li:nth-child(3) { animation-delay: 0.4s; }
.project-card { transition: transform 0.4s ease, box-shadow 0.4s ease; }
.project-card:hover { transform: scale(1.02); box-shadow: 0 10px 40px var(--shadow-color); }
.project-card .poster-image { transition: opacity 0.6s ease, transform 0.6s ease; }
.project-card:hover .poster-image { opacity: 0; transform: scale(1.05); z-index: -1; }
.comparison-slider { opacity: 0; transition: opacity 0.6s ease; pointer-events: none; }
.project-card:hover .comparison-slider { opacity: 1; pointer-events: auto; }
.project-card:hover .project-title span { opacity: 1; max-height: 1em; max-width: 100px; }
.interactive-cue { transition: opacity 0.4s ease; animation: pulse-and-slide 2.5s ease-in-out infinite; }
.project-card:hover .interactive-cue { opacity: 0; }
.hotspot-content { opacity: 0; pointer-events: none; transition: opacity 0.3s ease, transform 0.3s ease; transform: translateY(10px); }
.hotspot-content.visible { opacity: 1; pointer-events: auto; transform: translateY(0); }
.toolkit-item { transition: color 0.3s ease, text-shadow 0.3s ease; }
.toolkit-item:hover { color: var(--primary-color); text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
.toolkit-item::before { transition: opacity 0.4s ease, transform 0.4s ease; }
.toolkit-item:hover::before { opacity: 0.1; transform: translate(-50%, -50%) scale(1.1); }
.about-image img { transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1); will-change: transform; }

/* --- 5. Classe per l'interazione magnetica --- */

.is-magnet-locked {
    outline: 3px solid rgba(255, 255, 255, 0.8);
    outline-offset: 5px;
    transition: outline-offset 0.2s ease-out, outline-color 0.2s ease-out;
}

/* ==========================================================================
   5. KEYFRAMES (invariati)
   ========================================================================== */

@keyframes scanline-roll { from { transform: translateY(0%); } to { transform: translateY(-50%); } }
@keyframes crt-subtle-effect { 50% { transform: translate(1px, 0); } }
@keyframes error-flicker { 50% { opacity: 0.6; } }
@keyframes blink-start { 50% { opacity: 0; } }
@keyframes bounce { 40% { transform: translate(-50%, -10px); } 60% { transform: translate(-50%, -5px); } }
@keyframes menu-item-fade-in { to { opacity: 1; transform: translateY(0); } }
@keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); } }
@keyframes pulse-and-slide { 0% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; } 30% { transform: translate(calc(-50% + 8px), -50%) scale(1.15); opacity: 1; } 70% { transform: translate(calc(-50% - 8px), -50%) scale(1.15); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; } }