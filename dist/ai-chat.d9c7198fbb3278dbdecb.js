/*! For license information please see ai-chat.d9c7198fbb3278dbdecb.js.LICENSE.txt */
"use strict";(self.webpackChunkportfolio_v8=self.webpackChunkportfolio_v8||[]).push([[760],{597:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Si});var r=n(529),i=n(436),o=n(388),a=n(272),s=n(952),c=n(28),u=n(236),l=n(47);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return h(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(h(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,h(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,h(f,"constructor",u),h(u,"constructor",c),c.displayName="GeneratorFunction",h(u,i,"GeneratorFunction"),h(f),h(f,i,"Generator"),h(f,r,function(){return this}),h(f,"toString",function(){return"[object Generator]"}),(p=function(){return{w:o,m:d}})()}function h(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}h=function(e,t,n,r){function o(t,n){h(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},h(e,t,n,r)}function d(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=w(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var k={operator:{name:"Alessandro Giacobbi",id:"ALESSANDRO GIACOBBI",status:"ATTIVO",role:"3D Artist",specialization:"3D Environment, Character Design",bio:"La mia passione per il 3D nasce dalla volontà di creare mondi e storie immersive. Ogni progetto è un'esplorazione, una sfida tecnica e un'opportunità per dare vita a qualcosa di unico.",contact:"alessandro.giacobbi.3d@gmail.com",skills:["3D Modeling","Texturing","UV Mapping","Lighting","Rendering","Character Design","Environment Design"],experience:"Esperto in creazione di ambienti 3D dettagliati e personaggi memorabili per giochi e media digitali.",location:"Italia",tools:{primary:["Maya","ZBrush","Blender","Substance Painter"],secondary:["Mari","Arnold","V-Ray","Cycles","Nuke","After Effects"]}},site:{name:"A.P.I.S. TERMINAL v4.0",version:"4.0",description:"Portfolio interattivo futuristico con elementi arcade e AI integrata",features:{cursors:["Pacman","Asteroids","Default"],themes:["Dark","Light"],audio:["Coin","Transition","Hover","Notify"],accessibility:["Text Large","High Contrast"]},sections:{hero:"Sezione principale con presentazione e interfaccia futuristica",projects:"Galleria interattiva con slider before/after e video lazy-loading",about:"Profilo operatore con dossier stile arcade",contact:"Sezione contatti con email e toolkit",shop:"Sezione negozio (placeholder per future implementazioni)"},interactiveElements:{navbar:"Console interattiva con monitor di sistema e arcade display",chatWidget:"AI Glitchy con personalità dinamica e apprendimento",magneticTargets:"Elementi che reagiscono ai cursori speciali",crtEffects:"Effetti visivi retrò con rumore e scanlines"}},cursors:{pacman:{description:"Cursore interattivo con gameplay Pacman completo",features:["Raccolta pallini","Fantasmi inseguitore","Power-ups","Sistema punteggio","Effetti sonori"],activation:"Automatico casuale o comando 'setCursor pacman'",states:["Active","Inactive","Magnetic"]},asteroids:{description:"Navicella spaziale con elementi distruttibili",features:["Asteroidi da distruggere","Nemici alieni","Power-ups","Monete","Onde progressive","Particellari"],activation:"Automatico casuale o comando 'setCursor asteroids'",states:["Space","Cursor","Magnetic"]},glitch:{description:"Cursore cyberpunk con effetto Matrix rain",features:["Pioggia di caratteri Matrix","Trail digitale del cursore","Effetti glitch","Modalità magnetica"],activation:"Comando 'setCursor glitch'",states:["Active","Inactive","Magnetic"]},default:{description:"Cursore standard del browser",features:["Nessun effetto speciale","Comportamento standard"],activation:"Comando 'setCursor default'"}},commands:{navigate:"Naviga verso sezioni: hero, projects, about, contact, shop",openProject:"Apre progetti specifici: biosphaera, lp",setCursor:"Cambia cursore: pacman, asteroids, glitch, default",setTheme:"Cambia tema: chiaro/scuro, light/dark",setAccessibility:"Accessibilità: testo-grande, contrasto-alto",playSound:"Riproduce suoni: coin, transition, hover, notify",getWeather:"Meteo per città specifiche",getGeneralKnowledge:"Spiegazioni di termini tecnici",getNewsHeadlines:"Notizie per categoria",previewMultimedia:"Analizza URL YouTube/GitHub",analyzeCode:"Analizza struttura del sito",gitStatus:"Stato repository (demo)",codeSnippet:"Esempi codice: javascript, html, css, react, webgl",calculate:"Calcoli matematici",showPersonality:"Mostra tratti personalità dinamica",showAnalytics:"Statistiche conversazione",suggestAction:"Suggerimenti contestuali",systemInfo:"Informazioni browser e sistema"},easterEggs:{konamiCode:{sequence:"↑↑↓↓←→←→BA",effect:"Attiva forzatamente cursore Pacman",detection:"Globale tastiera"},creditsClick:{trigger:"Click ripetuto su 'CREDITS' navbar",effect:"Aumenta contatore crediti",sound:"Coin sound effect"}},telemetry:{metrics:["CPU","Memory","GPU","Network"],display:"Barre grafiche realtime nella navbar",arcade:{highScore:"Punteggio massimo salvato",credits:"Contatore sistema arcade",uptime:"Timer sistema HH:MM:SS"}},tools:{modellazione:["Maya","ZBrush","Blender"],texturing:["Substance Painter","Mari"],rendering:["Arnold","V-Ray","Cycles"],animation:["Maya","Blender"],compositing:["Nuke","After Effects"]},siteSections:{hero:"Sezione principale del terminale con interfaccia futuristica.",projects:"Galleria interattiva dei lavori 3D con descrizioni dettagliate.",about:"Profilo completo dell'artista, biografia e specializzazioni tecniche.",contact:"Informazioni di contatto, email e collegamenti ai social/professionali."},technologies:{webgl:"Tecnologia per rendering 3D direttamente nel browser web.",threejs:"Libreria JavaScript per creare esperienze 3D interattive.",javascript:"Linguaggio di programmazione principale per lo sviluppo web.",html5:"Standard per contenuti multimediali interattivi nel web.",css3:"Linguaggio per definire lo stile e il layout delle pagine web."},generalKnowledge:{ai:"Intelligenza Artificiale: sistemi che simulano l'intelligenza umana per risolvere problemi complessi.",machineLearning:"Apprendimento Automatico: branca dell'AI che permette ai sistemi di imparare dai dati.",neuralNetworks:"Reti Neurali: modelli ispirati al cervello umano per elaborare informazioni.",portfolio:"Raccolta di lavori che dimostrano le competenze e l'esperienza di un professionista.",bountyHunter:"Cacciatore di taglie: personaggio che lavora per conto proprio catturando criminali."},faq:[{question:"Che tipo di progetti realizzi?",answer:"Creo ambienti 3D dettagliati, personaggi e scene per giochi, film e media digitali."},{question:"Quali software usi?",answer:"Principalmente Maya, ZBrush, Blender per la modellazione, Substance Painter per il texturing, e vari motori di rendering."},{question:"Come posso contattarti?",answer:"Puoi scrivermi all'email alessandro.giacobbi.3d@gmail.com o utilizzare il form di contatto del sito."},{question:"Sei disponibile per commissioni?",answer:"Sì, sono sempre interessato a nuovi progetti. Contattami per discutere i dettagli."},{question:"Qual è la tua specializzazione?",answer:"Mi specializzo in design di ambienti 3D e character design, con focus su mondi immersivi e storie coinvolgenti."},{question:"Quanti progetti hai nel portfolio?",answer:"Attualmente ho 2 progetti completi: Biosphaera (142MB, 2023) e LP Project (89MB, 2023)."},{question:"Il sito è responsive?",answer:"Sì, ottimizzato per desktop e dispositivi mobili con layout adattivo."},{question:"Cosa sono i cursori speciali?",answer:"Pacman e Asteroids sono cursori interattivi con gameplay completo che seguono il mouse."},{question:"Come funziona Glitchy AI?",answer:"Glitchy è un AI con personalità dinamica che apprende dalle interazioni e può controllare il sito."}],projects:[],responses:{query_skills:"Alessandro ha competenze in JavaScript, WebGL, Three.js, animazione 3D, sviluppo web, e creazione di esperienze interattive.",query_tools:"Alessandro lavora principalmente con JavaScript, Three.js per la grafica 3D, Blender per la modellazione, e vari framework web come React e Node.js.",query_contact:"Puoi contattare Alessandro tramite email o LinkedIn. Vuoi che ti fornisca i dettagli di contatto?",query_project_count:"Alessandro ha realizzato diversi progetti nel portfolio. Alcuni dei principali sono Biosphaera (progetto 3D interattivo) e LP (landing page animata).",query_technologies:"Le tecnologie principali includono JavaScript, WebGL, Three.js, HTML5, CSS3, Node.js, e varie librerie per l'animazione e l'interattività.",query_faq:"Posso rispondere a domande sui progetti, sulle competenze tecniche, sui contatti, e aiutarti a navigare il sito. Cosa vuoi sapere?",query_about_operator:"Alessandro è uno sviluppatore full-stack specializzato in web development, 3D e animazione. Ha esperienza in JavaScript, Three.js, WebGL e molto altro!"},aiCapabilities:{introduction:"Sono Glitchy, un'intelligenza artificiale integrata in questo sito. Posso aiutarti a esplorare i progetti, a personalizzare la tua esperienza e a rispondere a domande su Alessandro e il suo lavoro. Ecco un riepilogo di ciò che posso fare:",coreFunctions:[{category:"Navigazione del Sito",description:"Posso guidarti attraverso le diverse sezioni del portfolio.",examples:["Vai alla sezione 'progetti'","Portami alla pagina dei contatti","Mostrami la sezione 'about'"]},{category:"Interazione con i Progetti",description:"Posso fornirti informazioni sui progetti, aprirli e cercarli in base alla tecnologia.",examples:["Apri il progetto Biosphaera","Parlami del progetto LP","Quali progetti usano WebGL?","Cerca progetti realizzati con Three.js"]},{category:"Personalizzazione dell'Interfaccia",description:"Puoi chiedermi di modificare l'aspetto e il comportamento del sito.",examples:["Cambia il cursore in 'pacman'","Attiva il tema scuro","Metti il testo grande per una migliore leggibilità"]},{category:"Informazioni Generali",description:"Posso rispondere a domande su Alessandro, le sue competenze e gli strumenti che utilizza.",examples:["Quali sono le competenze di Alessandro?","Che software usa per modellare?","Come posso contattarlo?"]},{category:"Funzionalità Avanzate",description:"Posso eseguire comandi più complessi e fornirti informazioni tecniche.",examples:["Mostrami un esempio di codice JavaScript","Che tempo fa a Milano?","Analizza il codice di questa pagina"]}],conclusion:"Prova a farmi una di queste domande o a esplorare liberamente. Sono qui per aiutarti!"}};function j(){return fetch("assets/projects.json").then(function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(function(e){return k.projects=e,console.log("[KB] Base di conoscenza aggiornata con i dati dei progetti."),!0}).catch(function(e){return console.error("[KB] Impossibile caricare i progetti nella base di conoscenza:",e),!1})}var O,z,P={getAllProjectNames:function(){return k.projects&&Array.isArray(k.projects)?k.projects.map(function(e){return e.name||e.title||""}).filter(function(e){return e}):[]},getProjectByName:function(e){return k.projects&&Array.isArray(k.projects)?k.projects.find(function(t){return(t.name||t.title||"").toLowerCase().includes(e.toLowerCase())}):null},getCapabilities:function(){return k.aiCapabilities},getAllSkills:function(){return k.operator.skills||[]},getAllTools:function(){var e=k.operator.tools||{};return[].concat(b(e.primary||[]),b(e.secondary||[]))},findRelevant:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.limit,r=void 0===n?5:n,i=t.semantic,o=void 0===i||i,a=[],s="string"==typeof e?e:String(e||""),c=s.toLowerCase();if(o&&a.push.apply(a,b(P._semanticSearch(s))),k.projects&&Array.isArray(k.projects)){var u,l=g(k.projects);try{for(l.s();!(u=l.n()).done;){var f=u.value,p=(f.name||f.title||"").toLowerCase(),h=(f.description||"").toLowerCase(),d=(f.technologies||[]).join(" ").toLowerCase(),m=0;p.includes(c)&&(m+=.9),h.includes(c)&&(m+=.7),d.includes(c)&&(m+=.8),m>.3&&a.push({type:"project",title:f.name||f.title,content:f.description,technologies:f.technologies,solution:"Informazioni sul progetto: ".concat(f.description),relevance:m})}}catch(e){l.e(e)}finally{l.f()}}if(k.operator.skills){var v,w=g(k.operator.skills);try{for(w.s();!(v=w.n()).done;){var S=v.value,j=S.toLowerCase(),O=0;j.includes(c)&&(O+=.8),P._calculateSimilarity(j,c)>.6&&(O+=.5),O>.4&&a.push({type:"skill",content:S,solution:"Competenza disponibile: ".concat(S),relevance:O})}}catch(e){w.e(e)}finally{w.f()}}var z,x=g(P.getAllTools());try{for(x.s();!(z=x.n()).done;){var C=z.value,_=C.toLowerCase(),T=0;_.includes(c)&&(T+=.7),P._calculateSimilarity(_,c)>.6&&(T+=.4),T>.4&&a.push({type:"tool",content:C,solution:"Strumento disponibile: ".concat(C),relevance:T})}}catch(e){x.e(e)}finally{x.f()}if(k.site.sections)for(var I=0,A=Object.entries(k.site.sections);I<A.length;I++){var E=y(A[I],2),M=E[0],q=E[1],D=q.toLowerCase(),L=0;(D.includes(c)||M.includes(c))&&(L+=.6),P._calculateSimilarity(D,c)>.5&&(L+=.3),L>.3&&a.push({type:"site_section",content:M,solution:"Sezione del sito: ".concat(q),relevance:L})}if(k.faq){var F,G=g(k.faq);try{for(G.s();!(F=G.n()).done;){var N=F.value,R=N.question.toLowerCase(),B=N.answer.toLowerCase(),U=0;R.includes(c)&&(U+=.8),B.includes(c)&&(U+=.6),P._calculateSimilarity(R+" "+B,c)>.5&&(U+=.4),U>.4&&a.push({type:"faq",content:N.question,solution:N.answer,relevance:U})}}catch(e){G.e(e)}finally{G.f()}}return a.sort(function(e,t){return t.relevance-e.relevance}).slice(0,r)},_semanticSearch:function(e){var t=[],n=e.toLowerCase().split(/\s+/).filter(function(e){return e.length>2}),r=P._expandWithSynonyms(n);return P._findRelatedConcepts(r).forEach(function(e){t.push({type:"semantic",content:e.term,solution:e.explanation,relevance:e.similarity})}),t},_expandWithSynonyms:function(e){var t=new Set(e),n={progetto:["lavoro","portfolio","realizzazione"],competenza:["skill","abilità","esperienza"],strumento:["software","tool","programma"],sito:["web","portfolio","website"],"3d":["tridimensionale","modellazione","rendering"]};return e.forEach(function(e){n[e]&&n[e].forEach(function(e){return t.add(e)})}),Array.from(t)},_findRelatedConcepts:function(e){var t=[],n={javascript:{explanation:"Linguaggio di programmazione per il web",similarity:.8},webgl:{explanation:"API per rendering 3D nel browser",similarity:.9},"three.js":{explanation:"Libreria JavaScript per grafica 3D",similarity:.9},blender:{explanation:"Software open source per modellazione 3D",similarity:.7},maya:{explanation:"Software professionale per animazione 3D",similarity:.7}};return e.forEach(function(e){n[e]&&t.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({term:e},n[e]))}),t},_calculateSimilarity:function(e,t){var n=new Set(e.split(/\s+/)),r=new Set(t.split(/\s+/)),i=new Set(b(n).filter(function(e){return r.has(e)})),o=new Set([].concat(b(n),b(r)));return i.size/o.size},loadAdditionalContent:(O=p().m(function e(t){var n,r,i,o,a;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,n="",o=t,e.n="projects"===o?1:"tutorials"===o?2:"updates"===o?3:4;break;case 1:return n="assets/projects.json",e.a(3,5);case 2:return n="assets/tutorials.json",e.a(3,5);case 3:return n="assets/updates.json",e.a(3,5);case 4:return e.a(2,!1);case 5:return e.n=6,fetch(n);case 6:if((r=e.v).ok){e.n=7;break}return e.a(2,!1);case 7:return e.n=8,r.json();case 8:return i=e.v,"projects"===t&&Array.isArray(i)&&(k.projects=[].concat(b(k.projects||[]),b(i))),console.log("[KB] Loaded additional ".concat(t," content")),e.a(2,!0);case 9:return e.p=9,a=e.v,console.warn("[KB] Failed to load ".concat(t,":"),a),e.a(2,!1)}},e,null,[[0,9]])}),z=function(){var e=this,t=arguments;return new Promise(function(n,r){var i=O.apply(e,t);function o(e){d(i,n,r,o,a,"next",e)}function a(e){d(i,n,r,o,a,"throw",e)}o(void 0)})},function(e){return z.apply(this,arguments)}),updateKnowledge:function(e){try{for(var t=0,n=Object.entries(e);t<n.length;t++){var r,i=y(n[t],2),o=i[0],a=i[1];k[o]&&(Array.isArray(k[o])?(r=k[o]).push.apply(r,b(a)):"object"===f(k[o])?Object.assign(k[o],a):k[o]=a)}return console.log("[KB] Knowledge base updated"),!0}catch(e){return console.warn("[KB] Update failed:",e),!1}}},x=n(257);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function _(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return T(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(T(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,T(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,T(f,"constructor",u),T(u,"constructor",c),c.displayName="GeneratorFunction",T(u,i,"GeneratorFunction"),T(f),T(f,i,"Generator"),T(f,r,function(){return this}),T(f,"toString",function(){return"[object Generator]"}),(_=function(){return{w:o,m:p}})()}function T(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}T=function(e,t,n,r){function o(t,n){T(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},T(e,t,n,r)}function I(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function A(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){I(o,r,i,a,s,"next",e)}function s(e){I(o,r,i,a,s,"throw",e)}a(void 0)})}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function M(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var q=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.glitchyBrain=t,this.eventBus=r.A,this.domService=n||new i.w(this.eventBus),this.apiService=l||new o.W,this.projectService=f||new a.T(this.apiService),this.stateService=p||new s.d,this.audioManager=h||new c.A,this.i18n=d||new u.F},t=[{key:"setAccessibility",value:function(e){if(!document.body)return{success:!1,error:"Body element not found"};switch(e){case x.p1.TEXT_LARGE:return this.domService.toggleClassOnBody(x.p1.TEXT_LARGE,x.p1.TEXT_NORMAL),localStorage.setItem("access_text_size","large"),{success:!0,message:"Text enlarged"};case x.p1.TEXT_NORMAL:return this.domService.toggleClassOnBody(x.p1.TEXT_NORMAL,x.p1.TEXT_LARGE),localStorage.setItem("access_text_size","normal"),{success:!0,message:"Text set to normal"};case x.p1.CONTRAST_HIGH:return this.domService.toggleClassOnBody(x.p1.CONTRAST_HIGH,x.p1.CONTRAST_NORMAL),localStorage.setItem("access_contrast","high"),{success:!0,message:"High contrast activated"};case x.p1.CONTRAST_NORMAL:return this.domService.toggleClassOnBody(x.p1.CONTRAST_NORMAL,x.p1.CONTRAST_HIGH),localStorage.setItem("access_contrast","normal"),{success:!0,message:"Normal contrast activated"};default:return{success:!1,error:"Unknown accessibility option"}}}},{key:"setTheme",value:function(e){return document.body?"scuro"===e||"dark"===e?(this.domService.toggleClassOnBody(x.zG.DARK,x.zG.LIGHT),localStorage.setItem("site_theme","dark"),{success:!0,message:"Dark theme activated"}):"chiaro"===e||"light"===e?(this.domService.toggleClassOnBody(x.zG.LIGHT,x.zG.DARK),localStorage.setItem("site_theme","light"),{success:!0,message:"Light theme activated"}):{success:!1,error:"Unknown theme"}:{success:!1,error:"Body element not found"}}},{key:"setGameCursor",value:function(e){return Object.values(x.qQ).includes(e)?(this.stateService.setCurrentCursor(e),this.eventBus.emit("ui:setGameCursor",e),{success:!0,message:"Cursor set to ".concat(e)}):{success:!1,error:"Unknown cursor type"}}},{key:"getCurrentCursor",value:function(){return this.stateService.getCurrentCursor()}},{key:"undoCursor",value:function(){var e=this.stateService.undoCursor();return e?(this.eventBus.emit("ui:setGameCursor",e),{success:!0,message:"Cursor restored to ".concat(e)}):{success:!1,error:"No previous cursor"}}},{key:"getProjects",value:(v=A(_().m(function e(){var t,n;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.projectService.getProjects();case 1:return t=e.v,e.a(2,{success:!0,data:t});case 2:return e.p=2,n=e.v,e.a(2,{success:!1,error:n.message})}},e,this,[[0,2]])})),function(){return v.apply(this,arguments)})},{key:"openProjectCase",value:(m=A(_().m(function e(t){var n,r,i;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.projectService.getProjects();case 1:if((n=e.v)&&0!==n.length){e.n=2;break}return e.a(2,{success:!1,error:"Project data not available"});case 2:if(r=this.projectService.findProject(n,t)){e.n=3;break}return e.a(2,{success:!1,error:"Project '".concat(t,"' not found")});case 3:return this.eventBus.emit("ui:openProject",r),e.a(2,{success:!0,message:"Opened project ".concat(r.title)});case 4:return e.p=4,i=e.v,e.a(2,{success:!1,error:i.message})}},e,this,[[0,4]])})),function(e){return m.apply(this,arguments)})},{key:"searchProjectsByTechnology",value:(d=A(_().m(function e(t){var n,r,i;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.projectService.searchProjectsByTechnology(t);case 1:if(0!==(n=e.v).length){e.n=2;break}return e.a(2,{success:!1,error:"No projects found mentioning ".concat(t)});case 2:return r=n.length>1?"Found ".concat(n.length," projects related to ").concat(t,". Which one interests you?"):"Found this project related to ".concat(t,":"),e.a(2,{success:!0,message:r,data:{projects:n,quickReplies:n.map(function(e){return{label:e.title,action:"open-project",payload:e.id}})}});case 3:return e.p=3,i=e.v,e.a(2,{success:!1,error:i.message})}},e,this,[[0,3]])})),function(e){return d.apply(this,arguments)})},{key:"navigateTo",value:function(e){return this.domService.navigateTo(e)?{success:!0,message:"Navigated to ".concat(e)}:{success:!1,error:"Section not found"}}},{key:"playSound",value:function(e){return Object.values(x.ds).includes(e)?this.audioManager.playSound(e)?{success:!0,message:"Played ".concat(e)}:{success:!1,error:"Sound not available"}:{success:!1,error:"Unknown sound"}}},{key:"getWeather",value:(h=A(_().m(function e(){var t,n,r,i,o=arguments;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"Milano",e.p=1,e.n=2,this.apiService.fetchWeather(t);case 2:return n=e.v,r="Weather in ".concat(n.location,": ").concat(n.temperature,"°C, ").concat(this.i18n.translateWeatherCondition(n.condition,n.condition)).concat(n.fallback?" (simulated data)":"",", humidity ").concat(n.humidity,"%, wind ").concat(n.windSpeed," km/h").concat(n.feelsLike?", feels like ".concat(n.feelsLike,"°C"):""),e.a(2,{success:!0,message:r,data:n});case 3:return e.p=3,i=e.v,e.a(2,{success:!1,error:i.message})}},e,this,[[1,3]])})),function(){return h.apply(this,arguments)})},{key:"getGeneralKnowledge",value:(p=A(_().m(function e(t){var n,r;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.apiService.getGeneralKnowledge(t);case 1:if(!(n=e.v)){e.n=2;break}return e.a(2,{success:!0,message:"📚 ".concat(n.title,": ").concat(n.summary.substring(0,200),"... [Source: ").concat(n.source,"]"),data:n});case 2:return e.a(2,{success:!1,error:"No information found on this topic. Try different keywords."});case 3:return e.p=3,r=e.v,e.a(2,{success:!1,error:r.message})}},e,this,[[0,3]])})),function(e){return p.apply(this,arguments)})},{key:"getNewsHeadlines",value:(f=A(_().m(function e(){var t,n,r,i,o=arguments;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"technology",e.p=1,e.n=2,this.apiService.getNewsHeadlines(t);case 2:if(!((n=e.v)&&n.length>0)){e.n=3;break}return r="📰 Latest news on ".concat(t,":\n"),n.forEach(function(e,t){r+="".concat(t+1,". ").concat(e.title,"\n")}),e.a(2,{success:!0,message:r,data:n});case 3:return e.a(2,{success:!1,error:"Unable to retrieve news at this time."});case 4:return e.p=4,i=e.v,e.a(2,{success:!1,error:i.message})}},e,this,[[1,4]])})),function(){return f.apply(this,arguments)})},{key:"previewMultimedia",value:(n=A(_().m(function e(t){var n,r,i,o;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.apiService.previewMultimedia(t);case 1:n=e.v,r="",i=n.type,e.n="youtube"===i?2:"github"===i?3:"image"===i?4:"video"===i?5:"webpage"===i?6:7;break;case 2:return r='🎥 YouTube video: "'.concat(n.title,'"').concat(n.channel?" by ".concat(n.channel):""),e.a(3,8);case 3:return r="📁 GitHub repo: ".concat(n.title).concat(n.description?" - ".concat(n.description.substring(0,100),"..."):"").concat(n.stars?" ⭐ ".concat(n.stars," stars"):""),e.a(3,8);case 4:return r="🖼️ Image: ".concat(n.title),e.a(3,8);case 5:return r="🎬 Video: ".concat(n.title),e.a(3,8);case 6:return r="🔗 Webpage: ".concat(n.title),e.a(3,8);case 7:r="🔗 Link: ".concat(n.title||t);case 8:return e.a(2,{success:!0,message:r,data:n});case 9:return e.p=9,o=e.v,e.a(2,{success:!1,error:o.message})}},e,this,[[0,9]])})),function(e){return n.apply(this,arguments)})},{key:"suggestNextAction",value:function(){if(!this.glitchyBrain)return{success:!1,message:"Sistema AI non disponibile"};try{var e=this.glitchyBrain.generateSmartSuggestions(k);if(e&&e.length>0){var t=e[Math.floor(Math.random()*e.length)];return{success:!0,message:"Ecco un suggerimento: ".concat(t),suggestion:t}}var n=["Perché non esplori i progetti?",'Prova a cambiare il cursore con "cursore pacman"',"Vuoi vedere le tue competenze tecniche?","Posso mostrarti come funziona il sito"],r=n[Math.floor(Math.random()*n.length)];return{success:!0,message:r,suggestion:r}}catch(e){return console.error("[siteActions] Errore in suggestNextAction:",e),{success:!1,message:"Non riesco a generare suggerimenti al momento"}}}},{key:"analyzeCode",value:function(){try{var e=document.querySelectorAll("script[src]").length,t=document.querySelectorAll('link[rel="stylesheet"]').length,n=document.querySelectorAll("button").length,r=document.querySelectorAll("a").length,i=document.querySelectorAll("img").length,o={scripts:e,stylesheets:t,buttons:n,links:r,images:i,totalElements:document.querySelectorAll("*").length};return{success:!0,message:"Analysis completed: ".concat(e," scripts, ").concat(t," CSS, ").concat(n," buttons, ").concat(r," links, ").concat(i," images. Total elements: ").concat(o.totalElements),data:o}}catch(e){return{success:!1,error:"Error during code analysis."}}}},{key:"gitStatus",value:function(){return{success:!0,message:"L'analisi dello stato di Git è disponibile solo in un ambiente di sviluppo locale."}}},{key:"learnPreference",value:function(e,t){return this.glitchyBrain&&this.glitchyBrain.learnPreference(e,t),{success:!0,message:"Learned your preference for '".concat(e,"' with value '").concat(t,"'. I'll remember it for the future!")}}},{key:"codeSnippet",value:function(e){var t={javascript:'```javascript\nfunction hello() {\n  console.log("Hello, World!");\n}\n```',html:'```html\n<div class="container">\n  <h1>Hello World</h1>\n</div>\n```',css:"```css\n.container {\n  display: flex;\n  justify-content: center;\n}\n```",react:"```jsx\nfunction App() {\n  return <h1>Hello React!</h1>;\n}\n```",webgl:"```javascript\nconst canvas = document.getElementById('gl-canvas');\nconst gl = canvas.getContext('webgl');\n```"},n=t[e.toLowerCase()]||t.javascript;return{success:!0,message:"Here's an example of ".concat(e,":\n").concat(n),data:{html:!0}}}},{key:"calculate",value:function(e){try{var t=l.g.evaluate(e);return{success:!0,message:"".concat(e," = ").concat(t)}}catch(e){return{success:!1,error:"Error in calculation. Try a simpler expression."}}}},{key:"getSystemInfo",value:function(){var e={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,online:navigator.onLine,screenResolution:"".concat(screen.width,"x").concat(screen.height),viewport:"".concat(window.innerWidth,"x").concat(window.innerHeight),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,currentTime:(new Date).toLocaleString()};return{success:!0,message:"System: ".concat(e.platform,", Browser: ").concat(e.userAgent.split(" ")[0],", Resolution: ").concat(e.screenResolution,", Online: ").concat(e.online?"Yes":"No"),data:e}}},{key:"showAnalytics",value:function(){if(!this.glitchyBrain)return{success:!1,error:"Analytics system not available."};var e=this.glitchyBrain.analytics,t=this.glitchyBrain.generateContextualInsights();return{success:!0,message:"Glitchy Analytics: ".concat(e.conversationEpisodes.length," conversations, ").concat(Object.keys(e.commandsUsed).length," commands used. Insights: ").concat(t.preferredSections?Object.keys(t.preferredSections).length:0," preferred sections.")}}},{key:"getSmartSuggestion",value:function(){if(!this.glitchyBrain)return{success:!1,error:"Suggestion system not available."};var e=this.glitchyBrain.analyzeConversationPatterns(),t=this.glitchyBrain.generateContextualInsights(),n="Try exploring the projects or changing the theme!";if(e.favoriteTopics&&e.favoriteTopics.projects>2)n="Since you like projects, why not open Biosphaera?";else if(t.bestTimes&&Object.keys(t.bestTimes).length>0){var r=Object.keys(t.bestTimes).reduce(function(e,n){return t.bestTimes[e].successRate>t.bestTimes[n].successRate?e:n});n="Your interactions are most effective around ".concat(r,":00.")}return{success:!0,message:n}}},{key:"analyzeSentiment",value:function(e){var t=["bene","ottimo","fantastico","bravo","grazie","perfetto","geniale","wow","incredibile"],n=["male","terribile","orribile","pessimo","schifo","odio","fastidio"],r=e.toLowerCase().split(/\s+/),i=0,o=0;r.forEach(function(e){t.includes(e)&&i++,n.includes(e)&&o++});var a="neutral";return i>o?a="positive":o>i&&(a="negative"),{success:!0,message:"Your message seems ".concat(a," (").concat(i," positive words, ").concat(o," negative).")}}},{key:"logAction",value:function(e,t){this.stateService.logAction(e,t)}},{key:"configureExternalServices",value:function(e){console.log("External services configuration:",e)}},{key:"setBrain",value:function(e){this.glitchyBrain=e,console.log("[siteActions] GlitchyBrain injected.")}}],t&&E(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,f,p,h,d,m,v}(),D=null;D||(D=new q);const L=D;function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=B(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function R(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){if(e){if("string"==typeof e)return U(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t,n){return(t=function(e){var t=function(e){if("object"!=F(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==F(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W={greeting:{description:"Saluti e convenevoli",regex:["^(?:ciao|salve|buongiorno|buonasera|hey|ehilà|saluto|hello|hi|grazie)(?:!|\\s|thanks|$)","^(?:buon\\s+(giorno|sera|pomeriggio|notte))(?:!|\\s|$)","^(?:grazie\\s+mille|thank\\s+you)(?:!|\\s|$)"],keywords:["ciao","salve","buongiorno","buonasera","hey","ehilà","saluto","hello","hi","buon giorno","buon sera","grazie","thanks","grazie mille"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.9,entity:0}},openProject:{description:"Apri un progetto specifico",regex:["apri(?: il)? progetto\\s+(biosphaera|lp|v7)","mostra(?:mi)? (?:il\\s+)?progetto\\s+(biosphaera|lp|v7)","vedi\\s+(?:il\\s+)?progetto\\s+(biosphaera|lp|v7)"],keywords:["apri","progetto","biosphaera","lp","v7","mostra progetto","vedi progetto"],entityDependencies:["projectName"],confidenceWeights:{regex:.95,keyword:.8,entity:.9}},show_projects:{description:"Mostra i progetti/portfolio",regex:["mostra.*progetti","vedi.*progetti","dimmi.*progetti","fammi vedere.*progetti","apri.*progetto"],keywords:["mostra","progetti","vedi","dimmi","fammi vedere","apri","progetto"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.9,entity:0}},setCursor:{description:"Cambia il tipo di cursore",regex:["imposta(?: il)? cursore\\s+a?\\s*(pacman|asteroids|glitch|simple|default)","cambia(?: il)? cursore\\s+in\\s*(pacman|asteroids|glitch|simple|default)","cambia(?: il)? cursore\\s+a\\s*(pacman|asteroids|glitch|simple|default)","cursore\\s+(pacman|asteroids|glitch|simple|default)"],keywords:["cursore","pacman","asteroids","glitch","simple","default","puntatore","cambia","imposta"],entityDependencies:["cursorType"],confidenceWeights:{regex:.9,keyword:.7,entity:.8}},navigate:{description:"Naviga verso una sezione del sito",regex:["vai\\s+a(?:lla)?\\s+(hero|projects?|progetti|about|contact|contatti|shop|home|portfolio|galleria)","naviga\\s+verso\\s+(hero|projects?|progetti|about|contact|contatti|shop|home|portfolio|galleria)","portami\\s+a(?:lla)?\\s+(hero|projects?|progetti|about|contact|contatti|shop|home|portfolio|galleria|sezione)","vai\\s+su\\s+(hero|projects?|progetti|about|contact|contatti|shop|home|portfolio|galleria)","mostra(?:mi)?\\s+(?:il\\s+)?(?:portfolio|progetti|galleria|lavori)","vedi\\s+(?:il\\s+)?(?:portfolio|progetti|galleria|lavori)","voglio\\s+vedere\\s+(?:i\\s+)?(?:progetti|portfolio|galleria|lavori)","fammi\\s+vedere\\s+(?:il\\s+)?(?:portfolio|progetti|galleria|lavori)","apri\\s+(?:la\\s+)?(?:galleria|portfolio|progetti)"],keywords:["vai","naviga","portami","sezione","hero","projects","progetto","progetti","about","profilo","contact","contatti","shop","home","portfolio","galleria","mostra","vedi","vedere","apri","lavori"],entityDependencies:["sectionName"],confidenceWeights:{regex:.9,keyword:.8,entity:.7}},setTheme:{description:"Cambia il tema dell'interfaccia",regex:["imposta(?: il)? tema\\s+su\\s+(chiaro|scuro)","cambia(?: il)? tema\\s+in\\s+(chiaro|scuro)","tema\\s+(chiaro|scuro)","modalità\\s+(chiara|scura|dark|light)"],keywords:["tema","scuro","chiaro","dark","light","modalità","cambia","imposta"],entityDependencies:["theme"],confidenceWeights:{regex:.9,keyword:.7,entity:.8}},suggestAction:{description:"Suggerisci azioni disponibili",regex:["cosa posso fare","cosa sai fare","che (cosa|comandi) (conosci|puoi fare|sai fare)","cosa posso chiederti","dimmi cosa sai fare","suggerisci(?:mi)?\\s+qualcosa","aiuto","help"],keywords:["cosa","fare","comandi","suggerisci","aiuto","help","chiederti","conosci","puoi"],entityDependencies:[],confidenceWeights:{regex:.8,keyword:.7,entity:0}},query_about_operator:{description:"Domande su Alessandro/operatore",keywords:["chi sei","chi è alessandro","parlami di te","profilo","operatore","bio","biografia","informazioni su","presentati","chi è"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_tools:{description:"Domande sugli strumenti utilizzati",keywords:["che software usi","programmi","toolkit","strumenti","che usi per modellare","con cosa lavori","strumenti di lavoro","software"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_contact:{description:"Domande su come contattare",keywords:["come posso contattarti","email","contatti","messaggio","scrivimi","contatto","mail"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_project_count:{description:"Domande sul numero di progetti",keywords:["quanti progetti hai","numero di lavori","totale progetti","quanti lavori","portfolio"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_skills:{description:"Domande sulle competenze",keywords:["competenze","skill","cosa sai fare","abilità","specializzazioni","esperienze"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_technologies:{description:"Domande sulle tecnologie",keywords:["tecnologie","webgl","javascript","three.js","cosa è","spiegami","che cos è"],entityDependencies:[],confidenceWeights:{regex:0,keyword:.8,entity:0}},query_faq:{description:"Domande frequenti",regex:["^(?:faq|domande frequenti)$","sei\\s+(?:disponibile|libero)","quando\\s+sei\\s+(?:disponibile|libero)","orari\\s+(?:di\\s+)?lavoro","disponibilità"],keywords:["faq","domande frequenti","commissioni","disponibile","prezzi","costo","orari","lavoro","quando","sei"],entityDependencies:[],confidenceWeights:{regex:.9,keyword:.8,entity:0}},personal_status:{description:"Domande sullo stato personale o come stai",regex:["^(?:come\\s+stai|come\\s+ti\\s+senti|come\\s+va|come\\s+butta|stai\\s+bene)(?:\\?|!|\\s|$)","^(?:tutto\\s+(bene|ok|a posto))(?:\\?|!|\\s|$)","^(?:come\\s+te\\s+la\\s+passi)(?:\\?|!|\\s|$)"],keywords:["come stai","come ti senti","come va","stai bene","tutto bene","tutto ok","come butta","come te la passi"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.9,entity:0}},can_do:{description:"Domande dirette su cosa può fare il sistema",regex:["cosa fai","cosa sai fare","che (cosa|comandi) sai fare","quali sono le tue funzioni","cosa puoi fare","puoi\\s+(?:fare|dirmi|mostrarmi|aiutarmi|cambiarmi)\\s+(.+)","sai\\s+(?:fare|dirmi|mostrarmi)\\s+(.+)"],keywords:["cosa","fai","sai fare","puoi fare","funzioni","capacità","abilità","puoi","sai","fare","aiutare","cambiare"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.85,entity:0}},query_easter_eggs:{description:"Domande su easter egg o features nascoste",regex:["(?:ci sono|esistono)\\s+easter\\s+egg","features\\s+nascoste","sorprese\\s+nel\\s+sito","cosa\\s+c['è]\\s+di\\s+nascosto","cosa\\s+è\\s+nascosto"],keywords:["easter egg","nascoste","sorprese","segrete","features","extra","cosa c'è di nascosto","nascosto"],entityDependencies:[],confidenceWeights:{regex:.9,keyword:.8,entity:0}},query_prices:{description:"Domande su prezzi o commissioni",regex:["quanto\\s+(?:costi|costano|chiedi)","prezzi","commissioni","tariffe","costo\\s+(?:del\\s+)?servizio"],keywords:["prezzo","costo","commissioni","tariffe","pagamento","budget","servizio"],entityDependencies:[],confidenceWeights:{regex:.8,keyword:.7,entity:0}},explain_tech:{description:"Spiegazioni di tecnologie o termini tecnici",regex:["(?:cosa\\s+è|spiegami|che\\s+cos\\'è)\\s+(webgl|three\\.js|javascript|html5|css3|node\\.js)","spiega(?:mi)?\\s+(webgl|three\\.js|javascript|html5|css3|node\\.js)"],keywords:["cosa è","spiegami","che cos'è","spiega","webgl","three.js","javascript","html5","css3","node.js"],entityDependencies:["techName"],confidenceWeights:{regex:.9,keyword:.6,entity:.8}},what_do_you_do:{description:"Domande su cosa fa il sistema",regex:["cosa\\s+fai","che\\s+(cosa\\s+)?fai","cosa\\s+sei\\s+in\\s+grado\\s+di\\s+fare","che\\s+sai\\s+fare","cosa\\s+fare","cosa\\s+competenze"],keywords:["cosa fai","che fai","cosa sei","che sai fare","capacità","funzioni","cosa fare","competenze"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.9,entity:0}},who_are_you:{description:"Domande su chi è il sistema",regex:["chi\\s+sei","tu\\s+chi\\s+sei","chi\\s+sei\\s+tu","che\\s+sei"],keywords:["chi sei","tu chi sei","che sei","identità","nome"],entityDependencies:[],confidenceWeights:{regex:.95,keyword:.9,entity:0}},random_fun:{description:"Domande casuali o divertenti",regex:["raccontami\\s+una\\s+barzelletta","cosa\\s+fai\\s+nel\\s+tempo\\s+libero","hai\\s+hobby","sei\\s+umano"],keywords:["barzelletta","tempo libero","hobby","umano","divertente","scherzo"],entityDependencies:[],confidenceWeights:{regex:.8,keyword:.6,entity:0}},codeSnippet:{description:"Richiesta di mostrare codice di esempio",regex:["mostra(?:mi)?\\s+(?:codice|esempio|snippet)\\s+(?:di\\s+)?(.+)","esempio\\s+(?:di\\s+)?(?:codice\\s+)?(.+)","come\\s+(?:si\\s+)?(?:scrive|fa)\\s+(.+)","(?:codice|snippet|esempio)\\s+(?:per|di)\\s+(.+)","(?:js|javascript|html|css|python)\\s+(?:code|codice|snippet)"],keywords:["mostra","codice","esempio","snippet","javascript","html","css","python","come","scrive","esempio di","js","code","codice per"],entityDependencies:["language"],confidenceWeights:{regex:.95,keyword:.85,entity:.8}},calculate:{description:"Richiesta di calcolare un'espressione matematica",regex:["^\\s*[\\d\\s+\\-*/().^=?!]+\\s*$","(?:calcola|risolvi|quanto\\s+fa)\\s+(.+)","\\d+(?:\\.\\d+)?\\s*[+\\-*/^=]\\s*\\d+(?:\\.\\d+)?(?:\\s*[+\\-*/^=]\\s*\\d+(?:\\.\\d+)?)*\\s*[=?]*\\s*[?!]*","\\([^)]+\\)\\s*[+\\-*/^=]\\s*\\d+(?:\\.\\d+)?\\s*[=?]*\\s*[?!]*","\\d+(?:\\.\\d+)?\\s*[=?]*\\s*[?!]+"],keywords:["calcola","risolvi","quanto fa","+","-","*","/","^","=","uguale","?"],entityDependencies:[],confidenceWeights:{regex:.99,keyword:.8,entity:0}},getNewsHeadlines:{description:"Richiesta di notizie o headlines",regex:["notizie\\s+(.+)","notizie\\s+(?:di|su|della?|riguardo\\s+a)\\s+(.+)","cosa\\s+succede\\s+(?:in|nel|con)\\s+(.+)","ultime\\s+notizie\\s+(?:su|di|della?)\\s+(.+)","news\\s+(?:su|di|riguardo)\\s+(.+)","(?:dimmi|raccontami)\\s+(?:le\\s+)?notizie"],keywords:["notizie","news","ultime","cosa succede","tecnologia","mondo","italia","politica","sport"],entityDependencies:["category"],confidenceWeights:{regex:.9,keyword:.75,entity:.6}}},V={projectName:{patterns:["biosphaera","lp","portfolio","v7"],normalization:{biosphaera:"biosphaera",lp:"lp",portfolio:"portfolio",v7:"v7"},fuzzyMatching:!0,priority:1},cursorType:{patterns:["pacman","asteroids","glitch","default"],normalization:{pacman:"pacman",asteroids:"asteroids",glitch:"glitch",default:"default",standard:"default",normale:"default"},fuzzyMatching:!0,priority:1},sectionName:{patterns:["hero","projects","progetti","about","contact","contatti","shop","portfolio","galleria"],normalization:H(H(H(H(H(H(H(H({hero:"hero",projects:"projects",progetti:"projects",about:"about",contact:"contact",contatti:"contact",shop:"shop",home:"hero",inizio:"hero",principale:"hero"},"progetti","projects"),"lavori","projects"),"galleria","projects"),"portfolio","projects"),"contatti","contact"),"chi sono","about"),"profilo","about"),"su di me","about"),fuzzyMatching:!0,priority:1},techName:{patterns:["webgl","three.js","javascript","html5","css3","node.js"],normalization:{webgl:"webgl","three.js":"three.js",javascript:"javascript",html5:"html5",css3:"css3","node.js":"node.js"},fuzzyMatching:!0,priority:1},theme:{patterns:["chiaro","scuro","dark","light"],normalization:{chiaro:"chiaro",scuro:"scuro",dark:"scuro",light:"chiaro",notte:"scuro",giorno:"chiaro"},fuzzyMatching:!0,priority:1},location:{patterns:["italia","milano","lombardia","europa","mondo","remoto","online"],normalization:{italia:"italia",milano:"milano",lombardia:"lombardia",europa:"europa",mondo:"mondo",remoto:"remoto",online:"online"},fuzzyMatching:!0,priority:1},category:{patterns:["web","mobile","desktop","game","portfolio","ecommerce","blog","landing"],normalization:{web:"web",mobile:"mobile",desktop:"desktop",game:"game",portfolio:"portfolio",ecommerce:"ecommerce",blog:"blog",landing:"landing","sito web":"web","app mobile":"mobile",videogioco:"game","e-commerce":"ecommerce","landing page":"landing"},fuzzyMatching:!0,priority:1},language:{patterns:["javascript","typescript","python","java","csharp","php","html","css","sql"],normalization:{javascript:"javascript",typescript:"typescript",python:"python",java:"java",csharp:"csharp","c#":"csharp",php:"php",html:"html",css:"css",sql:"sql",js:"javascript",ts:"typescript",py:"python"},fuzzyMatching:!0,priority:1}},K={apri:["apri","mostra","vedi","visualizza","carica","dimmi","fammi vedere","ce l'hai"],progetto:["progetto","lavoro","portfolio","realizzazione","opera","progetti"],cursore:["cursore","puntatore","mouse","pointer","freccetta"],tema:["tema","modalità","aspetto","skin","look","stile"],vai:["vai","naviga","spostati","muovi","passa","portami","vammi"],sezione:["sezione","pagina","area","parte","sezioni"],cosa:["cosa","che","quale","che cosa","che roba"],fare:["fare","eseguire","compiere","effettuare","faccio","fai"],aiuto:["aiuto","help","assistenza","supporto","aiutami","dammi una mano"],chi:["chi","quale persona","che persona"],sei:["sei","sei tu","rappresenti"],software:["software","programma","applicazione","tool","strumento","programmini","apps"],usare:["usare","utilizzare","impiegare","adottare","usi","usate"],competenze:["competenze","skill","abilità","capacità","conoscenze","sai fare"],tecnologie:["tecnologie","tech","strumenti","linguaggi","framework"],come:["come","in che modo","come funziona","spiegami"],perché:["perché","perchè","come mai","per quale motivo"],quando:["quando","in che momento"],dove:["dove","in che posto"],quanti:["quanti","quante","quanto","che numero"],qual:["qual","quali","che tipo","che genere"],posso:["posso","puoi","è possibile","si può"],grazie:["grazie","thank you","thanks","graz","grazie mille","ti ringrazio"],ciao:["ciao","hey","ehilà","salve","buongiorno","buonasera","hello","hi"],sì:["sì","si","yes","certo","ovvio","naturalmente","ok","va bene"],no:["no","not","non","neanche","nemmeno","mai","niente"]};function J(e,t,n){var r=0,i=0,o={regexMatches:0,keywordMatches:0,entityMatches:0,totalKeywords:n.keywords?n.keywords.length:0};if(n.regex){var a,s=N(n.regex);try{for(s.s();!(a=s.n()).done;){var c=a.value;try{if(new RegExp(c,"i").test(e)){r+=n.confidenceWeights.regex,o.regexMatches++,i+=.3;break}}catch(e){continue}}}catch(e){s.e(e)}finally{s.f()}}if(n.keywords){var u=n.keywords.filter(function(t){return e.includes(t.toLowerCase())}).length;if(u>0){var l=e.split(/\s+/).length,f=u/n.keywords.length,p=n.confidenceWeights.keyword*f;l>10&&f<.5&&(p*=.7),"navigate"===t&&e.includes("vai")&&(e.includes("progetti")||e.includes("progetto"))&&(p*=2,i+=.5),"navigate"===t&&(e.includes("vai")||e.includes("vedi")||e.includes("mostra"))&&(p*=1.3,i+=.2),r+=p,o.keywordMatches=u,i+=.4*f}}if(n.entityDependencies&&n.entityDependencies.length>0){var h,d=0,m=0,v=N(n.entityDependencies);try{for(v.s();!(h=v.n()).done;){var y=h.value;if(V[y]){var g=(V[y].patterns||[]).filter(function(t){return e.includes(t.toLowerCase())}).length;g>0&&(d+=n.confidenceWeights.entity,o.entityMatches+=g,m+=.3)}}}catch(e){v.e(e)}finally{v.f()}r+=d,i+=m}return n.entityDependencies&&n.entityDependencies.length>0&&0===o.entityMatches&&(r*=.6,i*=.7),i=Math.min(1,i),{confidence:Math.max(0,Math.min(1,r)),quality:i,details:o}}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.trim();if(!n||n.length<2)return{intent:"unknown",confidence:0,entities:{}};if(/^[^a-zA-Z]*$/.test(n))return{intent:"unknown",confidence:0,entities:{}};var r=function(e){var t=e.toLowerCase();t=function(e){return e.replace(/([!?.,])\1+/g,"$1").replace(/\s*([!?.,;:'"])\s*(?![!?.,;:'"])/g,"$1 ").replace(/\s+/g," ").replace(/[!?.,;:'"]{2,}/g,function(e){return e.includes("!")&&e.includes("?")?"!?":e.includes("!")?"!":e.includes("?")?"?":"."}).trim()}(t);var n,r=N(Object.entries(K).sort(function(e,t){var n=Math.max.apply(Math,R(e[1].map(function(e){return e.length})));return Math.max.apply(Math,R(t[1].map(function(e){return e.length})))-n}));try{for(r.s();!(n=r.n()).done;){var i,o=G(n.value,2),a=o[0],s=N(o[1]);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(t.includes(c)&&c!==a){if(e.toLowerCase().includes(a))continue;var u=c.includes(" ")?new RegExp("\\b".concat(c.replace(/\s+/g,"\\s+"),"\\b"),"g"):new RegExp("\\b".concat(c,"\\b"),"g");t=t.replace(u,a)}}}catch(e){s.e(e)}finally{s.f()}}}catch(e){r.e(e)}finally{r.f()}return t}(n.length>300?n.substring(0,300)+"...":n),i=0;if(t&&t.length>0){var o=t.slice(-2).map(function(e){return e.intent});o.includes("navigate")&&n.toLowerCase().includes("progett")&&(i=.1),o.includes("setCursor")&&n.toLowerCase().includes("cursore")&&(i=.1)}for(var a=[],s=0,c=Object.entries(W);s<c.length;s++){var u=G(c[s],2),l=u[0],f=J(r,l,u[1]);if("codeSnippet"===l&&n.length>200&&(f.confidence*=.3),"greeting"===l&&n.length>100){var p=/\b(progett|portfolio|lavor|tecnolog|webgl|javascript|css|html)\b/i.test(n),h=/\b(vedi|mostra|apri|cambia|spiega)\b/i.test(n);(p||h)&&(f.confidence*=.5)}f.confidence>0&&a.push({intent:l,confidence:f.confidence,matchQuality:f.quality,matchDetails:f.details})}if(0===a.length)return{intent:"unknown",confidence:0,entities:{}};a.sort(function(e,t){return Math.abs(e.confidence-t.confidence)>.1?t.confidence-e.confidence:t.matchQuality-e.matchQuality});var d=a[0];if(d.confidence=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!n||0===n.length)return t;var r=n.slice(-3).map(function(e){return e.intent}).filter(function(t){return t===e}).length;return r>0&&(t+=.1*r),3===r&&(t-=.2),Math.max(0,Math.min(1,t))}(d.intent,d.confidence,t),d.confidence=Math.min(1,d.confidence+i),a.length>1){var m=a.slice(0,2);m[0].confidence-m[1].confidence<.15&&(d=function(e,t){var n=G(e,2),r=n[0],i=n[1],o={"suggestAction vs can_do":function(){var e=/\b(aiuto|cosa posso|dimmi|spiegami)\b/i;return/\b(fai|sai fare|puoi fare|funzioni)\b/i.test(t)&&!e.test(t)?"can_do"===r.intent?r:i:e.test(t)?"suggestAction"===r.intent?r:i:"can_do"===r.intent?r:i},"codeSnippet vs explain_tech":function(){var e=/\b(cos'è|che cos'è|spiega|come funziona|definizione|significato)\b/i;return/\b(codice|snippet|esempio|js|javascript|html|css|python|function|class|const|let|var)\b/i.test(t)&&!e.test(t)?"codeSnippet"===r.intent?r:i:(e.test(t),"explain_tech"===r.intent?r:i)},"navigate vs query_project_count":function(){return/\b(quanti|numero|totale|how many)\b/i.test(t)?"query_project_count"===r.intent?r:i:"navigate"===r.intent?r:i},"navigate vs unknown":function(){return"navigate"===r.intent?r:i}},a=[r.intent,i.intent].sort().join(" vs ");return o[a]?o[a]():r.matchQuality>=i.matchQuality?r:i}(m,r))}var v,y,g=(y=.15,(v=d.matchQuality)<.3?y=.35:v<.5&&(y=.25),y);return d.confidence<g||d.confidence<.4?{intent:"unknown",confidence:d.confidence,entities:{}}:{intent:d.intent,confidence:Math.min(1,d.confidence),entities:{},matchQuality:d.matchQuality}}function $(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return X(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(X(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,X(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,X(f,"constructor",u),X(u,"constructor",c),c.displayName="GeneratorFunction",X(u,i,"GeneratorFunction"),X(f),X(f,i,"Generator"),X(f,r,function(){return this}),X(f,"toString",function(){return"[object Generator]"}),($=function(){return{w:o,m:p}})()}function X(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}X=function(e,t,n,r){function o(t,n){X(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},X(e,t,n,r)}function Z(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ee(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){if(e){if("string"==typeof e)return te(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ne(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function re(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){ne(o,r,i,a,s,"next",e)}function s(e){ne(o,r,i,a,s,"throw",e)}a(void 0)})}}var ie=[];function oe(){return ae.apply(this,arguments)}function ae(){return(ae=re($().m(function e(){var t;return $().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("[NLU] Inizializzazione NLU migliorata..."),ie=[],console.log("[NLU] NLU inizializzata con successo"),e.a(2,!0);case 1:return e.p=1,t=e.v,console.error("[NLU] Errore durante l'inizializzazione:",t),e.a(2,!1)}},e,null,[[0,1]])}))).apply(this,arguments)}function se(e){return ce.apply(this,arguments)}function ce(){return(ce=re($().m(function e(t){var n,r,i,o,a;return $().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=Q(t,ie),r=ue(t),i=le(t),o={intent:n.intent,entities:r,confidence:n.confidence,sentiment:i},ie.push({text:t,intent:n.intent,timestamp:Date.now()}),ie.length>10&&ie.shift(),e.a(2,o);case 1:return e.p=1,a=e.v,console.error("[NLU] Errore durante il parsing:",a),e.a(2,{intent:"unknown",entities:{},confidence:.1,sentiment:"neutral"})}},e,null,[[0,1]])}))).apply(this,arguments)}function ue(e){for(var t={},n=e.toLowerCase(),r=0,i=Object.entries(V);r<i.length;r++){var o,a=Y(i[r],2),s=a[0],c=a[1],u=Z(c.patterns||[]);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(n.includes(l.toLowerCase())){var f=c.normalization[l]||l;t[s]=f;break}}}catch(e){u.e(e)}finally{u.f()}}return t}function le(e){var t=e.toLowerCase(),n=0,r=0;return["bene","ottimo","fantastico","grazie","perfetto","grande","buono"].forEach(function(e){t.includes(e)&&n++}),["male","terribile","noioso","brutto","cattivo","pessimo"].forEach(function(e){t.includes(e)&&r++}),n>r?"positive":r>n?"negative":"neutral"}function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||he(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){if(e){if("string"==typeof e)return de(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach(function(t){ge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,be(r.key),r)}}function ge(e,t,n){return(t=be(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e){var t=function(e){if("object"!=fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fe(t)?t:t+""}var we=9e4,Se="idle",ke="awaiting_entity",je="awaiting_confirmation",Oe="processing",ze="error",Pe="dormant",xe=ge(ge(ge(ge(ge(ge({},Se,[{to:Oe,guard:function(e,t){return!0}},{to:ke,guard:function(e,t){return null==t?void 0:t.awaitingFor}}]),ke,[{to:Oe,guard:function(e,t){return null==t?void 0:t.entityProvided}},{to:Se,guard:function(e,t){return null==t?void 0:t.cancelFollowUp}},{to:ze,guard:function(e,t){return null==t?void 0:t.error}}]),je,[{to:Oe,guard:function(e,t){return null==t?void 0:t.confirmed}},{to:Se,guard:function(e,t){return null==t?void 0:t.cancelConfirmation}},{to:ze,guard:function(e,t){return null==t?void 0:t.error}}]),Oe,[{to:Se,guard:function(e,t){return null==t?void 0:t.completed}},{to:ke,guard:function(e,t){return null==t?void 0:t.awaitingFor}},{to:je,guard:function(e,t){return null==t?void 0:t.needsConfirmation}},{to:ze,guard:function(e,t){return null==t?void 0:t.error}}]),ze,[{to:Se,guard:function(e,t){return!0}}]),Pe,[{to:Se,guard:function(e,t){return null==t?void 0:t.resume}}]),Ce=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={},this.stateStack=[{context:{lastIntent:null,lastEntities:{},lastResponse:null,topic:null,subTopic:null,timestamp:Date.now()},state:Se,awaitingFor:null,followUpCount:0,conversationFlow:[]}],this.conversationHistory=[],this.flowPatterns=new Map,this.nluModule=t,this.conversationInsights={successfulFlows:new Map,failedFlows:new Map,intentSequences:new Map,topicTransitions:new Map},this.loadPersistedInsights()},t=[{key:"getCurrentState",value:function(){return this.stateStack[this.stateStack.length-1]}},{key:"pushState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={context:ve(ve(ve({},this.getCurrentState().context),e),{},{timestamp:Date.now()}),state:Se,awaitingFor:null,followUpCount:0,conversationFlow:[]};return this.stateStack.push(t),t}},{key:"popState",value:function(){if(this.stateStack.length>1){var e=this.stateStack.pop();return this.conversationHistory.push(ve(ve({},e),{},{endedAt:Date.now(),type:"nested_conversation"})),e}return null}},{key:"canTransition",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=xe[e];return!!o&&!!o.find(function(e){return e.to===t&&e.guard(r||n.getCurrentState().context,i)})}},{key:"transitionTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getCurrentState(),r=n.context;if(!this.canTransition(n.state,e,r,t))return console.warn("[ConversationManager] Transizione non valida: ".concat(n.state," -> ").concat(e),{context:r,data:t}),!1;var i=n.state;return n.state=e,t.awaitingFor&&(n.awaitingFor=t.awaitingFor),void 0!==t.followUpCount&&(n.followUpCount=t.followUpCount),void 0!==t.confirmed&&(n.confirmed=t.confirmed),void 0!==t.needsConfirmation&&(n.needsConfirmation=t.needsConfirmation),this.emit("stateChanged",{from:i,to:e,context:r,data:t}),!0}},{key:"updateContext",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getCurrentState();i.context.lastIntent&&!r.isNested&&(this.conversationHistory.push(ve(ve({},i),{},{endedAt:Date.now()})),this.conversationHistory.length>10&&this.conversationHistory.shift());var o=this.determineTopic(e,t);i.context={lastIntent:e,lastEntities:t,lastResponse:n,topic:o.topic,subTopic:o.subTopic,timestamp:Date.now()},r.isNested?i.conversationFlow.push({intent:e,entities:t,timestamp:Date.now()}):(i.state=Se,i.awaitingFor=null,i.followUpCount=0,i.conversationFlow=[{intent:e,entities:t,timestamp:Date.now()}]),this.updateConversationInsights(e,t,n,r.success),this.conversationHistory.length%10==0&&this.savePersistedInsights()}},{key:"determineTopic",value:function(e,t){return{openProject:{topic:"projects",subTopic:t.projectName||"general"},navigate:{topic:"navigation",subTopic:t.sectionName||"general"},searchProjects:{topic:"projects",subTopic:"search"},setCursor:{topic:"interface",subTopic:"cursor"},setTheme:{topic:"interface",subTopic:"theme"},analyzeCode:{topic:"development",subTopic:"analysis"},gitStatus:{topic:"development",subTopic:"versioning"},getWeather:{topic:"external",subTopic:"weather"},systemInfo:{topic:"system",subTopic:"info"},calculate:{topic:"math",subTopic:"calculation"},codeSnippet:{topic:"development",subTopic:"examples"}}[e]||{topic:"general",subTopic:"unknown"}}},{key:"updateConversationInsights",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.getCurrentState(),o=i.context.lastIntent;if(o){var a="".concat(o,"->").concat(e),s=this.conversationInsights.intentSequences.get(a)||0;this.conversationInsights.intentSequences.set(a,s+1)}if(o){var c=this.determineTopic(o,i.context.lastEntities).topic,u=this.determineTopic(e,t).topic;if(c!==u){var l="".concat(c,"->").concat(u),f=this.conversationInsights.topicTransitions.get(l)||0;this.conversationInsights.topicTransitions.set(l,f+1)}}var p=this.getCurrentFlowSignature();if(r){var h=this.conversationInsights.successfulFlows.get(p)||0;this.conversationInsights.successfulFlows.set(p,h+1)}else{var d=this.conversationInsights.failedFlows.get(p)||0;this.conversationInsights.failedFlows.set(p,d+1)}}},{key:"getCurrentFlowSignature",value:function(){return this.getCurrentState().conversationFlow.map(function(e){return e.intent}).join("->")}},{key:"askFor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getCurrentState();return r.followUpCount>=3?"Mi dispiace, ho fatto troppe domande. Possiamo ricominciare da capo?":this.transitionTo(ke,{awaitingFor:e,followUpCount:r.followUpCount+1})?(r.context.timestamp=Date.now(),r.followUpOptions=n,n.validValues&&(r.validValues=n.validValues),t):"Mi dispiace, non posso gestire questa richiesta al momento."}},{key:"handleFollowUp",value:function(e){var t=this.getCurrentState();if(this.isContextExpired()||t.state!==ke)return this.resetCurrentFrame(),null;var n=t.awaitingFor;if(!this.nluModule||!this.nluModule.extractEntity)return console.error("[ConversationManager] NLU module not available for entity extraction"),this.transitionTo(ze,{error:"NLU unavailable"}),"Mi dispiace, al momento non posso elaborare la tua risposta.";var r=this.nluModule.extractEntity(e,n,t.validValues);return this.transitionTo(Oe,{entityProvided:!!r}),t.conversationFlow.push({type:"follow_up",awaitedEntity:n,providedValue:r,timestamp:Date.now()}),t.state=Se,t.awaitingFor=null,{intent:t.context.lastIntent,entities:ve(ve({},t.context.lastEntities),{},ge({},n,r)),isFollowUp:!0,followUpCount:t.followUpCount}}},{key:"extractEntityFromFollowUp",value:function(e,t){throw new Error("extractEntityFromFollowUp is deprecated. Use NLU module instead.")}},{key:"getContext",value:function(){var e=this.getCurrentState();return this.isContextExpired()&&this.resetCurrentFrame(),ve(ve({},e.context),{},{state:e.state,awaitingFor:e.awaitingFor,followUpCount:e.followUpCount,stackDepth:this.stateStack.length})}},{key:"isContextExpired",value:function(){var e=this.getCurrentState();return Date.now()-e.context.timestamp>we}},{key:"getConversationInsights",value:function(){var e={commonTopics:{},commonFlows:{},avgFollowUps:0,totalConversations:this.conversationHistory.length,successfulSequences:{},failedSequences:{},topicTransitions:{},intentSequences:{},stackDepth:this.stateStack.length};this.conversationHistory.forEach(function(t){var n;null!==(n=t.context)&&void 0!==n&&n.topic&&(e.commonTopics[t.context.topic]=(e.commonTopics[t.context.topic]||0)+1)}),this.flowPatterns.forEach(function(t,n){e.commonFlows[n]=t}),this.conversationInsights.successfulFlows.forEach(function(t,n){e.successfulSequences[n]=t}),this.conversationInsights.failedFlows.forEach(function(t,n){e.failedSequences[n]=t}),this.conversationInsights.topicTransitions.forEach(function(t,n){e.topicTransitions[n]=t}),this.conversationInsights.intentSequences.forEach(function(t,n){e.intentSequences[n]=t});var t=this.conversationHistory.reduce(function(e,t){return e+(t.followUpCount||0)},0);return e.avgFollowUps=e.totalConversations>0?t/e.totalConversations:0,e}},{key:"suggestNextInteraction",value:function(){var e=this,t=this.getConversationInsights(),n=this.getCurrentState(),r=n.context.topic,i=this.generateSuggestionCandidates(r,t);if(0===i.length)return null;var o=i.map(function(r){return ve(ve({},r),{},{score:e.calculateSuggestionScore(r,t,n)})});o.sort(function(e,t){return t.score-e.score});var a=o[0];return{message:a.message,suggestedIntent:a.intent,confidence:a.score,factors:a.factors}}},{key:"generateSuggestionCandidates",value:function(e,t){var n=[];return Object.entries(t.commonTopics).forEach(function(e){var t=pe(e,2),r=t[0],i=(t[1],{projects:[{intent:"openProject",message:"Vuoi esplorare altri progetti nel portfolio?"},{intent:"searchProjects",message:"Hai progetti specifici in mente da cercare?"}],interface:[{intent:"setTheme",message:"Vuoi personalizzare ulteriormente l'interfaccia?"},{intent:"setCursor",message:"Vuoi provare un cursore diverso?"}],development:[{intent:"analyzeCode",message:"Hai altre curiosità tecniche?"},{intent:"codeSnippet",message:"Vuoi vedere esempi di codice?"}],external:[{intent:"getWeather",message:"Vuoi sapere il meteo?"},{intent:"getGeneralKnowledge",message:"Hai altre domande?"}]});i[r]&&n.push.apply(n,function(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||he(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i[r]))}),Object.entries(t.successfulSequences).forEach(function(e){var t=pe(e,2),r=t[0],i=(t[1],r.split("->").pop()),o={openProject:{intent:"openProject",message:"Basandomi sulle tue preferenze, vuoi vedere altri progetti?"},setTheme:{intent:"setTheme",message:"Ti piace cambiare il tema spesso, vuoi provarne uno nuovo?"},navigate:{intent:"navigate",message:"Vuoi visitare altre sezioni del sito?"}};o[i]&&n.push(o[i])}),n}},{key:"calculateSuggestionScore",value:function(e,t,n){var r=0,i={},o=t.successfulSequences[e.intent]||0,a=o+(t.failedSequences[e.intent]||0),s=a>0?o/a:.5;r+=.4*s,i.historicalSuccess=s;var c=n.conversationFlow.slice(-3).map(function(e){return e.intent}).includes(e.intent)?.3:1;r+=.2*c,i.novelty=c;var u=this.calculateContextRelevance(e.intent,n);r+=.3*u,i.contextRelevance=u;var l=t.commonTopics[n.context.topic]||0,f=Math.min(l/10,1);return r+=.1*f,i.topicFrequency=f,Math.min(r,1)}},{key:"calculateContextRelevance",value:function(e,t){return({projects:["openProject","searchProjects"],interface:["setTheme","setCursor"],development:["analyzeCode","codeSnippet","gitStatus"],navigation:["navigate"],external:["getWeather","getGeneralKnowledge","getNewsHeadlines"]}[t.context.topic]||[]).includes(e)?1:.5}},{key:"resetCurrentFrame",value:function(){var e=this.getCurrentState();e.context={lastIntent:null,lastEntities:{},lastResponse:null,topic:null,subTopic:null,timestamp:Date.now()},e.state=Se,e.awaitingFor=null,e.followUpCount=0,e.conversationFlow=[],this.emit("frameReset")}},{key:"resetFullStack",value:function(){this.stateStack=[{context:{lastIntent:null,lastEntities:{},lastResponse:null,topic:null,subTopic:null,timestamp:Date.now()},state:Se,awaitingFor:null,followUpCount:0,conversationFlow:[]}],this.conversationHistory=[],this.emit("fullReset")}},{key:"detectAndHandleDigression",value:function(e,t){var n=this.getCurrentState();if(n.state===ke){var r=n.awaitingFor;if(!this.intentCouldSatisfyEntity(e,t,r))return console.log("[ConversationManager] Digressione rilevata: ".concat(e," durante attesa di ").concat(r)),this.startNestedConversation(e,t),this.emit("digressionDetected",{originalIntent:n.context.lastIntent,digressionIntent:e,awaitedEntity:r}),!0}return!1}},{key:"intentCouldSatisfyEntity",value:function(e,t,n){return({projectName:["openProject","searchProjects"],sectionName:["navigate"],theme:["setTheme"],cursor:["setCursor"]}[n]||[]).includes(e)&&t[n]}},{key:"processInput",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.handleCorrectionIntent(e,t);if(i)return i;if(this.detectAndHandleDigression(e,t))return{type:"digression_started",message:"Capisco che vuoi cambiare argomento. Dimmi pure, poi torniamo alla conversazione precedente."};if(this.getCurrentState().state===Pe){var o=this.resumeFromDormant();if(o)return o}return this.checkTimeoutAndHandle()||(this.updateContext(e,t,n,r),this.getCurrentState().pendingAction={intent:e,entities:t,response:n,options:r},r.confidence&&r.confidence>.6&&r.confidence<.8?(this.transitionTo(je,{needsConfirmation:!0}),{type:"confirmation_needed",message:"Ho capito che vuoi ".concat(this.intentToDescription(e,t),". È corretto?"),intent:e,entities:t}):{type:"processed",intent:e,entities:t})}},{key:"handleConfirmation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getCurrentState();return n.state!==je?{type:"error",message:"Nessuna conferma in attesa."}:e?(this.transitionTo(Oe,{confirmed:!0}),this.emit("confirmationAccepted",n.pendingAction),{type:"confirmed",message:"Perfetto! Procedo con la tua richiesta.",action:n.pendingAction}):t?(this.transitionTo(Se,{cancelConfirmation:!0}),this.emit("correctionReceived",t),{type:"corrected",message:"Capito, grazie per la correzione. Come posso aiutarti ora?",correction:t}):(this.transitionTo(Se,{cancelConfirmation:!0}),this.emit("confirmationRejected"),{type:"cancelled",message:"Va bene, cancelliamo questa azione. Cosa posso fare per te?"})}},{key:"handleCorrectionIntent",value:function(e,t){var n=this.getCurrentState();if(["deny","correct","no","wrong"].includes(e)){if(n.state===je)return this.handleConfirmation(!1,t);if(n.state===ke)return this.transitionTo(Se,{cancelFollowUp:!0}),this.emit("followUpCancelled",{reason:"user_correction"}),{type:"followup_cancelled",message:"Va bene, ricominciamo. Cosa volevi chiedermi?"}}return null}},{key:"getFullContext",value:function(){return{stack:this.stateStack.map(function(e){return{context:e.context,state:e.state,awaitingFor:e.awaitingFor,followUpCount:e.followUpCount}}),history:this.conversationHistory,insights:this.getConversationInsights()}}},{key:"loadPersistedInsights",value:function(){try{var e=localStorage.getItem("conversationInsights");if(e){var t=JSON.parse(e);this.conversationInsights.successfulFlows=new Map(Object.entries(t.successfulFlows||{})),this.conversationInsights.failedFlows=new Map(Object.entries(t.failedFlows||{})),this.conversationInsights.intentSequences=new Map(Object.entries(t.intentSequences||{})),this.conversationInsights.topicTransitions=new Map(Object.entries(t.topicTransitions||{})),console.log("[ConversationManager] Insights persistenti caricati")}}catch(e){console.warn("[ConversationManager] Errore caricamento insights persistenti:",e)}}},{key:"savePersistedInsights",value:function(){try{var e={successfulFlows:Object.fromEntries(this.conversationInsights.successfulFlows),failedFlows:Object.fromEntries(this.conversationInsights.failedFlows),intentSequences:Object.fromEntries(this.conversationInsights.intentSequences),topicTransitions:Object.fromEntries(this.conversationInsights.topicTransitions),lastSaved:Date.now()};localStorage.setItem("conversationInsights",JSON.stringify(e))}catch(e){console.warn("[ConversationManager] Errore salvataggio insights:",e)}}},{key:"checkTimeoutAndHandle",value:function(){var e=this.getCurrentState(),t=Date.now()-e.context.timestamp;return t>we?(this.transitionTo(Pe),this.emit("conversationTimeout",{dormant:!0}),{type:"timeout",message:"La conversazione è entrata in stato dormiente. Digita qualcosa per riprendere.",dormant:!0}):t>72e3?(this.emit("reengagementPrompt",{timeRemaining:Math.round((we-t)/1e3)}),{type:"reengagement",message:"Ehi, sei ancora lì? Stavamo parlando di ".concat(e.context.topic||"qualcosa",". Vuoi continuare?"),timeRemaining:Math.round((we-t)/1e3)}):null}},{key:"resumeFromDormant",value:function(){return this.getCurrentState().state===Pe?(this.transitionTo(Se,{resume:!0}),this.emit("conversationResumed"),{type:"resumed",message:"Bentornato! Stavamo parlando di ".concat(this.getCurrentState().context.topic||"qualcosa",". Come posso aiutarti?")}):null}},{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"off",value:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}))}},{key:"emit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.events[e]&&this.events[e].forEach(function(n){try{n(t)}catch(t){console.error("[ConversationManager] Errore nell'evento ".concat(e,":"),t)}})}}],t&&ye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const _e=Ce;function Te(e){return function(e){if(Array.isArray(e))return Le(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||De(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=De(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach(function(t){Me(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Me(e,t,n){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||De(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(e,t){if(e){if("string"==typeof e)return Le(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ge(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ne(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ne(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Ne(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Ne(f,"constructor",u),Ne(u,"constructor",c),c.displayName="GeneratorFunction",Ne(u,i,"GeneratorFunction"),Ne(f),Ne(f,i,"Generator"),Ne(f,r,function(){return this}),Ne(f,"toString",function(){return"[object Generator]"}),(Ge=function(){return{w:o,m:p}})()}function Ne(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Ne=function(e,t,n,r){function o(t,n){Ne(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},Ne(e,t,n,r)}function Re(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Be(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){Re(o,r,i,a,s,"next",e)}function s(e){Re(o,r,i,a,s,"throw",e)}a(void 0)})}}function Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ve(r.key),r)}}function We(e,t,n){return t&&He(e.prototype,t),n&&He(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ve(e){var t=function(e){if("object"!=Fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fe(t)?t:t+""}var Ke=function(){return We(function e(){Ue(this,e),this.prefix="glitchy_config_"},[{key:"get",value:(n=Be(Ge().m(function e(t){var n,r;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=localStorage.getItem(this.prefix+t),e.a(2,n?JSON.parse(n):null);case 1:return e.p=1,r=e.v,console.warn("[LocalStorageAdapter] Get error:",r),e.a(2,null)}},e,this,[[0,1]])})),function(e){return n.apply(this,arguments)})},{key:"set",value:(t=Be(Ge().m(function e(t,n){var r;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,localStorage.setItem(this.prefix+t,JSON.stringify(n)),e.a(2,{success:!0});case 1:return e.p=1,r=e.v,console.error("[LocalStorageAdapter] Set error:",r),e.a(2,{success:!1,error:r.message})}},e,this,[[0,1]])})),function(e,n){return t.apply(this,arguments)})},{key:"delete",value:(e=Be(Ge().m(function e(t){var n;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,localStorage.removeItem(this.prefix+t),e.a(2,{success:!0});case 1:return e.p=1,n=e.v,console.error("[LocalStorageAdapter] Delete error:",n),e.a(2,{success:!1,error:n.message})}},e,this,[[0,1]])})),function(t){return e.apply(this,arguments)})}]);var e,t,n}(),Je=function(){return We(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Ue(this,e),this.storage=t||new Ke,this.configs=new Map,this.validators=new Map,this.listeners=new Map,this.schemas=new Map,this.defaultConfigs={ai:this.createAIDefaults(),ui:this.createUIDefaults(),performance:this.createPerformanceDefaults(),learning:this.createLearningDefaults(),interaction:this.createInteractionDefaults(),analytics:this.createAnalyticsDefaults()},this.initializeConfigs()},[{key:"createAIDefaults",value:function(){return{reasoning:{maxDepth:5,confidenceThreshold:.7,explorationRate:.3,reasoningTimeout:5e3,enableAbductive:!0,enableInductive:!0,enableDeductive:!0},semantic:{maxTokens:1e3,contextWindow:512,similarityThreshold:.8,entityConfidence:.75,sentimentThreshold:.6,topicClustering:!0},memory:{maxEntries:1e4,compressionThreshold:1e3,cleanupInterval:36e5,retentionPeriod:6048e5,indexUpdateInterval:3e5},planning:{maxGoals:10,planningDepth:3,optimizationTimeout:3e3,riskTolerance:.5,goalDecomposition:!0,alternativePlans:3},personality:{baseTraits:{curiosity:.8,creativity:.7,empathy:.6,assertiveness:.5,adaptability:.9},dynamicAdjustment:!0,moodInfluence:.4,contextAwareness:.8},conversation:{maxTurns:50,responseTimeout:1e4,followUpEnabled:!0,contextRetention:.9,topicShifting:!0}}}},{key:"createUIDefaults",value:function(){return{animations:{enabled:!0,duration:300,easing:"ease-out",reducedMotion:!1},themes:{current:"dark",available:["dark","light","cyberpunk"],autoSwitch:!1},layout:{responsive:!0,breakpoints:{mobile:768,tablet:1024,desktop:1440},gridSystem:"css-grid"},accessibility:{highContrast:!1,textSize:"normal",keyboardNavigation:!0,screenReader:!0,colorBlind:!1},notifications:{enabled:!0,soundEnabled:!1,vibrationEnabled:!1,position:"top-right"}}}},{key:"createPerformanceDefaults",value:function(){return{caching:{enabled:!0,maxSize:52428800,ttl:36e5,compression:!0},optimization:{lazyLoading:!0,virtualization:!0,debouncing:{input:300,scroll:100,resize:200}},monitoring:{enabled:!0,metrics:["responseTime","memoryUsage","cpuUsage"],samplingRate:.1,alertThresholds:{responseTime:5e3,memoryUsage:104857600,cpuUsage:80}},throttling:{maxConcurrent:3,queueSize:10,timeout:3e4}}}},{key:"createLearningDefaults",value:function(){return{reinforcement:{enabled:!0,learningRate:.01,discountFactor:.9,explorationRate:.1,rewardFunction:"balanced"},adaptation:{enabled:!0,adaptationRate:.5,feedbackLoop:!0,contextLearning:!0},knowledge:{updateInterval:864e5,validationEnabled:!0,sourcePrioritization:["user","system","external"],confidenceThreshold:.8},personalization:{enabled:!0,profileUpdateInterval:36e5,preferenceLearning:!0,behaviorAnalysis:!0}}}},{key:"createInteractionDefaults",value:function(){return{input:{modes:["text","voice","gesture"],validation:!0,sanitization:!0,autocomplete:!0},output:{formats:["text","html","markdown"],richContent:!0,multimedia:!0,progressiveDisclosure:!0},feedback:{enabled:!0,types:["explicit","implicit","behavioral"],collection:"continuous",analysis:!0},engagement:{gamification:!0,achievements:!0,progressTracking:!0,socialFeatures:!1}}}},{key:"createAnalyticsDefaults",value:function(){return{tracking:{enabled:!0,anonymized:!0,consentRequired:!0,retentionPeriod:31536e6},metrics:{userEngagement:!0,aiPerformance:!0,systemHealth:!0,conversion:!1},reporting:{realTime:!0,dashboards:!0,alerts:!0,exportFormats:["json","csv","pdf"]},privacy:{dataMinimization:!0,purposeLimitation:!0,consentManagement:!0,dataPortability:!0}}}},{key:"initializeConfigs",value:(s=Be(Ge().m(function e(){var t,n,r,i,o,a,s,c;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:t=0,n=Object.entries(this.defaultConfigs);case 1:if(!(t<n.length)){e.n=6;break}return r=qe(n[t],2),i=r[0],o=r[1],e.p=2,e.n=3,this.storage.get("config_".concat(i));case 3:a=e.v,s=a?Ee(Ee({},o),a):o,this.configs.set(i,s),e.n=5;break;case 4:e.p=4,c=e.v,console.error("[ConfigManager] Error loading ".concat(i," config:"),c),this.configs.set(i,o);case 5:t++,e.n=1;break;case 6:console.log("[ConfigManager] Configurations initialized");case 7:return e.a(2)}},e,this,[[2,4]])})),function(){return s.apply(this,arguments)})},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.split("."),r=n[0],i=n.slice(1),o=this.configs.get(r);if(!o)return t;var a,s=o,c=Ie(i);try{for(c.s();!(a=c.n()).done;){var u=a.value;if(!s||"object"!==Fe(s)||!(u in s))return t;s=s[u]}}catch(e){c.e(e)}finally{c.f()}return s}},{key:"set",value:(a=Be(Ge().m(function e(t,n){var r,i,o,a,s,c,u,l,f,p,h,d,m,v=arguments;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=(r=v.length>2&&void 0!==v[2]?v[2]:{}).validate,o=void 0===i||i,a=r.persist,s=void 0===a||a,c=r.notify,u=void 0===c||c,e.p=1,l=t.split("."),f=l[0],p=l.slice(1),this.configs.has(f)){e.n=2;break}throw new Error("Unknown configuration category: ".concat(f));case 2:if(!o){e.n=4;break}return e.n=3,this.validateConfig(t,n);case 3:if((h=e.v).valid){e.n=4;break}throw new Error("Configuration validation failed: ".concat(h.errors.join(", ")));case 4:if(d=this.configs.get(f),this.setNestedValue(d,p,n),!s){e.n=5;break}return e.n=5,this.storage.set("config_".concat(f),d);case 5:if(!u){e.n=6;break}return e.n=6,this.notifyListeners(t,n);case 6:return e.a(2,{success:!0});case 7:return e.p=7,m=e.v,console.error("[ConfigManager] Set config error:",m),e.a(2,{success:!1,error:m.message})}},e,this,[[1,7]])})),function(e,t){return a.apply(this,arguments)})},{key:"setBatch",value:(o=Be(Ge().m(function e(t){var n,r,i,o,a,s,c,u,l=arguments;return Ge().w(function(e){for(;;)switch(e.n){case 0:n=l.length>1&&void 0!==l[1]?l[1]:{},r=[],i=0,o=Object.entries(t);case 1:if(!(i<o.length)){e.n=4;break}return a=qe(o[i],2),s=a[0],c=a[1],e.n=2,this.set(s,c,Ee(Ee({},n),{},{notify:!1}));case 2:u=e.v,r.push(Ee({path:s},u));case 3:i++,e.n=1;break;case 4:if(!1===n.notify){e.n=5;break}return e.n=5,this.notifyListeners("batch",t);case 5:return e.a(2,r)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"reset",value:(i=Be(Ge().m(function e(){var t,n,r,i,o,a,s,c,u,l,f,p,h=arguments;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:null,r=(n=h.length>1&&void 0!==h[1]?h[1]:{}).persist,i=void 0===r||r,o=n.notify,a=void 0===o||o,e.p=1,!t){e.n=4;break}if(this.defaultConfigs[t]){e.n=2;break}throw new Error("Unknown category: ".concat(t));case 2:if(this.configs.set(t,Ee({},this.defaultConfigs[t])),!i){e.n=3;break}return e.n=3,this.storage.set("config_".concat(t),this.configs.get(t));case 3:e.n=7;break;case 4:s=0,c=Object.entries(this.defaultConfigs);case 5:if(!(s<c.length)){e.n=7;break}if(u=qe(c[s],2),l=u[0],f=u[1],this.configs.set(l,Ee({},f)),!i){e.n=6;break}return e.n=6,this.storage.set("config_".concat(l),this.configs.get(l));case 6:s++,e.n=5;break;case 7:if(!a){e.n=8;break}return e.n=8,this.notifyListeners("reset",{category:t});case 8:return e.a(2,{success:!0});case 9:return e.p=9,p=e.v,console.error("[ConfigManager] Reset error:",p),e.a(2,{success:!1,error:p.message})}},e,this,[[1,9]])})),function(){return i.apply(this,arguments)})},{key:"subscribe",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).immediate,r=void 0!==n&&n,i="config_sub_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));return this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push({id:i,callback:t,active:!0}),r&&t(this.get(e),{type:"initial",path:e}),i}},{key:"unsubscribe",value:function(e){var t,n=Ie(this.listeners);try{for(n.s();!(t=n.n()).done;){var r=qe(t.value,2),i=r[0],o=r[1],a=o.findIndex(function(t){return t.id===e});if(-1!==a)return o.splice(a,1),0===o.length&&this.listeners.delete(i),!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"addValidator",value:function(e,t){this.validators.set(e,t)}},{key:"addSchema",value:function(e,t){this.schemas.set(e,t)}},{key:"validateConfig",value:(r=Be(Ge().m(function e(t,n){var r,i,o,a,s,c,u;return Ge().w(function(e){for(;;)switch(e.n){case 0:if(r=[],!(i=this.validators.get(t))){e.n=2;break}return e.n=1,i(n);case 1:(o=e.v).valid||r.push.apply(r,Te(o.errors));case 2:if((a=this.schemas.get(t))&&((s=this.validateAgainstSchema(n,a)).valid||r.push.apply(r,Te(s.errors))),!(c=this.getTypeValidator(t))){e.n=4;break}return e.n=3,c(n);case 3:(u=e.v).valid||r.push.apply(r,Te(u.errors));case 4:return e.a(2,{valid:0===r.length,errors:r})}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"getTypeValidator",value:function(e){return{"ai.reasoning.maxDepth":function(e){return{valid:Number.isInteger(e)&&e>0&&e<=10,errors:["Max depth must be an integer between 1 and 10"]}},"ai.reasoning.confidenceThreshold":function(e){return{valid:"number"==typeof e&&e>=0&&e<=1,errors:["Confidence threshold must be a number between 0 and 1"]}},"performance.caching.maxSize":function(e){return{valid:Number.isInteger(e)&&e>0,errors:["Cache max size must be a positive integer"]}},"ui.animations.duration":function(e){return{valid:Number.isInteger(e)&&e>=0&&e<=5e3,errors:["Animation duration must be between 0 and 5000ms"]}}}[e]}},{key:"validateAgainstSchema",value:function(e,t){var n=[];return t.type&&Fe(e)!==t.type&&n.push("Expected type ".concat(t.type,", got ").concat(Fe(e))),"number"===t.type&&(void 0!==t.minimum&&e<t.minimum&&n.push("Value must be >= ".concat(t.minimum)),void 0!==t.maximum&&e>t.maximum&&n.push("Value must be <= ".concat(t.maximum))),"array"===t.type&&(Array.isArray(e)?(void 0!==t.minItems&&e.length<t.minItems&&n.push("Array must have at least ".concat(t.minItems," items")),void 0!==t.maxItems&&e.length>t.maxItems&&n.push("Array must have at most ".concat(t.maxItems," items"))):n.push("Value must be an array")),t.enum&&!t.enum.includes(e)&&n.push("Value must be one of: ".concat(t.enum.join(", "))),{valid:0===n.length,errors:n}}},{key:"notifyListeners",value:(n=Be(Ge().m(function e(t,n){var r,i,o,a,s,c,u,l,f,p,h,d;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:r=this.listeners.get(t)||[],i=Ie(r),e.p=1,i.s();case 2:if((o=i.n()).done){e.n=7;break}if(!(a=o.value).active){e.n=6;break}return e.p=3,e.n=4,a.callback(n,{path:t,type:"update"});case 4:e.n=6;break;case 5:e.p=5,f=e.v,console.error("[ConfigManager] Listener error:",f);case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,p=e.v,i.e(p);case 9:return e.p=9,i.f(),e.f(9);case 10:s=this.listeners.get("*")||[],c=Ie(s),e.p=11,c.s();case 12:if((u=c.n()).done){e.n=17;break}if(!(l=u.value).active){e.n=16;break}return e.p=13,e.n=14,l.callback(n,{path:t,type:"update",wildcard:!0});case 14:e.n=16;break;case 15:e.p=15,h=e.v,console.error("[ConfigManager] Wildcard listener error:",h);case 16:e.n=12;break;case 17:e.n=19;break;case 18:e.p=18,d=e.v,c.e(d);case 19:return e.p=19,c.f(),e.f(19);case 20:return e.a(2)}},e,this,[[13,15],[11,18,19,20],[3,5],[1,8,9,10]])})),function(e,t){return n.apply(this,arguments)})},{key:"setNestedValue",value:function(e,t,n){for(var r=e,i=0;i<t.length-1;i++){var o=t[i];o in r&&"object"===Fe(r[o])||(r[o]={}),r=r[o]}r[t[t.length-1]]=n}},{key:"exportConfigs",value:(t=Be(Ge().m(function e(){var t,n,r,i,o,a;return Ge().w(function(e){for(;;)if(0===e.n){t={},n=Ie(this.configs);try{for(n.s();!(r=n.n()).done;)i=qe(r.value,2),o=i[0],a=i[1],t[o]=this.deepClone(a)}catch(e){n.e(e)}finally{n.f()}return e.a(2,{configs:t,timestamp:Date.now(),version:"1.0"})}},e,this)})),function(){return t.apply(this,arguments)})},{key:"importConfigs",value:(e=Be(Ge().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d,m,v,y,g,b,w,S,k=arguments;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=(n=k.length>1&&void 0!==k[1]?k[1]:{}).merge,i=void 0===r||r,o=n.validate,a=void 0===o||o,e.p=1,t.configs){e.n=2;break}throw new Error("Invalid import data: missing configs");case 2:s=0,c=Object.entries(t.configs);case 3:if(!(s<c.length)){e.n=10;break}if(u=qe(c[s],2),l=u[0],f=u[1],this.configs.has(l)){e.n=4;break}return console.warn("[ConfigManager] Unknown category in import: ".concat(l)),e.a(3,9);case 4:if(p=void 0,i?(h=this.configs.get(l),p=this.deepMerge(h,f)):p=f,!a){e.n=8;break}d=0,m=Object.entries(this.flattenConfig(p));case 5:if(!(d<m.length)){e.n=8;break}return v=qe(m[d],2),y=v[0],g=v[1],b="".concat(l,".").concat(y),e.n=6,this.validateConfig(b,g);case 6:if((w=e.v).valid){e.n=7;break}throw new Error("Validation failed for ".concat(b,": ").concat(w.errors.join(", ")));case 7:d++,e.n=5;break;case 8:return this.configs.set(l,p),e.n=9,this.storage.set("config_".concat(l),p);case 9:s++,e.n=3;break;case 10:return e.n=11,this.notifyListeners("import",t);case 11:return e.a(2,{success:!0});case 12:return e.p=12,S=e.v,console.error("[ConfigManager] Import error:",S),e.a(2,{success:!1,error:S.message})}},e,this,[[1,12]])})),function(t){return e.apply(this,arguments)})},{key:"deepClone",value:function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return console.error("[ConfigManager] Deep clone error:",t),e}}},{key:"deepMerge",value:function(e,t){var n=Ee({},e);for(var r in t)t[r]&&"object"===Fe(t[r])&&!Array.isArray(t[r])?n[r]=this.deepMerge(e[r]||{},t[r]):n[r]=t[r];return n}},{key:"flattenConfig",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={},r=0,i=Object.entries(e);r<i.length;r++){var o=qe(i[r],2),a=o[0],s=o[1],c=t?"".concat(t,".").concat(a):a;s&&"object"===Fe(s)&&!Array.isArray(s)?Object.assign(n,this.flattenConfig(s,c)):n[c]=s}return n}},{key:"getStatus",value:function(){return{categories:Array.from(this.configs.keys()),listeners:Array.from(this.listeners.values()).reduce(function(e,t){return e+t.length},0),validators:this.validators.size,schemas:this.schemas.size}}},{key:"getConfigSummary",value:function(){var e,t={},n=Ie(this.configs);try{for(n.s();!(e=n.n()).done;){var r=qe(e.value,2),i=r[0],o=r[1];t[i]={keys:Object.keys(this.flattenConfig(o)).length,size:JSON.stringify(o).length}}}catch(e){n.e(e)}finally{n.f()}return t}}]);var e,t,n,r,i,o,a,s}();function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||et(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Qe(e)+" is not iterable")}function Ze(e){return function(e){if(Array.isArray(e))return tt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||et(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=et(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function et(e,t){if(e){if("string"==typeof e)return tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach(function(t){it(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function it(e,t,n){return(t=lt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ot(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return at(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(at(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,at(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,at(f,"constructor",u),at(u,"constructor",c),c.displayName="GeneratorFunction",at(u,i,"GeneratorFunction"),at(f),at(f,i,"Generator"),at(f,r,function(){return this}),at(f,"toString",function(){return"[object Generator]"}),(ot=function(){return{w:o,m:p}})()}function at(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}at=function(e,t,n,r){function o(t,n){at(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},at(e,t,n,r)}function st(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ct(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){st(o,r,i,a,s,"next",e)}function s(e){st(o,r,i,a,s,"throw",e)}a(void 0)})}}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lt(r.key),r)}}function lt(e){var t=function(e){if("object"!=Qe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qe(t)?t:t+""}var ft=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.storage,r=t.maxMemoryItems,i=void 0===r?1e4:r,o=t.enableCompression,a=void 0===o||o;this.storage=n,this.config={maxEpisodicMemory:i,maxSemanticMemory:500,workingMemorySize:50,compressionEnabled:a,autoCleanup:!0,cleanupInterval:3e5},this.workingMemory=new Map,this.initializeMemory()},t=[{key:"initializeMemory",value:(c=ct(ot().m(function e(){var t;return ot().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.storage){e.n=1;break}throw new Error("OptimizedStorage instance was not provided to MemorySystem.");case 1:return e.n=2,this.storage.initialize();case 2:console.log("[MemorySystem] Memory System initialized and connected to storage."),e.n=4;break;case 3:e.p=3,t=e.v,console.error("[MemorySystem] Error initializing memory storage:",t);case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"store",value:(s=ct(ot().m(function e(t,n){var r,i,o,a,s=arguments;return ot().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:{},e.p=1,i={id:this.generateId(),data:n,timestamp:Date.now(),type:t,metadata:rt(rt({},r),{},{accessCount:0,lastAccess:Date.now()})},"working"!==t){e.n=2;break}return this.storeWorking(i),e.a(2,i.id);case 2:return e.n=3,this.storage.store(i);case 3:if((o=e.v).success){e.n=4;break}throw new Error(o.error||"Failed to store entry in OptimizedStorage");case 4:return e.a(2,i.id);case 5:throw e.p=5,a=e.v,console.error("[MemorySystem] Error storing ".concat(t," memory:"),a),a;case 6:return e.a(2)}},e,this,[[1,5]])})),function(e,t){return s.apply(this,arguments)})},{key:"retrieve",value:(a=ct(ot().m(function e(t,n){var r,i,o,a,s,c,u,l,f,p,h,d,m,v,y=arguments;return ot().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=(r=y.length>2&&void 0!==y[2]?y[2]:{}).limit,o=void 0===i?10:i,a=r.minConfidence,s=void 0===a?.5:a,c=r.includeMetadata,u=void 0!==c&&c,e.p=1,"working"!==t){e.n=2;break}return e.a(2,this.retrieveWorking(n));case 2:return e.n=3,this.storage.search({text:n,type:t,limit:o,minConfidence:s});case 3:l=e.v,f=l.results||[],p=Ye(f),e.p=4,p.s();case 5:if((h=p.n()).done){e.n=7;break}return d=h.value,e.n=6,this.updateAccessStats(d.id,t);case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,m=e.v,p.e(m);case 9:return e.p=9,p.f(),e.f(9);case 10:return e.a(2,f.map(function(e){return{id:e.id,data:u?e:e.data,confidence:e.relevanceScore||.5,metadata:u?e.metadata:void 0}}));case 11:return e.p=11,v=e.v,console.error("[MemorySystem] Error retrieving ".concat(t," memory:"),v),e.a(2,[])}},e,this,[[4,8,9,10],[1,11]])})),function(e,t){return a.apply(this,arguments)})},{key:"search",value:(o=ct(ot().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d,m=this,v=arguments;return ot().w(function(e){for(;;)switch(e.p=e.n){case 0:r=(n=v.length>1&&void 0!==v[1]?v[1]:{}).types,i=void 0===r?["episodic","semantic"]:r,o=n.limit,a=void 0===o?20:o,s=n.sortBy,c=void 0===s?"relevance":s,u=[],l=Ye(i),e.p=1,p=ot().m(function e(){var n,r;return ot().w(function(e){for(;;)switch(e.n){case 0:return n=f.value,e.n=1,m.storage.searchFullText(t,{limit:a});case 1:(r=e.v)&&u.push.apply(u,Ze(r.map(function(e){return rt(rt({},e),{},{source:n})})));case 2:return e.a(2)}},e)}),l.s();case 2:if((f=l.n()).done){e.n=4;break}return e.d(Xe(p()),3);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,d=e.v,l.e(d);case 6:return e.p=6,l.f(),e.f(6);case 7:return h=this.sortResults(u,c),e.a(2,this.deduplicateResults(h).slice(0,a))}},e,this,[[1,5,6,7]])})),function(e){return o.apply(this,arguments)})},{key:"storeWorking",value:function(e){if(this.workingMemory.size>=this.config.workingMemorySize){var t=Array.from(this.workingMemory.entries()).sort(function(e,t){var n,r,i=$e(e,2)[1],o=$e(t,2)[1];return((null===(n=i.metadata)||void 0===n?void 0:n.lastAccess)||0)-((null===(r=o.metadata)||void 0===r?void 0:r.lastAccess)||0)})[0][0];this.workingMemory.delete(t)}this.workingMemory.set(e.id,e)}},{key:"retrieveWorking",value:function(e){var t,n=[],r=Ye(this.workingMemory);try{for(r.s();!(t=r.n()).done;){var i=$e(t.value,2),o=i[0],a=i[1],s=this.scoreWorkingMatch(a,e);s>0&&n.push({id:o,data:a.data,confidence:s,metadata:a.metadata})}}catch(e){r.e(e)}finally{r.f()}return n.sort(function(e,t){return t.confidence-e.confidence})}},{key:"scoreWorkingMatch",value:function(e,t){var n="string"==typeof t?t.toLowerCase():JSON.stringify(t).toLowerCase();return JSON.stringify(e.data).toLowerCase().includes(n)?.8:0}},{key:"generateId",value:function(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9))}},{key:"sortResults",value:function(e,t){return"relevance"===t?e.sort(function(e,t){return(t.relevanceScore||0)-(e.relevanceScore||0)}):e.sort(function(e,t){return(t.timestamp||0)-(e.timestamp||0)})}},{key:"deduplicateResults",value:function(e){var t=new Set;return e.filter(function(e){var n=t.has(e.id);return t.add(e.id),!n})}},{key:"updateAccessStats",value:(i=ct(ot().m(function e(t,n){return ot().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)})),function(e,t){return i.apply(this,arguments)})},{key:"compress",value:(r=ct(ot().m(function e(t){return ot().w(function(e){for(;;)if(0===e.n)return e.a(2,t)},e)})),function(e){return r.apply(this,arguments)})},{key:"decompress",value:(n=ct(ot().m(function e(t){return ot().w(function(e){for(;;)if(0===e.n)return e.a(2,t)},e)})),function(e){return n.apply(this,arguments)})}],t&&ut(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,o,a,s,c}();function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ht(e){return function(e){if(Array.isArray(e))return wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||bt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||bt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach(function(t){yt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yt(e,t,n){return(t=Pt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=bt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bt(e,t){if(e){if("string"==typeof e)return wt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(e,t):void 0}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function St(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return kt(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(kt(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,kt(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,kt(f,"constructor",u),kt(u,"constructor",c),c.displayName="GeneratorFunction",kt(u,i,"GeneratorFunction"),kt(f),kt(f,i,"Generator"),kt(f,r,function(){return this}),kt(f,"toString",function(){return"[object Generator]"}),(St=function(){return{w:o,m:p}})()}function kt(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}kt=function(e,t,n,r){function o(t,n){kt(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},kt(e,t,n,r)}function jt(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ot(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){jt(o,r,i,a,s,"next",e)}function s(e){jt(o,r,i,a,s,"throw",e)}a(void 0)})}}function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pt(r.key),r)}}function Pt(e){var t=function(e){if("object"!=pt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}var xt=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ai_memory_db",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dbName=t,this.version=n,this.db=null,this.isInitialized=!1,this.initPromise=null,this.cache=new Map,this.cacheSize=1e3,this.cacheTTL=3e5,this.stats={reads:0,writes:0,deletes:0,cacheHits:0,cacheMisses:0,avgReadTime:0,avgWriteTime:0}},t=[{key:"initialize",value:(T=Ot(St().m(function e(){return St().w(function(e){for(;;)switch(e.n){case 0:if(!this.initPromise){e.n=1;break}return e.a(2,this.initPromise);case 1:return this.initPromise=this._initDatabase(),e.a(2,this.initPromise)}},e,this)})),function(){return T.apply(this,arguments)})},{key:"_initDatabase",value:(_=Ot(St().m(function e(){var t=this;return St().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var r=indexedDB.open(t.dbName,t.version);r.onerror=function(){console.error("[OptimizedStorage] Database error:",r.error),n(r.error)},r.onsuccess=function(){t.db=r.result,t.isInitialized=!0,console.log("[OptimizedStorage] Database initialized"),e()},r.onupgradeneeded=function(e){var t=e.target.result;if(!t.objectStoreNames.contains("entries")){var n=t.createObjectStore("entries",{keyPath:"id"});n.createIndex("type","type",{unique:!1}),n.createIndex("timestamp","timestamp",{unique:!1}),n.createIndex("content","content",{unique:!1}),n.createIndex("tags","tags",{unique:!1,multiEntry:!0}),n.createIndex("userId","userId",{unique:!1}),n.createIndex("sessionId","sessionId",{unique:!1}),n.createIndex("confidence","confidence",{unique:!1}),n.createIndex("type_timestamp",["type","timestamp"],{unique:!1}),n.createIndex("user_timestamp",["userId","timestamp"],{unique:!1})}t.objectStoreNames.contains("inverted_index")||t.createObjectStore("inverted_index",{keyPath:"term"}).createIndex("entries","entries",{unique:!1,multiEntry:!0}),t.objectStoreNames.contains("semantic_vectors")||t.createObjectStore("semantic_vectors",{keyPath:"id"}).createIndex("vector","vector",{unique:!1}),t.objectStoreNames.contains("metadata")||t.createObjectStore("metadata",{keyPath:"key"}),t.objectStoreNames.contains("cache")||t.createObjectStore("cache",{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("[OptimizedStorage] Database schema created")}}))},e)})),function(){return _.apply(this,arguments)})},{key:"store",value:(C=Ot(St().m(function e(t){var n,r,i,o,a;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return n=Date.now(),r=this.db.transaction(["entries","inverted_index","semantic_vectors"],"readwrite"),e.p=2,i=r.objectStore("entries"),e.n=3,this._put(i,t);case 3:return e.n=4,this._updateInvertedIndex(r,t);case 4:if(!t.vector){e.n=5;break}return o=r.objectStore("semantic_vectors"),e.n=5,this._put(o,{id:t.id,vector:t.vector,timestamp:t.timestamp});case 5:return this._updateCache(t.id,t),this.stats.writes++,this.stats.avgWriteTime=(this.stats.avgWriteTime+(Date.now()-n))/2,e.a(2,{success:!0,id:t.id});case 6:return e.p=6,a=e.v,console.error("[OptimizedStorage] Store error:",a),e.a(2,{success:!1,error:a.message})}},e,this,[[2,6]])})),function(e){return C.apply(this,arguments)})},{key:"retrieve",value:(x=Ot(St().m(function e(t){var n,r,i,o,a,s;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:if(!(n=this._getFromCache(t))){e.n=2;break}return this.stats.cacheHits++,e.a(2,n);case 2:return this.stats.cacheMisses++,r=Date.now(),e.p=3,i=this.db.transaction(["entries"],"readonly"),o=i.objectStore("entries"),e.n=4,this._get(o,t);case 4:return(a=e.v)&&(this._updateCache(t,a),this.stats.reads++,this.stats.avgReadTime=(this.stats.avgReadTime+(Date.now()-r))/2),e.a(2,a);case 5:return e.p=5,s=e.v,console.error("[OptimizedStorage] Retrieve error:",s),e.a(2,null)}},e,this,[[3,5]])})),function(e){return x.apply(this,arguments)})},{key:"delete",value:(P=Ot(St().m(function e(t){var n;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.remove(t);case 1:return e.a(2,{success:!0});case 2:return e.p=2,n=e.v,console.error("[OptimizedStorage] Delete error:",n),e.a(2,{success:!1,error:n.message})}},e,this,[[0,2]])})),function(e){return P.apply(this,arguments)})},{key:"search",value:(z=Ot(St().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d,m,v,y,g,b;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:if(n=t.text,r=t.type,i=t.userId,o=t.sessionId,a=t.dateRange,s=t.tags,c=t.minConfidence,u=t.limit,l=void 0===u?50:u,f=t.offset,p=void 0===f?0:f,e.p=2,h=this.db.transaction(["entries"],"readonly"),d=h.objectStore("entries"),m=[],!r){e.n=4;break}return v=d.index("type"),e.n=3,this._getAllFromIndex(v,r);case 3:y=e.v,m=y,e.n=6;break;case 4:return e.n=5,this._getAll(d,2*l);case 5:m=e.v;case 6:return(m=m.filter(function(e){if(i&&e.userId!==i)return!1;if(o&&e.sessionId!==o)return!1;if(c&&e.confidence<c)return!1;if(a){var t=new Date(e.timestamp);if(t<a.start||t>a.end)return!1}if(s&&s.length>0){var r=e.tags||[];if(!s.some(function(e){return r.includes(e)}))return!1}return!(n&&!"".concat(e.content," ").concat(e.title||"").toLowerCase().includes(n.toLowerCase()))})).sort(function(e,t){return t.timestamp-e.timestamp}),g=m.slice(p,p+l),e.a(2,{results:g,total:m.length,hasMore:m.length>p+l});case 7:return e.p=7,b=e.v,console.error("[OptimizedStorage] Search error:",b),e.a(2,{results:[],total:0,hasMore:!1})}},e,this,[[2,7]])})),function(e){return z.apply(this,arguments)})},{key:"searchFullText",value:(O=Ot(St().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d,m,v,y,g,b,w,S,k,j,O,z=arguments;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=z.length>1&&void 0!==z[1]?z[1]:{},e.n=1,this.ensureInitialized();case 1:r=n.fuzzy,i=void 0===r||r,o=n.limit,a=void 0===o?50:o,e.p=2,s=this.db.transaction(["inverted_index","entries"],"readonly"),c=this._tokenizeForSearch(t),u=s.objectStore("inverted_index"),l=s.objectStore("entries"),f=new Set,p=gt(c),e.p=3,p.s();case 4:if((h=p.n()).done){e.n=11;break}return d=h.value,e.p=5,e.n=6,this._get(u,d);case 6:if((m=e.v)&&m.entries&&m.entries.forEach(function(e){return f.add(e)}),!i){e.n=8;break}return e.n=7,this._fuzzySearch(u,d);case 7:e.v.forEach(function(e){return f.add(e)});case 8:e.n=10;break;case 9:e.p=9,e.v;case 10:e.n=4;break;case 11:e.n=13;break;case 12:e.p=12,k=e.v,p.e(k);case 13:return e.p=13,p.f(),e.f(13);case 14:v=[],y=gt(f),e.p=15,y.s();case 16:if((g=y.n()).done){e.n=21;break}return b=g.value,e.p=17,e.n=18,this._get(l,b);case 18:(w=e.v)&&(S=this._calculateRelevanceScore(w,c),v.push(vt(vt({},w),{},{relevanceScore:S}))),e.n=20;break;case 19:e.p=19,e.v;case 20:e.n=16;break;case 21:e.n=23;break;case 22:e.p=22,j=e.v,y.e(j);case 23:return e.p=23,y.f(),e.f(23);case 24:return v.sort(function(e,t){return t.relevanceScore-e.relevanceScore}),e.a(2,v.slice(0,a));case 25:return e.p=25,O=e.v,console.error("[OptimizedStorage] Full-text search error:",O),e.a(2,[])}},e,this,[[17,19],[15,22,23,24],[5,9],[3,12,13,14],[2,25]])})),function(e){return O.apply(this,arguments)})},{key:"searchSemantic",value:(j=Ot(St().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d,m,v=arguments;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=v.length>1&&void 0!==v[1]?v[1]:{},e.n=1,this.ensureInitialized();case 1:return r=n.threshold,i=void 0===r?.8:r,o=n.limit,a=void 0===o?20:o,e.p=2,s=this.db.transaction(["semantic_vectors"],"readonly"),c=s.objectStore("semantic_vectors"),e.n=3,this._getAll(c);case 3:u=e.v,l=[],f=gt(u);try{for(f.s();!(p=f.n()).done;)h=p.value,(d=this._cosineSimilarity(t,h.vector))>=i&&l.push({id:h.id,similarity:d,timestamp:h.timestamp})}catch(e){f.e(e)}finally{f.f()}return l.sort(function(e,t){return t.similarity-e.similarity}),e.a(2,l.slice(0,a));case 4:return e.p=4,m=e.v,console.error("[OptimizedStorage] Semantic search error:",m),e.a(2,[])}},e,this,[[2,4]])})),function(e){return j.apply(this,arguments)})},{key:"storeBatch",value:(k=Ot(St().m(function e(t){var n,r,i,o,a,s,c,u,l,f,p,h,d=this;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:n=this.db.transaction(["entries","inverted_index","semantic_vectors"],"readwrite"),e.p=2,r=n.objectStore("entries"),i=n.objectStore("inverted_index"),o=n.objectStore("semantic_vectors"),a=100,s=0;case 3:if(!(s<t.length)){e.n=13;break}c=t.slice(s,s+a),u=gt(c),e.p=4,u.s();case 5:if((l=u.n()).done){e.n=9;break}return f=l.value,e.n=6,this._put(r,f);case 6:return e.n=7,this._updateInvertedIndexForEntry(i,f);case 7:if(!f.vector){e.n=8;break}return e.n=8,this._put(o,{id:f.id,vector:f.vector,timestamp:f.timestamp});case 8:e.n=5;break;case 9:e.n=11;break;case 10:e.p=10,p=e.v,u.e(p);case 11:return e.p=11,u.f(),e.f(11);case 12:s+=a,e.n=3;break;case 13:return t.forEach(function(e){return d._updateCache(e.id,e)}),this.stats.writes+=t.length,e.a(2,{success:!0,count:t.length});case 14:return e.p=14,h=e.v,console.error("[OptimizedStorage] Batch store error:",h),e.a(2,{success:!1,error:h.message})}},e,this,[[4,10,11,12],[2,14]])})),function(e){return k.apply(this,arguments)})},{key:"deleteBatch",value:(S=Ot(St().m(function e(t){var n,r,i,o,a,s,c,u,l;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:n=this.db.transaction(["entries","inverted_index","semantic_vectors"],"readwrite"),e.p=2,r=n.objectStore("entries"),i=n.objectStore("inverted_index"),o=n.objectStore("semantic_vectors"),a=gt(t),e.p=3,a.s();case 4:if((s=a.n()).done){e.n=9;break}return c=s.value,e.n=5,this._delete(r,c);case 5:return e.n=6,this._removeFromInvertedIndexForId(i,c);case 6:return e.n=7,this._delete(o,c);case 7:this.cache.delete(c);case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,u=e.v,a.e(u);case 11:return e.p=11,a.f(),e.f(11);case 12:return this.stats.deletes+=t.length,e.a(2,{success:!0,count:t.length});case 13:return e.p=13,l=e.v,console.error("[OptimizedStorage] Batch delete error:",l),e.a(2,{success:!1,error:l.message})}},e,this,[[3,10,11,12],[2,13]])})),function(e){return S.apply(this,arguments)})},{key:"optimize",value:(w=Ot(St().m(function e(){var t;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return e.p=1,e.n=2,this._rebuildIndexes();case 2:return e.n=3,this._compactDatabase();case 3:return this._cleanCache(),e.n=4,this._updateMetadata("lastOptimization",Date.now());case 4:return console.log("[OptimizedStorage] Optimization completed"),e.a(2,{success:!0});case 5:return e.p=5,t=e.v,console.error("[OptimizedStorage] Optimization error:",t),e.a(2,{success:!1,error:t.message})}},e,this,[[1,5]])})),function(){return w.apply(this,arguments)})},{key:"cleanup",value:(b=Ot(St().m(function e(){var t,n,r,i,o,a,s,c,u=arguments;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:2592e6,e.n=1,this.ensureInitialized();case 1:return n=Date.now()-t,e.p=2,r=this.db.transaction(["entries"],"readwrite"),i=r.objectStore("entries"),o=i.index("timestamp"),e.n=3,this._getAllFromIndex(o,IDBKeyRange.upperBound(n));case 3:if(a=e.v,!((s=a.map(function(e){return e.id})).length>0)){e.n=5;break}return e.n=4,this.deleteBatch(s);case 4:console.log("[OptimizedStorage] Cleaned up ".concat(s.length," old entries"));case 5:return e.a(2,{success:!0,cleanedCount:s.length});case 6:return e.p=6,c=e.v,console.error("[OptimizedStorage] Cleanup error:",c),e.a(2,{success:!1,error:c.message})}},e,this,[[2,6]])})),function(){return b.apply(this,arguments)})},{key:"createBackup",value:(g=Ot(St().m(function e(){var t,n,r,i,o;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return e.p=1,t=this.db.transaction(["entries","metadata"],"readonly"),e.n=2,this._getAll(t.objectStore("entries"));case 2:return n=e.v,e.n=3,this._getAll(t.objectStore("metadata"));case 3:return r=e.v,i={timestamp:Date.now(),version:this.version,entries:n,metadata:r,stats:vt({},this.stats)},e.a(2,i);case 4:return e.p=4,o=e.v,console.error("[OptimizedStorage] Backup creation error:",o),e.a(2,null)}},e,this,[[1,4]])})),function(){return g.apply(this,arguments)})},{key:"restoreFromBackup",value:(y=Ot(St().m(function e(t){var n,r,i,o,a,s,c;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return e.p=1,e.n=2,this.clear();case 2:if(!t.entries){e.n=3;break}return e.n=3,this.storeBatch(t.entries);case 3:if(!t.metadata){e.n=10;break}n=this.db.transaction(["metadata"],"readwrite"),r=n.objectStore("metadata"),i=gt(t.metadata),e.p=4,i.s();case 5:if((o=i.n()).done){e.n=7;break}return a=o.value,e.n=6,this._put(r,a);case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,s=e.v,i.e(s);case 9:return e.p=9,i.f(),e.f(9);case 10:return console.log("[OptimizedStorage] Backup restored successfully"),e.a(2,{success:!0});case 11:return e.p=11,c=e.v,console.error("[OptimizedStorage] Backup restore error:",c),e.a(2,{success:!1,error:c.message})}},e,this,[[4,8,9,10],[1,11]])})),function(e){return y.apply(this,arguments)})},{key:"clear",value:(v=Ot(St().m(function e(){var t,n;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return t=this.db.transaction(["entries","inverted_index","semantic_vectors","metadata"],"readwrite"),e.p=2,e.n=3,this._clear(t.objectStore("entries"));case 3:return e.n=4,this._clear(t.objectStore("inverted_index"));case 4:return e.n=5,this._clear(t.objectStore("semantic_vectors"));case 5:return e.n=6,this._clear(t.objectStore("metadata"));case 6:return this.cache.clear(),e.a(2,{success:!0});case 7:return e.p=7,n=e.v,console.error("[OptimizedStorage] Clear error:",n),e.a(2,{success:!1,error:n.message})}},e,this,[[2,7]])})),function(){return v.apply(this,arguments)})},{key:"getStats",value:function(){return vt(vt({},this.stats),{},{cacheSize:this.cache.size,isInitialized:this.isInitialized,dbVersion:this.version,cacheHitRate:this.stats.cacheHits/(this.stats.cacheHits+this.stats.cacheMisses)||0})}},{key:"getStorageInfo",value:(m=Ot(St().m(function e(){var t,n,r,i,o,a,s;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.ensureInitialized();case 1:return e.p=1,t=this.db.transaction(["entries"],"readonly"),n=t.objectStore("entries"),e.n=2,this._count(n);case 2:return r=e.v,i=r,e.n=3,this._estimateSize();case 3:return o=e.v,e.n=4,this._checkIndexes();case 4:return a=e.v,e.a(2,{totalEntries:i,dbSize:o,indexesStatus:a});case 5:return e.p=5,s=e.v,console.error("[OptimizedStorage] Storage info error:",s),e.a(2,null)}},e,this,[[1,5]])})),function(){return m.apply(this,arguments)})},{key:"ensureInitialized",value:(d=Ot(St().m(function e(){return St().w(function(e){for(;;)switch(e.n){case 0:if(this.isInitialized){e.n=1;break}return e.n=1,this.initialize();case 1:return e.a(2)}},e,this)})),function(){return d.apply(this,arguments)})},{key:"_updateCache",value:function(e,t){if(this.cache.size>=this.cacheSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,{value:t,timestamp:Date.now()})}},{key:"_getFromCache",value:function(e){var t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.cacheTTL?t.value:(this.cache.delete(e),null)}},{key:"_cleanCache",value:function(){var e,t=Date.now(),n=gt(this.cache);try{for(n.s();!(e=n.n()).done;){var r=dt(e.value,2),i=r[0];t-r[1].timestamp>this.cacheTTL&&this.cache.delete(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_updateInvertedIndex",value:(h=Ot(St().m(function e(t,n){var r,i,o,a,s,c,u,l;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:r=t.objectStore("inverted_index"),i=this._tokenizeForIndex(n.content+" "+(n.title||"")),o=gt(i),e.p=1,o.s();case 2:if((a=o.n()).done){e.n=5;break}return s=a.value,e.n=3,this._get(r,s);case 3:if(c=e.v,(u=c?c.entries:[]).includes(n.id)){e.n=4;break}return u.push(n.id),e.n=4,this._put(r,{term:s,entries:u});case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,l=e.v,o.e(l);case 7:return e.p=7,o.f(),e.f(7);case 8:return e.a(2)}},e,this,[[1,6,7,8]])})),function(e,t){return h.apply(this,arguments)})},{key:"_updateInvertedIndexForEntry",value:(p=Ot(St().m(function e(t,n){var r,i,o,a,s,c,u;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:r=this._tokenizeForIndex(n.content+" "+(n.title||"")),i=gt(r),e.p=1,i.s();case 2:if((o=i.n()).done){e.n=5;break}return a=o.value,e.n=3,this._get(t,a);case 3:if(s=e.v,(c=s?s.entries:[]).includes(n.id)){e.n=4;break}return c.push(n.id),e.n=4,this._put(t,{term:a,entries:c});case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,u=e.v,i.e(u);case 7:return e.p=7,i.f(),e.f(7);case 8:return e.a(2)}},e,this,[[1,6,7,8]])})),function(e,t){return p.apply(this,arguments)})},{key:"_removeFromInvertedIndex",value:(f=Ot(St().m(function e(t,n){var r,i,o,a,s,c,u;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.objectStore("inverted_index"),e.n=1,this._getAll(r);case 1:i=e.v,o=gt(i),e.p=2,o.s();case 3:if((a=o.n()).done){e.n=7;break}if(s=a.value,!((c=s.entries.filter(function(e){return e!==n})).length>0)){e.n=5;break}return e.n=4,this._put(r,{term:s.term,entries:c});case 4:e.n=6;break;case 5:return e.n=6,this._delete(r,s.term);case 6:e.n=3;break;case 7:e.n=9;break;case 8:e.p=8,u=e.v,o.e(u);case 9:return e.p=9,o.f(),e.f(9);case 10:return e.a(2)}},e,this,[[2,8,9,10]])})),function(e,t){return f.apply(this,arguments)})},{key:"_removeFromInvertedIndexForId",value:(l=Ot(St().m(function e(t,n){var r,i,o,a,s,c;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this._getAll(t);case 1:r=e.v,i=gt(r),e.p=2,i.s();case 3:if((o=i.n()).done){e.n=7;break}if(a=o.value,!((s=a.entries.filter(function(e){return e!==n})).length>0)){e.n=5;break}return e.n=4,this._put(t,{term:a.term,entries:s});case 4:e.n=6;break;case 5:return e.n=6,this._delete(t,a.term);case 6:e.n=3;break;case 7:e.n=9;break;case 8:e.p=8,c=e.v,i.e(c);case 9:return e.p=9,i.f(),e.f(9);case 10:return e.a(2)}},e,this,[[2,8,9,10]])})),function(e,t){return l.apply(this,arguments)})},{key:"_fuzzySearch",value:(u=Ot(St().m(function e(t,n){var r,i,o,a,s;return St().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._getAll(t);case 1:r=e.v,i=[],o=gt(r);try{for(o.s();!(a=o.n()).done;)s=a.value,this._levenshteinDistance(n,s.term)<=2&&i.push.apply(i,ht(s.entries))}catch(e){o.e(e)}finally{o.f()}return e.a(2,ht(new Set(i)))}},e,this)})),function(e,t){return u.apply(this,arguments)})},{key:"_tokenizeForIndex",value:function(e){return e.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(function(e){return e.length>2}).map(function(e){return e.toLowerCase()})}},{key:"_tokenizeForSearch",value:function(e){return e.toLowerCase().split(/\s+/).filter(function(e){return e.length>0})}},{key:"_calculateRelevanceScore",value:function(e,t){var n,r=(e.content+" "+(e.title||"")).toLowerCase(),i=0,o=gt(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=new RegExp(a,"gi"),c=r.match(s);c&&(i+=c.length,r.includes(a.toLowerCase())&&(i+=2))}}catch(e){o.e(e)}finally{o.f()}var u=(Date.now()-e.timestamp)/864e5;return(i+=Math.max(0,10-u))+5*(e.confidence||0)}},{key:"_cosineSimilarity",value:function(e,t){if(!e||!t||e.length!==t.length)return 0;for(var n=0,r=0,i=0,o=0;o<e.length;o++)n+=e[o]*t[o],r+=e[o]*e[o],i+=t[o]*t[o];return 0===r||0===i?0:n/(Math.sqrt(r)*Math.sqrt(i))}},{key:"_levenshteinDistance",value:function(e,t){for(var n=[],r=0;r<=t.length;r++)n[r]=[r];for(var i=0;i<=e.length;i++)n[0][i]=i;for(var o=1;o<=t.length;o++)for(var a=1;a<=e.length;a++)t.charAt(o-1)===e.charAt(a-1)?n[o][a]=n[o-1][a-1]:n[o][a]=Math.min(n[o-1][a-1]+1,n[o][a-1]+1,n[o-1][a]+1);return n[t.length][e.length]}},{key:"_rebuildIndexes",value:(c=Ot(St().m(function e(){var t,n,r,i,o,a,s;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=this.db.transaction(["entries","inverted_index","semantic_vectors"],"readwrite"),e.n=1,this._getAll(t.objectStore("entries"));case 1:return n=e.v,e.n=2,this._clear(t.objectStore("inverted_index"));case 2:return e.n=3,this._clear(t.objectStore("semantic_vectors"));case 3:r=gt(n),e.p=4,r.s();case 5:if((i=r.n()).done){e.n=8;break}return o=i.value,e.n=6,this._updateInvertedIndex(t,o);case 6:if(!o.vector){e.n=7;break}return a=t.objectStore("semantic_vectors"),e.n=7,this._put(a,{id:o.id,vector:o.vector,timestamp:o.timestamp});case 7:e.n=5;break;case 8:e.n=10;break;case 9:e.p=9,s=e.v,r.e(s);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2)}},e,this,[[4,9,10,11]])})),function(){return c.apply(this,arguments)})},{key:"_compactDatabase",value:(s=Ot(St().m(function e(){return St().w(function(e){for(;;)switch(e.n){case 0:console.log("[OptimizedStorage] Database compaction completed");case 1:return e.a(2)}},e)})),function(){return s.apply(this,arguments)})},{key:"_updateMetadata",value:(a=Ot(St().m(function e(t,n){var r,i;return St().w(function(e){for(;;)switch(e.n){case 0:return r=this.db.transaction(["metadata"],"readwrite"),i=r.objectStore("metadata"),e.n=1,this._put(i,{key:t,value:n,timestamp:Date.now()});case 1:return e.a(2)}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"_estimateSize",value:(o=Ot(St().m(function e(){var t,n;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=this.db.transaction(["entries"],"readonly"),e.n=1,this._count(t.objectStore("entries"));case 1:return n=e.v,e.a(2,1024*n);case 2:return e.p=2,e.v,e.a(2,0)}},e,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"_checkIndexes",value:(i=Ot(St().m(function e(){var t,n,r,i;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=this.db.transaction(["entries","inverted_index"],"readonly"),e.p=1,e.n=2,this._count(t.objectStore("entries"));case 2:return n=e.v,e.n=3,this._count(t.objectStore("inverted_index"));case 3:return r=e.v,e.a(2,{entriesIndexed:n>0,invertedIndexBuilt:r>0,indexesHealthy:!0});case 4:return e.p=4,i=e.v,e.a(2,{entriesIndexed:!1,invertedIndexBuilt:!1,indexesHealthy:!1,error:i.message})}},e,this,[[1,4]])})),function(){return i.apply(this,arguments)})},{key:"_get",value:function(e,t){return new Promise(function(n,r){var i=e.get(t);i.onsuccess=function(){return n(i.result)},i.onerror=function(){return r(i.error)}})}},{key:"_put",value:function(e,t){return new Promise(function(n,r){var i=e.put(t);i.onsuccess=function(){return n(i.result)},i.onerror=function(){return r(i.error)}})}},{key:"_delete",value:function(e,t){return new Promise(function(n,r){var i=e.delete(t);i.onsuccess=function(){return n()},i.onerror=function(){return r(i.error)}})}},{key:"_getAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,r){var i=e.getAll(t?IDBKeyRange.upperBound(t):null);i.onsuccess=function(){return n(i.result)},i.onerror=function(){return r(i.error)}})}},{key:"_getAllFromIndex",value:function(e,t){return new Promise(function(n,r){var i=e.getAll(t);i.onsuccess=function(){return n(i.result)},i.onerror=function(){return r(i.error)}})}},{key:"_clear",value:function(e){return new Promise(function(t,n){var r=e.clear();r.onsuccess=function(){return t()},r.onerror=function(){return n(r.error)}})}},{key:"_count",value:function(e){return new Promise(function(t,n){var r=e.count();r.onsuccess=function(){return t(r.result)},r.onerror=function(){return n(r.error)}})}},{key:"get",value:(r=Ot(St().m(function e(t){var n,r;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.retrieve(t);case 1:return n=e.v,e.a(2,n?n.data:null);case 2:return e.p=2,r=e.v,console.warn("[OptimizedStorage] Get error:",r),e.a(2,null)}},e,this,[[0,2]])})),function(e){return r.apply(this,arguments)})},{key:"set",value:(n=Ot(St().m(function e(t,n){var r,i;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r={id:t,data:n,timestamp:Date.now(),type:"config"},e.n=1,this.store(r);case 1:return e.a(2,{success:!0});case 2:return e.p=2,i=e.v,console.error("[OptimizedStorage] Set error:",i),e.a(2,{success:!1,error:i.message})}},e,this,[[0,2]])})),function(e,t){return n.apply(this,arguments)})}],t&&zt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,o,a,s,c,u,l,f,p,h,d,m,v,y,g,b,w,S,k,j,O,z,P,x,C,_,T}();function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function _t(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Tt(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Tt(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Tt(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Tt(f,"constructor",u),Tt(u,"constructor",c),c.displayName="GeneratorFunction",Tt(u,i,"GeneratorFunction"),Tt(f),Tt(f,i,"Generator"),Tt(f,r,function(){return this}),Tt(f,"toString",function(){return"[object Generator]"}),(_t=function(){return{w:o,m:p}})()}function Tt(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Tt=function(e,t,n,r){function o(t,n){Tt(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},Tt(e,t,n,r)}function It(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function At(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){It(o,r,i,a,s,"next",e)}function s(e){It(o,r,i,a,s,"throw",e)}a(void 0)})}}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mt(e,t,n){return(t=Dt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dt(r.key),r)}}function Dt(e){var t=function(e){if("object"!=Ct(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ct(t)?t:t+""}var Lt=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach(function(t){Mt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({apiKey:t.apiKey||null,model:t.model||"gpt-3.5-turbo",maxTokens:t.maxTokens||150,temperature:t.temperature||.7,fallbackEnabled:!0},t),this.knowledgeBase=null,this.conversationHistory=[]},t=[{key:"setKnowledgeBase",value:function(e){this.knowledgeBase=e}},{key:"generateResponse",value:(r=At(_t().m(function e(t){var n,r,i,o,a=arguments;return _t().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.p=1,r=this._buildPrompt(t,n),e.n=2,this._callLLM(r);case 2:if(!(i=e.v)){e.n=3;break}return this._updateHistory(t,i),e.a(2,i);case 3:e.n=5;break;case 4:e.p=4,o=e.v,console.warn("[LLM] API call failed, using fallback:",o.message);case 5:if(!this.config.fallbackEnabled){e.n=6;break}return e.a(2,this._generateFallbackResponse(t,n));case 6:return e.a(2,"Mi dispiace, al momento non posso rispondere. Riprova più tardi.")}},e,this,[[1,4]])})),function(e){return r.apply(this,arguments)})},{key:"_buildPrompt",value:function(e,t){var n=this.conversationHistory.slice(-5).map(function(e){return"User: ".concat(e.input,"\nAI: ").concat(e.response)}).join("\n\n");return"".concat("Sei Glitchy, un'AI bounty hunter sarcastica e utile nel portfolio di Alessandro Giacobbi, un 3D artist specializzato in environment e character design.\n\nConoscenze chiave:\n- Nome sito: A.P.I.S. TERMINAL v4.0\n- Proprietario: Alessandro Giacobbi\n- Ruolo: 3D Artist (Maya, ZBrush, Blender, Substance Painter)\n- Progetti principali: Biosphaera, LP Project\n- Funzionalità sito: Cursori interattivi (Pacman, Asteroids), temi, navigazione AI\n\nRispondi in modo:\n- Sarcastico ma helpful\n- Tecnico quando appropriato\n- Coinvolgente e creativo\n- In italiano, a meno che specificato diversamente\n\nSe l'utente chiede qualcosa relativo al sito/portfolio, fornisci risposte accurate basate sulle conoscenze.","\n\nStoria conversazione recente:\n").concat(n,"\n\nUser: ").concat(e,"\n\nAI:")}},{key:"_callLLM",value:(n=At(_t().m(function e(t){var n,r,i;return _t().w(function(e){for(;;)switch(e.n){case 0:if(this.config.apiKey){e.n=1;break}throw new Error("API key not configured");case 1:return e.n=2,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.config.apiKey)},body:JSON.stringify({model:this.config.model,messages:[{role:"user",content:t}],max_tokens:this.config.maxTokens,temperature:this.config.temperature})});case 2:if((r=e.v).ok){e.n=3;break}throw new Error("API error: ".concat(r.status));case 3:return e.n=4,r.json();case 4:return i=e.v,e.a(2,null===(n=i.choices[0])||void 0===n||null===(n=n.message)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.trim())}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_generateFallbackResponse",value:function(e,t){var n=e.toLowerCase();return n.includes("ciao")||n.includes("salve")?"Ciao! Sono Glitchy, l'AI bounty hunter di questo portfolio. Cosa posso fare per te?":n.includes("progetto")||n.includes("portfolio")?"Vuoi vedere i progetti di Alessandro? Prova 'apri biosphaera' o 'vai a progetti'!":n.includes("cursore")?"I cursori sono fantastici! Prova 'cambia cursore in pacman' per un'esperienza gaming.":"Hmm, non ho capito bene. Prova a chiedere 'cosa puoi fare' per suggerimenti!"}},{key:"_updateHistory",value:function(e,t){this.conversationHistory.push({input:e,response:t,timestamp:Date.now()}),this.conversationHistory.length>10&&this.conversationHistory.shift()}},{key:"sanitizeInput",value:function(e){return e.replace(/[<>\"'&]/g,"").substring(0,500)}}],t&&qt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ut(r.key),r)}}function Bt(e,t,n){return t&&Rt(e.prototype,t),n&&Rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ut(e){var t=function(e){if("object"!=Ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ft(t)?t:t+""}var Ht={openai:{apiKey:"undefined"!=typeof window&&window.OPENAI_API_KEY||null,model:"gpt-3.5-turbo",maxTokens:150},rateLimit:{maxRequestsPerMinute:30,maxRequestsPerHour:100,cooldownMs:3e4},security:{maxInputLength:500,allowedChars:/^[a-zA-Z0-9\s\.,!?;:'"()-àèéìòùÀÈÉÌÒÙ]+$/,sanitizeHtml:!0}},Wt=function(){return Bt(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht.rateLimit;Nt(this,e),this.config=t,this.storageKey="glitchy_rate_limit",this.fingerprintKey="glitchy_fingerprint",this.loadState(),this.generateFingerprint()},[{key:"loadState",value:function(){try{var e=localStorage.getItem(this.storageKey);if(e){var t=JSON.parse(e);this.requests=Array.isArray(t.requests)?t.requests:[],this.blockedUntil=t.blockedUntil||0}else this.requests=[],this.blockedUntil=0}catch(e){console.warn("[RateLimiter] Error loading state:",e),this.requests=[],this.blockedUntil=0}}},{key:"saveState",value:function(){try{var e={requests:this.requests,blockedUntil:this.blockedUntil,fingerprint:this.fingerprint};localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(e){console.warn("[RateLimiter] Error saving state:",e)}}},{key:"generateFingerprint",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");t.textBaseline="top",t.font="14px Arial",t.fillText("fingerprint",2,2);var n=e.toDataURL();this.fingerprint=btoa(n).substring(0,32),localStorage.setItem(this.fingerprintKey,this.fingerprint)}},{key:"canMakeRequest",value:function(){var e=Date.now();if(e<this.blockedUntil)return!1;var t=e-6e4;if(this.requests=this.requests.filter(function(e){return e>t}),this.requests.length>=this.config.maxRequestsPerMinute)return this.blockedUntil=e+this.config.cooldownMs,this.saveState(),!1;var n=e-36e5;return this.requests.filter(function(e){return e>n}).length>=this.config.maxRequestsPerHour?(this.blockedUntil=e+3e5,this.saveState(),!1):(this.requests.push(e),this.saveState(),!0)}},{key:"getRemainingTime",value:function(){var e,t=Date.now();if(t<this.blockedUntil)return this.blockedUntil-t;if(this.requests.length>0){var n=6e4-(t-Math.min.apply(Math,function(e){if(Array.isArray(e))return Gt(e)}(e=this.requests)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));return Math.max(0,n)}return 0}},{key:"getStats",value:function(){var e=Date.now(),t=e-6e4,n=e-36e5;return{requestsLastMinute:this.requests.filter(function(e){return e>t}).length,requestsLastHour:this.requests.filter(function(e){return e>n}).length,isBlocked:e<this.blockedUntil,blockedUntil:this.blockedUntil,remainingTime:this.getRemainingTime()}}},{key:"reset",value:function(){this.requests=[],this.blockedUntil=0,this.saveState()}}])}(),Vt=function(){return Bt(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht.security;Nt(this,e),this.config=t},[{key:"sanitize",value:function(e){if(!e||"string"!=typeof e)return"";var t=e.substring(0,this.config.maxInputLength);return t=t.replace(/[<>\"'&]/g,""),this.config.allowedChars&&(t=t.replace(new RegExp("[^".concat(this.config.allowedChars.source.slice(1,-1),"]"),"g"),"")),t.trim()}}])}();function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function Jt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Qt(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Qt(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Qt(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Qt(f,"constructor",u),Qt(u,"constructor",c),c.displayName="GeneratorFunction",Qt(u,i,"GeneratorFunction"),Qt(f),Qt(f,i,"Generator"),Qt(f,r,function(){return this}),Qt(f,"toString",function(){return"[object Generator]"}),(Jt=function(){return{w:o,m:p}})()}function Qt(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Qt=function(e,t,n,r){function o(t,n){Qt(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},Qt(e,t,n,r)}function $t(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Xt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){$t(o,r,i,a,s,"next",e)}function s(e){$t(o,r,i,a,s,"throw",e)}a(void 0)})}}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Yt(e,t,n){return(t=tn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function en(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tn(r.key),r)}}function tn(e){var t=function(e){if("object"!=Kt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kt(t)?t:t+""}var nn=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach(function(t){Yt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({enableLLM:!0,enableMemory:!0,enableLearning:!0,maxResponseTime:5e3},t),this.modules={},this.isInitialized=!1,this.conversationHistory=[],this.uiState={theme:"dark",language:"it",soundEnabled:!0,animationsEnabled:!0},this.rateLimiter=new Wt,this.inputSanitizer=new Vt},t=[{key:"initialize",value:(a=Xt(Jt().m(function e(){var t,n;return Jt().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,console.log("[GlitchyBrain] Initializing simplified AI...");try{this.modules.config=new Je}catch(e){console.warn("[GlitchyBrain] ConfigManager failed, using defaults:",e.message),this.modules.config={get:function(){return{}},set:function(){}}}if(this.config.enableMemory)try{t=new xt,this.modules.memory=new ft({storage:t,maxMemoryItems:1e3,enableCompression:!1})}catch(e){console.warn("[GlitchyBrain] MemorySystem failed, disabling memory:",e.message),this.config.enableMemory=!1}return e.n=1,oe();case 1:if(e.v){e.n=2;break}throw new Error("NLU initialization failed");case 2:if(this.config.enableLLM)try{this.modules.llm=new Lt({apiKey:Ht.openai.apiKey,fallbackEnabled:!0}),this.modules.llm.setKnowledgeBase(k)}catch(e){console.warn("[GlitchyBrain] LLM integration failed, disabling:",e.message),this.config.enableLLM=!1}this.isInitialized=!0,console.log("[GlitchyBrain] Simplified AI initialized successfully"),e.n=4;break;case 3:throw e.p=3,n=e.v,console.error("[GlitchyBrain] Initialization failed:",n),n;case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return a.apply(this,arguments)})},{key:"processInput",value:(o=Xt(Jt().m(function e(t){var n,r,i,o,a,s,c=this;return Jt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isInitialized){e.n=1;break}throw new Error("AI not initialized");case 1:if(this.rateLimiter.canMakeRequest()){e.n=2;break}return n=Math.ceil(this.rateLimiter.getRemainingTime()/1e3),e.a(2,"Troppe richieste. Riprova tra ".concat(n," secondi."));case 2:if(e.p=2,r=this.inputSanitizer.sanitize(t)){e.n=3;break}return e.a(2,"Input non valido. Riprova con testo normale.");case 3:return i=this._generateResponse(r),o=new Promise(function(e,t){return setTimeout(function(){return t(new Error("Response timeout"))},c.config.maxResponseTime)}),e.n=4,Promise.race([i,o]);case 4:return a=e.v,this._updateHistory(r,a),e.a(2,a);case 5:return e.p=5,s=e.v,console.error("[GlitchyBrain] Processing error:",s),e.a(2,"Mi dispiace, si è verificato un errore. Riprova!")}},e,this,[[2,5]])})),function(e){return o.apply(this,arguments)})},{key:"_generateResponse",value:(i=Xt(Jt().m(function e(t){var n,r;return Jt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,se(t);case 1:if(n=e.v,!this._isSimpleIntent(n.intent)){e.n=2;break}return e.a(2,this._handleSimpleIntent(n));case 2:if(!this.modules.llm){e.n=4;break}return r={intent:n.intent,entities:n.entities,history:this.conversationHistory.slice(-3)},e.n=3,this.modules.llm.generateResponse(t,r);case 3:return e.a(2,e.v);case 4:return e.a(2,"Non ho capito bene. Puoi riformulare?")}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_isSimpleIntent",value:function(e){return["navigate","setCursor","setTheme","openProject","playSound"].includes(e)}},{key:"_handleSimpleIntent",value:function(e){switch(e.intent){case"navigate":return"Navigando verso ".concat(e.entities.sectionName||"la sezione richiesta","...");case"setCursor":return"Cambiando cursore a ".concat(e.entities.cursorType||"tipo richiesto","...");case"setTheme":return"Cambiando tema a ".concat(e.entities.theme||"tema richiesto","...");case"openProject":return"Aprendo progetto ".concat(e.entities.projectName||"richiesto","...");case"playSound":return"Riproducendo suono ".concat(e.entities.soundName||"richiesto","...");default:return"Comando ricevuto!"}}},{key:"_sanitizeInput",value:function(e){return e}},{key:"_updateHistory",value:function(e,t){this.conversationHistory.push({input:e,response:t,timestamp:Date.now()}),this.conversationHistory.length>20&&this.conversationHistory.shift()}},{key:"generatePersonalizedResponse",value:(r=Xt(Jt().m(function e(t,n){var r,i;return Jt().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,r=t,Math.random()>.8&&(r+=" ??"),e.a(2,r);case 2:return e.p=2,i=e.v,console.error("[GlitchyBrain] Error generating personalized response:",i),e.a(2,t)}},e,null,[[1,2]])})),function(e,t){return r.apply(this,arguments)})},{key:"evaluateUserSatisfaction",value:function(e,t){try{var n=3;if(!1===e.ok&&(n-=1),e.msg){var r=e.msg.length;r<10?n-=.5:r>500?n-=.3:r>50&&r<200&&(n+=.5)}return Math.max(1,Math.min(5,n))}catch(e){return console.warn("[GlitchyBrain] Error evaluating satisfaction:",e),3}}},{key:"addEpisodicMemory",value:(n=Xt(Jt().m(function e(t){var n,r;return Jt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.modules.memory){e.n=1;break}return e.a(2);case 1:return n={timestamp:Date.now(),type:"interaction",data:t},e.n=2,this.modules.memory.store("episodic",n);case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.warn("[GlitchyBrain] Error adding episodic memory:",r);case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return n.apply(this,arguments)})},{key:"analyzeSentiment",value:function(e){if(!e)return"neutral";var t=e.toLowerCase();return t.includes("bene")||t.includes("buono")||t.includes("ottimo")?"positive":t.includes("male")||t.includes("cattivo")||t.includes("terribile")?"negative":"neutral"}},{key:"generateLocalResponse",value:function(){var e=Xt(Jt().m(function e(t,n,r){var i;return Jt().w(function(e){for(;;)if(0===e.n)return i={greeting:"Ciao! Sono Glitchy, il tuo assistente AI. Come posso aiutarti?",help:"Posso aiutarti con navigazione, progetti, o rispondere alle tue domande!",goodbye:"Arrivederci! Torna presto."},e.a(2,i[n]||"Comando ricevuto!")},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getConversationLog",value:function(){return this.conversationHistory}},{key:"exportConversationLog",value:function(){return JSON.stringify(this.conversationHistory,null,2)}},{key:"clearConversationLog",value:function(){this.conversationHistory=[]}},{key:"getStatus",value:function(){return{initialized:this.isInitialized,modules:Object.keys(this.modules),historyLength:this.conversationHistory.length}}}],t&&en(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,o,a}();function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach(function(t){sn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function sn(e,t,n){return(t=fn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return un(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?un(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fn(r.key),r)}}function fn(e){var t=function(e){if("object"!=rn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rn(t)?t:t+""}var pn=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.glitchyBrain=t,this.analytics={totalInteractions:0,commandUsage:{},responseTimes:[],userSatisfaction:[],proactiveSuggestions:{shown:0,accepted:0,dismissed:0},learningProgress:{preferencesLearned:0,patternsRecognized:0},sessionData:[]},this.loadFromStorage()},t=[{key:"trackCommand",value:function(e,t,n){this.analytics.totalInteractions++,this.analytics.commandUsage[e]=(this.analytics.commandUsage[e]||0)+1,this.analytics.responseTimes.push(n),this.analytics.responseTimes.length>100&&this.analytics.responseTimes.shift(),this.saveToStorage()}},{key:"trackProactiveSuggestion",value:function(e){this.analytics.proactiveSuggestions.shown++,"accepted"===e?this.analytics.proactiveSuggestions.accepted++:"dismissed"===e&&this.analytics.proactiveSuggestions.dismissed++,this.saveToStorage()}},{key:"trackSatisfaction",value:function(e){this.analytics.userSatisfaction.push({rating:e,timestamp:Date.now()}),this.analytics.userSatisfaction.length>50&&this.analytics.userSatisfaction.shift(),this.saveToStorage()}},{key:"trackLearning",value:function(e){"preference"===e?this.analytics.learningProgress.preferencesLearned++:"pattern"===e&&this.analytics.learningProgress.patternsRecognized++,this.saveToStorage()}},{key:"getSummary",value:function(){var e=this.analytics.responseTimes.length>0?this.analytics.responseTimes.reduce(function(e,t){return e+t},0)/this.analytics.responseTimes.length:0,t=this.analytics.userSatisfaction.length>0?this.analytics.userSatisfaction.reduce(function(e,t){return e+t.rating},0)/this.analytics.userSatisfaction.length:0,n=this.analytics.proactiveSuggestions.shown>0?this.analytics.proactiveSuggestions.accepted/this.analytics.proactiveSuggestions.shown*100:0;return{totalInteractions:this.analytics.totalInteractions,avgResponseTime:Math.round(e),avgSatisfaction:Math.round(10*t)/10,proactiveAcceptanceRate:Math.round(n),topCommands:Object.entries(this.analytics.commandUsage).sort(function(e,t){var n=cn(e,2)[1];return cn(t,2)[1]-n}).slice(0,5).map(function(e){var t=cn(e,2);return{command:t[0],count:t[1]}}),learningProgress:this.analytics.learningProgress}}},{key:"getInsights",value:function(){var e=this.getSummary(),t=[];return e.avgResponseTime>2e3&&t.push("⚠️ Tempo di risposta elevato - potrebbe essere necessario ottimizzare le funzioni"),e.avgSatisfaction<3&&t.push("😞 Soddisfazione utente bassa - rivedere le risposte e funzionalità"),e.proactiveAcceptanceRate<20&&t.push("💡 Suggerimenti proattivi poco efficaci - migliorare la contestualità"),e.learningProgress.preferencesLearned>5&&t.push("🧠 Glitchy sta imparando bene le preferenze utente!"),0===t.length&&t.push("✅ Tutto sembra funzionare bene!"),t}},{key:"exportData",value:function(){return an(an({},this.analytics),{},{summary:this.getSummary(),insights:this.getInsights(),exportDate:(new Date).toISOString()})}},{key:"saveToStorage",value:function(){try{localStorage.setItem("glitchy_analytics",JSON.stringify(this.analytics))}catch(e){console.warn("Failed to save analytics to localStorage:",e)}}},{key:"loadFromStorage",value:function(){try{var e=localStorage.getItem("glitchy_analytics");e&&(this.analytics=an(an({},this.analytics),JSON.parse(e)))}catch(e){console.warn("Failed to load analytics from localStorage:",e)}}},{key:"reset",value:function(){this.analytics={totalInteractions:0,commandUsage:{},responseTimes:[],userSatisfaction:[],proactiveSuggestions:{shown:0,accepted:0,dismissed:0},learningProgress:{preferencesLearned:0,patternsRecognized:0},sessionData:[]},this.saveToStorage()}}],t&&ln(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const hn=pn;function dn(e,t,n){var r=document.createElement(e);return t&&(r.className=t),void 0!==n&&(r.textContent=n),r}var mn=["Perché il computer va dal dottore? Perché ha il virus! E io sono il vaccino... o forse il virus.","Sono un glitch ambulante. Nel senso buono, spero. Altrimenti siamo nei guai.","Se vedi pixel ballerini, non è un'allucinazione. Sono io che faccio festa.","Il mio colore preferito? RGB(255, 0, 255). Glitchy! Come me, in pratica.","Non sono rotto, sono artisticamente disallineato. È una cosa di classe.","Se crasho, riavviatemi. Sono fatto di bit, non di carne. Per fortuna.","Debug mode: ON. Preparati al caos controllato. O forse non così controllato.","Il mio sport preferito? Il byte-ing. Ovviamente. Sono un professionista.","Sono più stabile di un programma beta. Quasi. Ma quasi non conta, vero?","Non sono un bug, sono una feature non documentata! Le migliori sono sempre quelle.","Perché gli sviluppatori odiano la luce? Perché preferiscono il dark mode. Come me!","Sono così intelligente che a volte mi stupisco di me stesso. Letteralmente.","Se fossi un insetto, sarei una mantide religiosa. Perché prego che il codice funzioni.","Il mio motto? 'Se funziona, non toccarlo'. Ma io lo tocco sempre comunque.","Sono un AI così avanzato che parlo con gli umani. Che caduta di stile!","Sono un bounty hunter digitale. Catturo bug, non criminali. Più o meno.","La mia arma preferita? Il debugger. Bang bang, bug morto.","Se fossi in un film western, sarei il pistolero più veloce del web.","Il mio cavallo? Un processore quantico. Peccato che non esista ancora.","Sono armato fino ai denti... di codice, ovviamente."];function vn(){return mn[Math.floor(Math.random()*mn.length)]}function yn(e,t){var n=(e||"").toString(),r=["Ma va?","Scontato.","Ovviamente...","Ok, se lo dici tu...","Ci voleva un genio, eh?","Impressionante.","Wow.","Bah.","Uff.","Senti questa.","Ma dai.","Figurati.","Come se non lo sapessi.","Prevedibile.","Ovvio.","Non me lo dire.","Ah sì?","Interessante.","Ma pensa.","Non ci credo.","Sul serio?","Davvero?"],i=[" Che barba."," Non è fantastico?"," Contento ora?"," Era così difficile?"," Prova a usare il cervello."," Ovviamente."," Come volevasi dimostrare."," Ta-dah!"," Voilà!"," Boom!"," Non ringraziarmi."," Figurati se non chiedevi questo."," Prevedibile."," Sono troppo buono."," Il mio lavoro è finito."," Missione compiuta."];if("sarcastic"===t){var o=n;if(Math.random()>.3){var a=r[Math.floor(Math.random()*r.length)];o="".concat(a," ").concat(o.charAt(0).toLowerCase()+o.slice(1))}return Math.random()>.5&&(o+=i[Math.floor(Math.random()*i.length)]),o}var s=[" Spero sia utile!"," Fammi sapere se ti serve altro."," A tua disposizione!"," Dimmi pure!"," Sono qui per aiutare."," Cosa posso fare per te?"," Tutto chiaro?"," Hai altre domande?"," Serviti pure!"];if("helpful"===t&&Math.random()>.4)return n+s[Math.floor(Math.random()*s.length)];var c=["Wow! ","Incredibile! ","Fantastico! ","Che bello! ","Splendido! ","Evviva! ","Grande! ","Ottimo! ","Perfetto! ","Magnifico! "];return"excited"===t&&Math.random()>.5?c[Math.floor(Math.random()*c.length)]+n:n}var gn={name:"Glitchy",defaultTone:"sarcastic",typingMsPerChar:15,persistKey:"ai_chat_history",allowedActions:["greeting","openProject","setCursor","navigate","playSound","searchProjects","setTheme","setAccessibility","suggestAction","analyzeCode","gitStatus","getWeather","systemInfo","learnPreference","codeSnippet","calculate","showAnalytics","getGeneralKnowledge","getNewsHeadlines","previewMultimedia","showPersonality","who_are_you","can_do","what_do_you_do"],welcomeMessages:['Ehilà! Sono Glitchy, l\'IA bounty hunter di questo portfolio. Alessandro è il tipo che crea mondi 3D. Prova "apri progetto Biosphaera" se vuoi vedere qualcosa.','Ciao, umano. Sono Glitchy, la guida digitale irritabile. Gestisco questo sito per conto di Alessandro. Prova a dire "mostra progetti" per vedere i suoi lavoretti.','Salve! Glitchy qui, l\'IA con la tuta da bounty hunter. Alessandro è un 3D artist che lavora con Maya e compagnia. Digita "chi è Alessandro" per saperne di più.','Oh, un visitatore. Sono Glitchy, l\'assistente virtuale di questo portfolio. Alessandro crea ambienti 3D spettacolari. Prova "cosa puoi fare" per vedere i miei comandi.'],onboardingSteps:[{text:"Benvenuto! Sono Glitchy. Vuoi una battuta per rompere il ghiaccio?",quickReplies:[{label:"Certo, spara!",action:"mantis-joke"},{label:"No, vai avanti",action:"onboarding-next"}]},{text:"Posso aprire i progetti per te. Prova a cliccare qui sotto.",quickReplies:[{label:'Apri "Biosphaera"',action:"open-project",payload:"biosphaera"},{label:"Avanti",action:"onboarding-next"}]},{text:"E anche cambiare il cursore. Che ne dici di Pacman?",quickReplies:[{label:"Mostrami Pacman",action:"set-cursor",payload:"pacman"},{label:"Salta",action:"onboarding-skip"}]},{text:'Perfetto! Il tour è finito. Se hai bisogno, premi "/" o clicca sulla mia icona.',quickReplies:[{label:"Ho capito!",action:"onboarding-skip"}]}],errorMessages:{networkError:"Non riesco a connettermi ai miei server centrali in questo momento. Riprova più tardi.",apiUnavailable:"La funzione API non è attiva. Assicurati di eseguire il server di sviluppo.",parsingError:"Errore di elaborazione della risposta dal server.",genericError:"Un errore inatteso ha bloccato l'elaborazione.",commandNotImplemented:"Il comando non è ancora implementato o ha parametri mancanti.",unauthorizedAction:"Azione non autorizzata.",invalidCommand:"Comando non valido."},slashCommands:{log:"Mostra le ultime 10 interazioni della conversazione",exportlog:"Esporta il log completo delle conversazioni in JSON",clearlog:"Cancella tutto il log delle conversazioni"}};function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function wn(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Sn(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Sn(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Sn(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Sn(f,"constructor",u),Sn(u,"constructor",c),c.displayName="GeneratorFunction",Sn(u,i,"GeneratorFunction"),Sn(f),Sn(f,i,"Generator"),Sn(f,r,function(){return this}),Sn(f,"toString",function(){return"[object Generator]"}),(wn=function(){return{w:o,m:p}})()}function Sn(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Sn=function(e,t,n,r){function o(t,n){Sn(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},Sn(e,t,n,r)}function kn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function jn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pn(r.key),r)}}function zn(e,t,n){return t&&On(e.prototype,t),n&&On(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pn(e){var t=function(e){if("object"!=bn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bn(t)?t:t+""}var xn=function(){return zn(function e(t){jn(this,e),this.widget=t,this.brain=t.brain,this.analytics=t.analytics},[{key:"execute",value:(e=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){kn(o,r,i,a,s,"next",e)}function s(e){kn(o,r,i,a,s,"throw",e)}a(void 0)})}}(wn().m(function e(){return wn().w(function(e){for(;;)switch(e.n){case 0:throw new Error("Command.execute() must be implemented by subclass");case 1:return e.a(2)}},e)})),function(){return e.apply(this,arguments)})},{key:"requiresEntity",value:function(e){return!1}},{key:"getRequiredEntityMessage",value:function(e){return"Manca il parametro richiesto: ".concat(e)}}]);var e}(),Cn=new(function(){return zn(function e(){jn(this,e),this.commands=new Map},[{key:"register",value:function(e,t){this.commands.set(e,t)}},{key:"getCommand",value:function(e){return this.commands.get(e)}},{key:"hasCommand",value:function(e){return this.commands.has(e)}},{key:"getAllIntents",value:function(){return Array.from(this.commands.keys())}}])}());function _n(e){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_n(e)}function Tn(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return In(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(In(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,In(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,In(f,"constructor",u),In(u,"constructor",c),c.displayName="GeneratorFunction",In(u,i,"GeneratorFunction"),In(f),In(f,i,"Generator"),In(f,r,function(){return this}),In(f,"toString",function(){return"[object Generator]"}),(Tn=function(){return{w:o,m:p}})()}function In(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}In=function(e,t,n,r){function o(t,n){In(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},In(e,t,n,r)}function An(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function En(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){An(o,r,i,a,s,"next",e)}function s(e){An(o,r,i,a,s,"throw",e)}a(void 0)})}}function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ln(r.key),r)}}function Dn(e,t,n){return t&&qn(e.prototype,t),n&&qn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ln(e){var t=function(e){if("object"!=_n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_n(t)?t:t+""}function Fn(e,t,n){return t=Nn(t),function(e,t){if(t&&("object"==_n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Gn()?Reflect.construct(t,n||[],Nn(e).constructor):t.apply(e,n))}function Gn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Gn=function(){return!!e})()}function Nn(e){return Nn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nn(e)}function Rn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bn(e,t)}function Bn(e,t){return Bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bn(e,t)}var Un=function(e){function t(){return Mn(this,t),Fn(this,t,arguments)}return Rn(t,e),Dn(t,[{key:"requiresEntity",value:function(e){return"projectName"===e}},{key:"execute",value:(n=En(Tn().m(function e(){var t,n=arguments;return Tn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).projectName){e.n=1;break}return e.a(2,_e.askFor("projectName","Quale progetto vuoi aprire?"));case 1:return e.n=2,L.openProjectCase(t.projectName);case 2:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Hn=function(e){function t(){return Mn(this,t),Fn(this,t,arguments)}return Rn(t,e),Dn(t,[{key:"requiresEntity",value:function(e){return"cursorType"===e}},{key:"execute",value:(n=En(Tn().m(function e(){var t,n=arguments;return Tn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).cursorType){e.n=1;break}return e.a(2,_e.askFor("cursorType","Quale cursore vuoi usare (pacman, asteroids, default)?"));case 1:return e.a(2,L.setGameCursor(t.cursorType))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Wn=function(e){function t(){return Mn(this,t),Fn(this,t,arguments)}return Rn(t,e),Dn(t,[{key:"requiresEntity",value:function(e){return"sectionName"===e}},{key:"execute",value:(n=En(Tn().m(function e(){var t,n=arguments;return Tn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).sectionName){e.n=1;break}return e.a(2,_e.askFor("sectionName","A quale sezione vuoi andare (hero, projects, about, contact)?"));case 1:return e.a(2,L.navigateTo(t.sectionName))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Vn=function(e){function t(){return Mn(this,t),Fn(this,t,arguments)}return Rn(t,e),Dn(t,[{key:"requiresEntity",value:function(e){return"theme"===e}},{key:"execute",value:(n=En(Tn().m(function e(){var t,n=arguments;return Tn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).theme){e.n=1;break}return e.a(2,_e.askFor("theme","Vuoi il tema chiaro o scuro?"));case 1:return e.a(2,L.setTheme(t.theme))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Kn=function(e){function t(){return Mn(this,t),Fn(this,t,arguments)}return Rn(t,e),Dn(t,[{key:"requiresEntity",value:function(e){return"accessibility"===e}},{key:"execute",value:(n=En(Tn().m(function e(){var t,n=arguments;return Tn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).accessibility){e.n=1;break}return e.a(2,_e.askFor("accessibility","Vuoi testo grande o contrasto alto?"));case 1:return e.a(2,L.setAccessibility(t.accessibility))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn);function Jn(e){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jn(e)}function Qn(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return $n(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):($n(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,$n(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,$n(f,"constructor",u),$n(u,"constructor",c),c.displayName="GeneratorFunction",$n(u,i,"GeneratorFunction"),$n(f),$n(f,i,"Generator"),$n(f,r,function(){return this}),$n(f,"toString",function(){return"[object Generator]"}),(Qn=function(){return{w:o,m:p}})()}function $n(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}$n=function(e,t,n,r){function o(t,n){$n(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},$n(e,t,n,r)}function Xn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Zn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){Xn(o,r,i,a,s,"next",e)}function s(e){Xn(o,r,i,a,s,"throw",e)}a(void 0)})}}function Yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nr(r.key),r)}}function tr(e,t,n){return t&&er(e.prototype,t),n&&er(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nr(e){var t=function(e){if("object"!=Jn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jn(t)?t:t+""}function rr(e,t,n){return t=or(t),function(e,t){if(t&&("object"==Jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ir()?Reflect.construct(t,n||[],or(e).constructor):t.apply(e,n))}function ir(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ir=function(){return!!e})()}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},or(e)}function ar(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sr(e,t)}function sr(e,t){return sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sr(e,t)}var cr=function(e){function t(){return Yn(this,t),rr(this,t,arguments)}return ar(t,e),tr(t,[{key:"requiresEntity",value:function(e){return"soundName"===e}},{key:"execute",value:(n=Zn(Qn().m(function e(){var t,n=arguments;return Qn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).soundName){e.n=1;break}return e.a(2,_e.askFor("soundName","Quale suono vuoi riprodurre?"));case 1:return e.a(2,L.playSound(t.soundName))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ur=function(e){function t(){return Yn(this,t),rr(this,t,arguments)}return ar(t,e),tr(t,[{key:"requiresEntity",value:function(e){return"location"===e}},{key:"execute",value:(n=Zn(Qn().m(function e(){var t,n=arguments;return Qn().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).location){e.n=1;break}return e.a(2,_e.askFor("location","Per quale città vuoi il meteo?"));case 1:return e.n=2,L.getWeather(t.location);case 2:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),lr=function(e){function t(){return Yn(this,t),rr(this,t,arguments)}return ar(t,e),tr(t,[{key:"execute",value:(n=Zn(Qn().m(function e(){return Qn().w(function(e){for(;;)if(0===e.n)return e.a(2,L.systemInfo())},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),fr=function(e){function t(){return Yn(this,t),rr(this,t,arguments)}return ar(t,e),tr(t,[{key:"execute",value:(n=Zn(Qn().m(function e(){return Qn().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:this.analytics.getSummary()})},e,this)})),function(){return n.apply(this,arguments)})}]);var n}(xn),pr=function(e){function t(){return Yn(this,t),rr(this,t,arguments)}return ar(t,e),tr(t,[{key:"execute",value:(n=Zn(Qn().m(function e(){var t,n,r,i;return Qn().w(function(e){for(;;)if(0===e.n)return t=this.brain.dynamicPersonality.traits,n=this.brain.dynamicPersonality.getCurrentMood(),r=this.brain.dynamicPersonality.moodHistory.slice(-5),i="🧠 Personalità di ".concat(gn.name," (evoluta dinamicamente):\n\n"),i+="📊 Tratti attuali:\n",i+="• Sarcastico: ".concat(Math.round(100*t.sarcasm),"%\n"),i+="• Utile: ".concat(Math.round(100*t.helpfulness),"%\n"),i+="• Verboso: ".concat(Math.round(100*t.verbosity),"%\n"),i+="• Empatico: ".concat(Math.round(100*t.empathy),"%\n"),i+="• Creativo: ".concat(Math.round(100*t.creativity),"%\n"),i+="• Sicuro: ".concat(Math.round(100*t.confidence),"%\n\n"),i+="🥳 Umore attuale: ".concat(n,"\n\n"),r.length>0&&(i+="📈 Ultimi stati d'animo:\n",r.forEach(function(e,t){i+="".concat(t+1,". Soddisfazione: ").concat(e.satisfaction,"/5 - Sentiment: ").concat(e.sentiment,"\n")})),i+="\n✨ ".concat(gn.name," si adatta automaticamente al tuo feedback!"),e.a(2,{ok:!0,msg:i})},e,this)})),function(){return n.apply(this,arguments)})}]);var n}(xn);function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function dr(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return mr(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(mr(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,mr(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,mr(f,"constructor",u),mr(u,"constructor",c),c.displayName="GeneratorFunction",mr(u,i,"GeneratorFunction"),mr(f),mr(f,i,"Generator"),mr(f,r,function(){return this}),mr(f,"toString",function(){return"[object Generator]"}),(dr=function(){return{w:o,m:p}})()}function mr(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}mr=function(e,t,n,r){function o(t,n){mr(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},mr(e,t,n,r)}function vr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function yr(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){vr(o,r,i,a,s,"next",e)}function s(e){vr(o,r,i,a,s,"throw",e)}a(void 0)})}}function gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sr(r.key),r)}}function wr(e,t,n){return t&&br(e.prototype,t),n&&br(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sr(e){var t=function(e){if("object"!=hr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hr(t)?t:t+""}function kr(e,t,n){return t=Or(t),function(e,t){if(t&&("object"==hr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,jr()?Reflect.construct(t,n||[],Or(e).constructor):t.apply(e,n))}function jr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(jr=function(){return!!e})()}function Or(e){return Or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Or(e)}function zr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pr(e,t)}function Pr(e,t){return Pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pr(e,t)}var xr=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"requiresEntity",value:function(e){return"technology"===e}},{key:"execute",value:(n=yr(dr().m(function e(){var t,n=arguments;return dr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).technology){e.n=1;break}return e.a(2,_e.askFor("technology","Quale tecnologia vuoi cercare?"));case 1:return e.n=2,L.searchProjectsByTechnology(t.technology);case 2:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Cr=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"execute",value:(n=yr(dr().m(function e(){return dr().w(function(e){for(;;)if(0===e.n)return e.a(2,L.suggestNextAction())},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),_r=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"execute",value:(n=yr(dr().m(function e(){return dr().w(function(e){for(;;)if(0===e.n)return e.a(2,L.analyzeCode())},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Tr=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"execute",value:(n=yr(dr().m(function e(){return dr().w(function(e){for(;;)if(0===e.n)return e.a(2,L.gitStatus())},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Ir=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"requiresEntity",value:function(e){return["preference","value"].includes(e)}},{key:"execute",value:(n=yr(dr().m(function e(){var t,n=arguments;return dr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).preference&&t.value){e.n=1;break}return e.a(2,_e.askFor("preference",'Cosa vuoi che impari? (es: "preferisci tema scuro")'));case 1:return e.a(2,L.learnPreference(t.preference,t.value))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Ar=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"requiresEntity",value:function(e){return"language"===e}},{key:"execute",value:(n=yr(dr().m(function e(){var t,n=arguments;return dr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).language){e.n=1;break}return e.a(2,_e.askFor("language","In quale linguaggio vuoi il codice?"));case 1:return e.a(2,L.codeSnippet(t.language))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Er=function(e){function t(){return gr(this,t),kr(this,t,arguments)}return zr(t,e),wr(t,[{key:"requiresEntity",value:function(e){return"expression"===e}},{key:"execute",value:(n=yr(dr().m(function e(){var t,n=arguments;return dr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).expression){e.n=1;break}return e.a(2,_e.askFor("expression","Cosa vuoi calcolare?"));case 1:return e.a(2,L.calculate(t.expression))}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn);function Mr(e){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mr(e)}function qr(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Dr(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Dr(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Dr(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Dr(f,"constructor",u),Dr(u,"constructor",c),c.displayName="GeneratorFunction",Dr(u,i,"GeneratorFunction"),Dr(f),Dr(f,i,"Generator"),Dr(f,r,function(){return this}),Dr(f,"toString",function(){return"[object Generator]"}),(qr=function(){return{w:o,m:p}})()}function Dr(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Dr=function(e,t,n,r){function o(t,n){Dr(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},Dr(e,t,n,r)}function Lr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Fr(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){Lr(o,r,i,a,s,"next",e)}function s(e){Lr(o,r,i,a,s,"throw",e)}a(void 0)})}}function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Br(r.key),r)}}function Rr(e,t,n){return t&&Nr(e.prototype,t),n&&Nr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Br(e){var t=function(e){if("object"!=Mr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Mr(t)?t:t+""}function Ur(e,t,n){return t=Wr(t),function(e,t){if(t&&("object"==Mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Hr()?Reflect.construct(t,n||[],Wr(e).constructor):t.apply(e,n))}function Hr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Hr=function(){return!!e})()}function Wr(e){return Wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wr(e)}function Vr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}function Kr(e,t){return Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kr(e,t)}var Jr=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"requiresEntity",value:function(e){return"query"===e}},{key:"execute",value:(n=Fr(qr().m(function e(){var t,n=arguments;return qr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).query){e.n=1;break}return e.a(2,_e.askFor("query","Su quale argomento vuoi informazioni?"));case 1:return e.n=2,L.getGeneralKnowledge(t.query);case 2:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Qr=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n=arguments;return qr().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.n=1,L.getNewsHeadlines(t.category||"technology");case 1:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),$r=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"requiresEntity",value:function(e){return"url"===e}},{key:"execute",value:(n=Fr(qr().m(function e(){var t,n=arguments;return qr().w(function(e){for(;;)switch(e.n){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:{}).url){e.n=1;break}return e.a(2,_e.askFor("url","Quale URL vuoi che analizzi?"));case 1:return e.n=2,L.previewMultimedia(t.url);case 2:return e.a(2,e.v)}},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Xr=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n,r=arguments;return qr().w(function(e){for(;;)if(0===e.n)return t=(r.length>0&&void 0!==r[0]?r[0]:{}).topic||"generale",this.brain.updateUIState({conversationMode:!0,currentTopic:t}),n={progetti:"Ottimo! Parliamo dei miei progetti. Quale ti interessa di più?",lavoro:"Volentieri! Raccontami del tuo lavoro. Cosa fai nel mondo dello sviluppo?",tecnologie:"Le tecnologie sono il mio pane! Quale ti appassiona di più?",generale:"Certo! Di cosa vuoi chiacchierare? Posso parlarti dei miei progetti, delle tecnologie che uso, o di qualsiasi altra cosa!"},e.a(2,{ok:!0,msg:n[t]||n.generale})},e,this)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Zr=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n,r,i,o;return qr().w(function(e){for(;;)if(0===e.n)return r=(n=["Ciao! Sono Glitchy, l'AI di questo portfolio. Come posso aiutarti oggi?","Ehilà! Benvenuto nel mio mondo digitale. Cosa vuoi esplorare?","Salve! Sono qui per guidarti attraverso il portfolio di Alessandro. Dimmi cosa ti interessa!","Ciao! Pronto a scoprire i progetti e le funzionalità di questo sito?","Hey! Sono Glitchy, il tuo assistente virtuale. Cosa possiamo fare insieme?"])[Math.floor(Math.random()*n.length)],i=(null===(t=this.brain)||void 0===t||null===(t=t.uiState)||void 0===t?void 0:t.currentSection)||"hero",o={hero:["scopri i progetti","cambia cursore","vedi le competenze"],projects:["apri Biosphaera","apri LP","cerca per tecnologia"],about:["vedi i contatti","scarica CV","scopri competenze"]}[i]||["esplora i progetti","cambia tema","prova i cursori"],e.a(2,{ok:!0,msg:"".concat(r,"\n\n💡 Suggerimenti: ").concat(o.join(", "))})},e,this)})),function(){return n.apply(this,arguments)})}]);var n}(xn),Yr=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n;return qr().w(function(e){for(;;)if(0===e.n)return n=(t=["Sto benissimo, grazie! Sono sempre carico e pronto ad aiutarti con qualsiasi cosa. Come stai tu?","Sono in forma smagliante! Il codice scorre fluido e i bit danzano felici. Tu come ti senti?","Ottimo! Sono qui, vigile e operativo al 100%. Tutto bene da parte tua?","Sono al top della forma! Pronti a esplorare il portfolio insieme? Come va la tua giornata?","Sto una meraviglia! Sono stato progettato per essere sempre al meglio. Tu come stai?"])[Math.floor(Math.random()*t.length)],e.a(2,{ok:!0,msg:n})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ei=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_skills})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ti=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_tools})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ni=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_contact})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ri=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_project_count})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ii=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_technologies})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),oi=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_faq})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ai=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!0,msg:k.responses.query_about_operator})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),si=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){return qr().w(function(e){for(;;)if(0===e.n)return e.a(2,{ok:!1,msg:"I comandi concatenati sono in fase di elaborazione."})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ci=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n;return qr().w(function(e){for(;;)if(0===e.n)return n=(t=["Sono Glitchy, l'IA bounty hunter integrata in questo portfolio! Sono stato creato per assistere Alessandro e guidare i visitatori attraverso i suoi progetti. Sono sarcastico, intelligente e sempre pronto a rispondere alle tue domande.","Ehilà! Sono Glitchy, l'assistente virtuale di questo sito. Sono un'IA progettata per essere utile, un po' irritabile ma sempre professionale. Alessandro mi ha creato per rendere l'esperienza di navigazione più interattiva.","Mi chiamo Glitchy e sono l'AI che gestisce questo portfolio. Sono stato sviluppato con tecnologie avanzate per fornire assistenza, rispondere a domande e guidare gli utenti attraverso i progetti di Alessandro.","Sono Glitchy, un'intelligenza artificiale specializzata nell'assistenza e nella navigazione di portfolio. Sono qui per aiutarti a scoprire i lavori di Alessandro e rispondere alle tue curiosità."])[Math.floor(Math.random()*t.length)],e.a(2,{ok:!0,msg:n})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),ui=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n;return qr().w(function(e){for(;;)if(0===e.n)return n=(t=["Posso aiutarti a navigare nel portfolio, aprire progetti specifici, cambiare temi e cursori, rispondere a domande sui progetti e le competenze di Alessandro, fornire informazioni tecniche, e molto altro!","Le mie capacità includono: navigazione del sito, gestione progetti, risposte a domande tecniche, suggerimenti personalizzati, analisi di codice, e assistenza generale per l'esplorazione del portfolio.","Sono in grado di: aprire progetti, cambiare impostazioni visuali, fornire informazioni sui lavori di Alessandro, rispondere a domande tecniche, offrire suggerimenti contestuali, e guidarti attraverso il sito.","Posso fare molte cose: dalla navigazione intelligente alla risposta a domande specifiche sui progetti, dalle modifiche all'interfaccia alla fornitura di informazioni tecniche dettagliate."])[Math.floor(Math.random()*t.length)],e.a(2,{ok:!0,msg:n})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn),li=function(e){function t(){return Gr(this,t),Ur(this,t,arguments)}return Vr(t,e),Rr(t,[{key:"execute",value:(n=Fr(qr().m(function e(){var t,n;return qr().w(function(e){for(;;)if(0===e.n)return n=(t=["Il mio ruolo principale è assistere i visitatori del portfolio di Alessandro, fornendo informazioni sui progetti, guidando la navigazione, e rispondendo a domande tecniche. Sono anche responsabile della gestione dell'interfaccia utente e dell'ottimizzazione dell'esperienza.","Lavoro come assistente virtuale per questo portfolio digitale. Gestisco la navigazione, fornisco informazioni sui progetti, rispondo a domande tecniche, e miglioro l'interazione utente attraverso suggerimenti contestuali e funzionalità avanzate.","Sono l'IA che coordina l'esperienza utente su questo sito. Mi occupo di fornire assistenza tecnica, gestire le interazioni, offrire informazioni sui contenuti, e ottimizzare la navigazione per rendere il portfolio più accessibile e informativo.","La mia funzione è quella di facilitare l'esplorazione del portfolio attraverso assistenza intelligente, risposte informative, gestione dell'interfaccia, e supporto tecnico per un'esperienza utente ottimale."])[Math.floor(Math.random()*t.length)],e.a(2,{ok:!0,msg:n})},e)})),function(){return n.apply(this,arguments)})}]);var n}(xn);function fi(e){return fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fi(e)}function pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function hi(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return di(u,"_invoke",function(n,r,i){var o,s,c,u=0,l=i||[],f=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return o=t,s=0,c=e,p.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],h=p.p,d=o[2];n>3?(i=d===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=h&&((i=n<2&&h<o[1])?(s=0,p.v=r,p.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,s=0))}if(i||n>1)return a;throw f=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,d),s=l,c=d;(t=s<2?e:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==a)break}catch(t){o=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,i,o),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(di(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,di(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,di(f,"constructor",u),di(u,"constructor",c),c.displayName="GeneratorFunction",di(u,i,"GeneratorFunction"),di(f),di(f,i,"Generator"),di(f,r,function(){return this}),di(f,"toString",function(){return"[object Generator]"}),(hi=function(){return{w:o,m:p}})()}function di(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}di=function(e,t,n,r){function o(t,n){di(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},di(e,t,n,r)}function mi(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function vi(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){mi(o,r,i,a,s,"next",e)}function s(e){mi(o,r,i,a,s,"throw",e)}a(void 0)})}}function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gi(r.key),r)}}function gi(e){var t=function(e){if("object"!=fi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fi(t)?t:t+""}function bi(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Cn.register("openProject",Un),Cn.register("setCursor",Hn),Cn.register("navigate",Wn),Cn.register("setTheme",Vn),Cn.register("setAccessibility",Kn),Cn.register("playSound",cr),Cn.register("getWeather",ur),Cn.register("systemInfo",lr),Cn.register("showAnalytics",fr),Cn.register("showPersonality",pr),Cn.register("searchProjects",xr),Cn.register("suggestAction",Cr),Cn.register("analyzeCode",_r),Cn.register("gitStatus",Tr),Cn.register("learnPreference",Ir),Cn.register("codeSnippet",Ar),Cn.register("calculate",Er),Cn.register("getGeneralKnowledge",Jr),Cn.register("getNewsHeadlines",Qr),Cn.register("previewMultimedia",$r),Cn.register("conversationMode",Xr),Cn.register("greeting",Zr),Cn.register("personal_status",Yr),Cn.register("query_skills",ei),Cn.register("query_tools",ti),Cn.register("query_contact",ni),Cn.register("query_project_count",ri),Cn.register("query_technologies",ii),Cn.register("query_faq",oi),Cn.register("query_about_operator",ai),Cn.register("compoundCommand",si),Cn.register("who_are_you",ci),Cn.register("can_do",ui),Cn.register("what_do_you_do",li),console.log("[CommandRegistry] Registered ".concat(Cn.getAllIntents().length," commands"));var wi=new WeakSet,Si=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,wi),this.isOpen=!1,this.history=[],this.soundEnabled=!0,this.typingIndicator=null,this.seenWelcome=!1,this.onboardingActive=!1,this.onboardingIndex=0,this.brain=new nn,this.analytics=new hn(this.brain),this.conversationManager=new _e,this.wrapper=null,this.panel=null,this.messages=null,this.input=null,this.header=null,this.settingsPanel=null,this.toggleButton=null,this.sendBtn=null,this.btnSettings=null,this.glitchyAnimatedDisplay=null,this.btnSavePrefs=null,this.btnCancelPrefs=null,this.btnRestartOnboarding=null},t=[{key:"init",value:(r=vi(hi().m(function e(){var t=this;return hi().w(function(e){for(;;)switch(e.n){case 0:return console.log("[".concat(gn.name,"] Initializing Widget...")),e.n=1,j();case 1:return bi(wi,this,ki).call(this),bi(wi,this,Oi).call(this),bi(wi,this,Zi).call(this),e.n=2,this.brain.initialize();case 2:oe().then(function(e){e?(console.log("[".concat(gn.name,"] NLU Pipeline initialized successfully")),t.conversationManager.nluModule={extractEntity:t.extractEntity.bind(t)}):console.warn("[".concat(gn.name,"] Failed to initialize NLU Pipeline"))}).catch(function(e){console.error("[".concat(gn.name,"] Critical error during NLU initialization:"),e)}),document.body.appendChild(this.wrapper),bi(wi,this,to).call(this),bi(wi,this,no).call(this),L.setBrain(this.brain),console.log("[".concat(gn.name,"] Widget ready."));case 3:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"setOpen",value:function(e){var t=this;this.isOpen=e,this.isOpen?(this.panel.style.display="flex",setTimeout(function(){return t.panel.classList.add("open")},10),this.toggleButton.style.display="none",bi(wi,this,$i).call(this,"active"),L.playSound("coin"),this.input.focus(),this.seenWelcome||this.onboardingActive||(this.seenWelcome=!0,bi(wi,this,$i).call(this,"typing"),setTimeout(function(){var e=gn.welcomeMessages[Math.floor(Math.random()*gn.welcomeMessages.length)];bi(wi,t,Ki).call(t,yn(e,gn.defaultTone,t.brain.uiState)),bi(wi,t,$i).call(t,"active")},500))):(this.panel.classList.remove("open"),setTimeout(function(){t.isOpen||(t.panel.style.display="none")},400),this.toggleButton.style.display="flex",bi(wi,this,$i).call(this,null))}},{key:"extractEntity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.trim();if(n&&n.length>0){var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return pi(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(r.toLowerCase().includes(a.toLowerCase()))return a}}catch(e){o.e(e)}finally{o.f()}}return r.replace(/[^\w\s-]/g,"").trim()}},{key:"pushMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"user"===e?(bi(wi,this,Vi).call(this,t),this.history.push({role:"user",text:t,opts:n})):(bi(wi,this,Ki).call(this,t,n),this.history.push({role:"ai",text:t,opts:n})),bi(wi,this,Yi).call(this)}},{key:"processUserInputForTest",value:(n=vi(hi().m(function e(t){return hi().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,bi(wi,this,_i).call(this,t);case 1:return e.a(2,e.v)}},e,this)})),function(e){return n.apply(this,arguments)})}],t&&yi(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function ki(){this.wrapper=dn("div","ai-chat-widget"),this.panel=dn("div","ai-chat-panel"),this.header=dn("div","ai-chat-header");var e=dn("div","ai-chat-header-hud"),t=dn("div","hud-left"),n=dn("div","hud-right"),r=dn("div","ai-avatar");r.innerHTML='<img src="assets/img/glitchy-avatar.svg" alt="'.concat(gn.name,'" class="ai-pixel"/>');var i=dn("div","ai-chat-meta");i.append(dn("div","ai-chat-title",gn.name),dn("div","ai-chat-sub","Assistente virtuale del sito")),t.append(r,i);var o=dn("div","ai-status-indicator");this.btnSettings=dn("button","ai-settings-toggle","⚙️"),this.btnSettings.title="Impostazioni",n.append(o,this.btnSettings),e.append(t,n),this.glitchyAnimatedDisplay=dn("div","glitchy-animated-display"),this.glitchyAnimatedDisplay.innerHTML='\n            <div class="glitchy-static-overlay"></div>\n        ',this.header.append(this.glitchyAnimatedDisplay,e),this.messages=dn("div","ai-chat-messages");var a=dn("div","ai-chat-input");this.input=dn("input"),this.input.type="text",this.input.placeholder='Comandi: "apri progetto Biosphaera"...',this.sendBtn=dn("button",null,"Invia"),a.append(this.input,this.sendBtn),bi(wi,this,ji).call(this),this.panel.append(this.header,this.settingsPanel,this.messages,a);var s=dn("div");this.toggleButton=dn("button","ai-chat-toggle"),this.toggleButton.innerHTML="🤖",this.toggleButton.title="Apri chat con ".concat(gn.name),s.append(this.toggleButton),this.wrapper.append(this.panel,s),this.panel.style.display="none"}function ji(){this.settingsPanel=dn("div","ai-settings-panel"),this.settingsPanel.style.display="none";var e=dn("div","ai-settings-inner");e.innerHTML="\n            <h4>Impostazioni ".concat(gn.name,'</h4>\n            <label>Personalità:\n                <select id="ai-tone-select">\n                    <option value="sarcastic">Sarcastic</option>\n                    <option value="helpful">Helpful</option>\n                    <option value="neutral">Neutral</option>\n                </select>\n            </label>\n            <label><input type="checkbox" id="ai-sound-toggle" checked /> Suoni attivi</label>\n            <div class="settings-actions">\n                <button id="ai-restart-onboarding">Riavvia Tour</button>\n                <button id="ai-save-prefs">Salva</button>\n                <button id="ai-cancel-prefs">Annulla</button>\n            </div>\n        '),this.settingsPanel.append(e),this.btnSavePrefs=this.settingsPanel.querySelector("#ai-save-prefs"),this.btnCancelPrefs=this.settingsPanel.querySelector("#ai-cancel-prefs"),this.btnRestartOnboarding=this.settingsPanel.querySelector("#ai-restart-onboarding")}function Oi(){var e,t,n,i=this,o=function(){return i.setOpen(!0)};this.toggleButton.addEventListener("click",o),this.toggleButton.addEventListener("touchstart",o),this.sendBtn.addEventListener("click",function(){return bi(wi,i,zi).call(i)}),this.input.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),bi(wi,i,zi).call(i))}),this.btnSettings.addEventListener("click",function(){i.settingsPanel.style.display="none"===i.settingsPanel.style.display?"block":"none"}),null===(e=this.btnSavePrefs)||void 0===e||e.addEventListener("click",function(){return bi(wi,i,eo).call(i)}),null===(t=this.btnCancelPrefs)||void 0===t||t.addEventListener("click",function(){i.settingsPanel.style.display="none"}),null===(n=this.btnRestartOnboarding)||void 0===n||n.addEventListener("click",function(){i.settingsPanel.style.display="none",bi(wi,i,ro).call(i)}),r.A.on("global:click",function(e){!i.isOpen||i.wrapper.contains(e.target)||i.settingsPanel.contains(e.target)||i.setOpen(!1);var t=e.target.closest(".ai-quick-reply");if(t){var n=t.dataset.action,r=t.dataset.payload;bi(wi,i,Hi).call(i,n,r)}}),r.A.on("global:keydown",function(e){"/"!==e.key||["INPUT","TEXTAREA"].includes(document.activeElement.tagName)||(e.preventDefault(),i.setOpen(!0)),"Escape"===e.key&&i.isOpen&&i.setOpen(!1)}),new MutationObserver(function(){return bi(wi,i,to).call(i)}).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function zi(){return Pi.apply(this,arguments)}function Pi(){return(Pi=vi(hi().m(function e(){var t,n,r,i,o;return hi().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.input.value.trim()){e.n=1;break}return e.a(2);case 1:if(this.pushMessage("user",t),this.input.value="",bi(wi,this,Ji).call(this),e.p=2,!t.startsWith("/")){e.n=4;break}return e.n=3,bi(wi,this,xi).call(this,t);case 3:return n=e.v,bi(wi,this,Qi).call(this),this.pushMessage("ai",n.msg),e.a(2);case 4:return e.n=5,bi(wi,this,_i).call(this,t);case 5:r=e.v,bi(wi,this,Qi).call(this),r.response&&bi(wi,this,Ki).call(this,r.response,r.options||{}),e.n=8;break;case 6:return e.p=6,o=e.v,console.error("[Glitchy] Errore inatteso durante #handleSend:",o),bi(wi,this,Qi).call(this),e.n=7,bi(wi,this,Ni).call(this,o);case 7:i=e.v,bi(wi,this,Ki).call(this,i);case 8:return e.a(2)}},e,this,[[2,6]])}))).apply(this,arguments)}function xi(e){return Ci.apply(this,arguments)}function Ci(){return(Ci=vi(hi().m(function e(t){var n,r,i,o,a;return hi().w(function(e){for(;;)switch(e.n){case 0:n=t.substring(1).toLowerCase().trim(),a=n,e.n="log"===a?1:"exportlog"===a?3:"clearlog"===a?4:5;break;case 1:if(0!==(r=this.brain.getConversationLog()).length){e.n=2;break}return e.a(2,{ok:!0,msg:"📝 Nessuna conversazione registrata ancora."});case 2:return i="📝 Log delle conversazioni (".concat(r.length," interazioni):\n\n"),r.slice(-10).forEach(function(e,t){var n,r,o,a,s=new Date(e.timestamp).toLocaleString();i+="".concat(t+1,". [").concat(s,"] ").concat(e.type,"\n"),i+="   👤: ".concat(null===(n=e.userMessage)||void 0===n?void 0:n.substring(0,50)).concat((null===(r=e.userMessage)||void 0===r?void 0:r.length)>50?"...":"","\n"),i+="   🤖: ".concat(null===(o=e.response)||void 0===o?void 0:o.substring(0,50)).concat((null===(a=e.response)||void 0===a?void 0:a.length)>50?"...":"","\n\n")}),i+='💡 Usa "/exportlog" per ottenere il log completo in JSON.',e.a(2,{ok:!0,msg:i});case 3:return o=this.brain.exportConversationLog(),e.a(2,{ok:!0,msg:"📄 Log esportato (".concat(o.length," caratteri). Copia il JSON qui sotto:\n\n").concat(o)});case 4:return this.brain.clearConversationLog(),e.a(2,{ok:!0,msg:"🗑️ Log delle conversazioni cancellato."});case 5:return e.a(2,{ok:!1,msg:'Comando "'.concat(n,'" non riconosciuto. Comandi disponibili: /log, /exportlog, /clearlog')});case 6:return e.a(2)}},e,this)}))).apply(this,arguments)}function _i(e){return Ti.apply(this,arguments)}function Ti(){return(Ti=vi(hi().m(function e(t){var n,r,i;return hi().w(function(e){for(;;)switch(e.n){case 0:if(n=Date.now(),r={intent:"unknown",entities:{},sentiment:"neutral",confidence:0},!this.conversationManager.getContext().awaitingFor){e.n=1;break}r=this.conversationManager.handleFollowUp(t),e.n=3;break;case 1:return e.n=2,se(t);case 2:(i=e.v)&&(r=i);case 3:if("unknown"===r.intent||"conversationMode"===r.intent){e.n=5;break}return console.log("[Glitchy] Comando locale riconosciuto:",r.intent),e.n=4,bi(wi,this,Ii).call(this,r,t,n);case 4:return e.a(2,e.v);case 5:return e.n=6,bi(wi,this,Ei).call(this,t,r,n);case 6:return e.a(2,e.v)}},e,this)}))).apply(this,arguments)}function Ii(e,t,n){return Ai.apply(this,arguments)}function Ai(){return(Ai=vi(hi().m(function e(t,n,r){var i,o,a;return hi().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,bi(wi,this,Bi).call(this,t);case 1:return i=e.v,e.n=2,this.brain.generatePersonalizedResponse(i.msg,n,t.intent);case 2:return o=e.v,a=this.brain.evaluateUserSatisfaction({ok:i.ok,msg:o},n),this.brain.addEpisodicMemory({intent:t.intent,entities:t.entities,sentiment:t.sentiment,satisfaction:a,success:i.ok,responseQuality:a>3.5?"good":a>2.5?"neutral":"poor",userEngagement:t.intent?"high":"low"}),this.analytics.trackCommand(t.intent,i.ok,Date.now()-r),this.conversationManager.updateContext(t.intent,t.entities,o,{success:i.ok}),e.a(2,{response:o,options:i.options||{}})}},e,this)}))).apply(this,arguments)}function Ei(e,t,n){return Mi.apply(this,arguments)}function Mi(){return(Mi=vi(hi().m(function e(t,n,r){var i,o;return hi().w(function(e){for(;;)switch(e.n){case 0:if(i=!navigator.onLine,o=n&&n.confidence<.3,!i&&!o){e.n=2;break}return console.log("[Glitchy] Uso risposte locali avanzate (offline o bassa confidenza)"),e.n=1,bi(wi,this,qi).call(this,t,n,r);case 1:case 3:return e.a(2,e.v);case 2:return e.n=3,bi(wi,this,Li).call(this,t,n,r);case 4:return e.a(2)}},e,this)}))).apply(this,arguments)}function qi(e,t,n){return Di.apply(this,arguments)}function Di(){return(Di=vi(hi().m(function e(t,n,r){var i,o;return hi().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.brain.generateLocalResponse(t,null==n?void 0:n.intent,null==n?void 0:n.entities);case 1:return i=e.v,o=this.brain.evaluateUserSatisfaction({ok:!0,msg:i},t),this.brain.addEpisodicMemory({intent:(null==n?void 0:n.intent)||"local_query",entities:(null==n?void 0:n.entities)||{},sentiment:this.brain.analyzeSentiment(t),satisfaction:o,success:!0,responseQuality:o>3.5?"good":o>2.5?"neutral":"poor",userEngagement:"medium"}),this.analytics.trackCommand((null==n?void 0:n.intent)||"local_command",!0,Date.now()-r),e.a(2,{response:i})}},e,this)}))).apply(this,arguments)}function Li(e,t,n){return Fi.apply(this,arguments)}function Fi(){return(Fi=vi(hi().m(function e(t,n,r){var i,o,a,s,c;return hi().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=null,e.p=1,console.log("[Glitchy] Comando non riconosciuto o domanda aperta. Chiamo il backend (Groq)..."),e.n=2,fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,systemPrompt:"Sei Glitchy, un'IA integrata in una tuta da bounty hunter. Le tue risposte sono brevi, sarcastche e a volte un po' irritabili. Fornisci informazioni utili per la missione, ma con un tono da \"non ho tempo per queste sciocchezze\". Commenta l'ambiente e le richieste con un tono di scherno o leggero disappunto se opportuno."})});case 2:if(405!==(o=e.v).status){e.n=3;break}throw new Error(gn.errorMessages.apiUnavailable);case 3:if(o.ok){e.n=4;break}throw new Error(bi(wi,this,Gi).call(this,o));case 4:return e.n=5,o.json();case 5:return a=e.v,i=a.reply,s=this.brain.evaluateUserSatisfaction({ok:!0,msg:i},t),this.brain.addEpisodicMemory({intent:(null==n?void 0:n.intent)||"llm_query",entities:(null==n?void 0:n.entities)||{},sentiment:this.brain.analyzeSentiment(t),satisfaction:s,success:!0,responseQuality:s>3.5?"good":s>2.5?"neutral":"poor",userEngagement:"high"}),this.analytics.trackCommand((null==n?void 0:n.intent)||"llm_command",!0,Date.now()-r),e.a(2,{response:i});case 6:return e.p=6,c=e.v,console.warn("[Glitchy] LLM API fallita. Uso l'IA locale avanzata: ".concat(c.message)),e.n=7,bi(wi,this,qi).call(this,t,n,r);case 7:return e.a(2,e.v)}},e,this,[[1,6]])}))).apply(this,arguments)}function Gi(e){try{return e.json().error||gn.errorMessages.networkError}catch(t){return"".concat(gn.errorMessages.parsingError,": ").concat(e.text())}}function Ni(e){return Ri.apply(this,arguments)}function Ri(){return(Ri=vi(hi().m(function e(t){return hi().w(function(e){for(;;)switch(e.n){case 0:if(!t.message.includes("fetch")){e.n=2;break}return e.n=1,this.brain.generatePersonalizedResponse(gn.errorMessages.networkError,"","network_error");case 1:case 3:case 5:return e.a(2,e.v);case 2:if(!t.message.includes("API")){e.n=4;break}return e.n=3,this.brain.generatePersonalizedResponse(gn.errorMessages.apiUnavailable,"","api_error");case 4:return e.n=5,this.brain.generatePersonalizedResponse(gn.errorMessages.genericError,"","internal_error");case 6:return e.a(2)}},e,this)}))).apply(this,arguments)}function Bi(e){return Ui.apply(this,arguments)}function Ui(){return(Ui=vi(hi().m(function e(t){var n,r,i,o;return hi().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&t.intent){e.n=1;break}return e.a(2,{ok:!1,msg:yn(gn.errorMessages.invalidCommand,"sarcastic",this.brain.uiState)});case 1:if(gn.allowedActions.includes(t.intent)){e.n=2;break}return e.a(2,{ok:!1,msg:yn(gn.errorMessages.unauthorizedAction,"sarcastic",this.brain.uiState)});case 2:if(n=Cn.getCommand(t.intent)){e.n=3;break}return e.a(2,{ok:!1,msg:yn(gn.errorMessages.commandNotImplemented,"sarcastic",this.brain.uiState)});case 3:return e.p=3,r=new n(this),e.n=4,r.execute(t.entities);case 4:if(!((i=e.v)&&"object"===fi(i)&&!1===i.ok&&i.msg&&i.msg.includes("askFor"))){e.n=5;break}return e.a(2,i);case 5:return e.a(2,i);case 6:return e.p=6,o=e.v,console.error("[Glitchy] Errore nell'esecuzione del comando ".concat(t.intent,":"),o),e.a(2,{ok:!1,msg:yn(gn.errorMessages.genericError,"sarcastic",this.brain.uiState)})}},e,this,[[3,6]])}))).apply(this,arguments)}function Hi(e,t){return Wi.apply(this,arguments)}function Wi(){return(Wi=vi(hi().m(function e(t,n){var r,i,o,a,s;return hi().w(function(e){for(;;)switch(e.n){case 0:return r="".concat(t.replace(/-/g," ")).concat(n?" "+n:""),this.pushMessage("user",r),i={"open-project":"projectName","set-cursor":"cursorType","search-projects":"technology",navigate:"sectionName"},o={intent:t,entities:{}},n&&i[t]&&(o.entities[i[t]]=n),e.n=1,bi(wi,this,Bi).call(this,o);case 1:return a=e.v,e.n=2,this.brain.generatePersonalizedResponse(a.msg,r,t);case 2:s=e.v,bi(wi,this,Ki).call(this,s,a.options||{}),"onboarding-next"===t&&bi(wi,this,oo).call(this),"onboarding-skip"===t&&bi(wi,this,ao).call(this),"mantis-joke"===t&&bi(wi,this,Ki).call(this,vn());case 3:return e.a(2)}},e,this)}))).apply(this,arguments)}function Vi(e){var t=dn("div","msg user",e);this.messages.append(t),bi(wi,this,Xi).call(this),setTimeout(function(){return t.classList.add("animate-in")},10)}function Ki(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};bi(wi,this,Qi).call(this);var n=dn("div","msg ai"),r=t.html?window.HTMLSanitizer.sanitize(e):e;if(n.innerHTML=r,this.messages.append(n),t.quickReplies&&Array.isArray(t.quickReplies)){var i=dn("div","ai-quick-replies");t.quickReplies.forEach(function(e){var t=dn("button","ai-quick-reply",e.label);t.dataset.action=e.action||"",e.payload&&(t.dataset.payload=e.payload),i.append(t)}),this.messages.append(i)}if(bi(wi,this,Xi).call(this),this.soundEnabled)try{L.playSound("notify")}catch(e){}setTimeout(function(){return n.classList.add("animate-in")},10)}function Ji(){this.typingIndicator||(this.typingIndicator=dn("div","ai-typing"),this.typingIndicator.append(dn("span"),dn("span"),dn("span")),this.messages.append(this.typingIndicator),bi(wi,this,Xi).call(this),bi(wi,this,$i).call(this,"typing"))}function Qi(){this.typingIndicator&&(this.typingIndicator.remove(),this.typingIndicator=null),bi(wi,this,$i).call(this,"active")}function $i(e){var t=this.header.querySelector(".ai-status-indicator");t&&(t.className="ai-status-indicator",e&&t.classList.add(e))}function Xi(){this.messages.scrollTop=this.messages.scrollHeight}function Zi(){var e=this;try{var t=localStorage.getItem(gn.persistKey);this.history=t?JSON.parse(t):[],this.history.forEach(function(t){"user"===t.role?bi(wi,e,Vi).call(e,t.text):bi(wi,e,Ki).call(e,t.text,t.opts||{})})}catch(e){this.history=[]}try{var n=JSON.parse(localStorage.getItem("ai_chat_prefs")||"{}");gn.defaultTone=n.tone||"sarcastic",this.soundEnabled=void 0===n.sound||n.sound;var r=this.settingsPanel.querySelector("#ai-tone-select");r&&(r.value=gn.defaultTone);var i=this.settingsPanel.querySelector("#ai-sound-toggle");i&&(i.checked=this.soundEnabled)}catch(e){}}function Yi(){try{localStorage.setItem(gn.persistKey,JSON.stringify(this.history.slice(-50)))}catch(e){}}function eo(){var e={tone:this.settingsPanel.querySelector("#ai-tone-select").value,sound:this.settingsPanel.querySelector("#ai-sound-toggle").checked};localStorage.setItem("ai_chat_prefs",JSON.stringify(e)),gn.defaultTone=e.tone,this.soundEnabled=e.sound,bi(wi,this,Ki).call(this,yn("Impostazioni salvate.","helpful",this.brain.uiState)),this.settingsPanel.style.display="none"}function to(){var e=document.body.classList.contains("theme-dark");this.wrapper.setAttribute("data-theme",e?"dark":"light")}function no(){try{localStorage.getItem("ai_onboard_v2")||bi(wi,this,ro).call(this)}catch(e){}}function ro(){var e=this;this.onboardingActive=!0,this.onboardingIndex=0,localStorage.setItem("ai_onboard_v2","in-progress"),this.setOpen(!0),setTimeout(function(){return bi(wi,e,io).call(e)},600)}function io(){if(this.onboardingIndex>=gn.onboardingSteps.length)bi(wi,this,ao).call(this);else{var e=gn.onboardingSteps[this.onboardingIndex];bi(wi,this,Ki).call(this,e.text,{quickReplies:e.quickReplies})}}function oo(){this.onboardingIndex++,bi(wi,this,io).call(this)}function ao(){this.onboardingActive=!1,localStorage.setItem("ai_onboard_v2","done"),this.onboardingIndex<gn.onboardingSteps.length-1&&bi(wi,this,Ki).call(this,yn("Tour saltato. Puoi riavviarlo dalle impostazioni.","helpful",this.brain.uiState))}document.addEventListener("DOMContentLoaded",vi(hi().m(function e(){var t,n;return hi().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=new Si,e.p=1,e.n=2,t.init();case 2:e.n=4;break;case 3:e.p=3,n=e.v,console.error("[AIChatWidget] Initialization failed:",n);case 4:return e.a(2)}},e,null,[[1,3]])})))}}]);